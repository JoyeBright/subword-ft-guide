[2025-07-18 13:23:11,954 INFO] Missing transforms field for corpus_0 data, set to default: [].
[2025-07-18 13:23:11,954 INFO] Missing transforms field for valid data, set to default: [].
[2025-07-18 13:23:11,955 INFO] Parsed 2 corpora from -data.
[2025-07-18 13:23:11,956 INFO] Get special vocabs from Transforms: {'src': [], 'tgt': []}.
[2025-07-18 13:23:12,118 INFO] The first 10 tokens of the vocabs are:['<unk>', '<blank>', '<s>', '</s>', '"', ',', 'the', '.', 'of', ':']
[2025-07-18 13:23:12,118 INFO] The decoder start token is: <s>
[2025-07-18 13:23:12,118 INFO] Building model...
[2025-07-18 13:23:34,284 INFO] Switching model to float32 for amp/apex_amp
[2025-07-18 13:23:34,284 INFO] Non quantized layer compute is fp32
[2025-07-18 13:23:34,931 INFO] NMTModel(
  (encoder): TransformerEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(57392, 512, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer): ModuleList(
      (0-5): 6 x TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=False)
          (linear_values): Linear(in_features=512, out_features=512, bias=False)
          (linear_query): Linear(in_features=512, out_features=512, bias=False)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=False)
          (w_2): Linear(in_features=2048, out_features=512, bias=False)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
  )
  (decoder): TransformerDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(55744, 512, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
    (transformer_layers): ModuleList(
      (0-5): 6 x TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=False)
          (linear_values): Linear(in_features=512, out_features=512, bias=False)
          (linear_query): Linear(in_features=512, out_features=512, bias=False)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=False)
          (w_2): Linear(in_features=2048, out_features=512, bias=False)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=False)
          (linear_values): Linear(in_features=512, out_features=512, bias=False)
          (linear_query): Linear(in_features=512, out_features=512, bias=False)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=False)
        )
        (layer_norm_2): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
      )
    )
  )
  (generator): Linear(in_features=512, out_features=55744, bias=True)
)
[2025-07-18 13:23:34,933 INFO] encoder: 48272384
[2025-07-18 13:23:34,933 INFO] decoder: 82322880
[2025-07-18 13:23:34,933 INFO] * number of parameters: 130595264
[2025-07-18 13:23:34,934 INFO] Trainable parameters = {'torch.float32': 130595264, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2025-07-18 13:23:34,934 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2025-07-18 13:23:34,934 INFO]  * src vocab size = 57392
[2025-07-18 13:23:34,934 INFO]  * tgt vocab size = 55744
[2025-07-18 13:23:39,947 INFO] Starting training on GPU: [0]
[2025-07-18 13:23:39,947 INFO] Start training loop and validate every 1000 steps...
[2025-07-18 13:23:39,947 INFO] Scoring with: None
[2025-07-18 13:26:54,428 INFO] Step 100/200000; acc: 3.4; ppl: 44700.7; xent: 10.7; lr: 0.00001; sents:  123771; bsz: 7763/8160/309; 15967/16783 tok/s;    194 sec;
[2025-07-18 13:29:08,929 INFO] Step 200/200000; acc: 7.5; ppl: 22461.7; xent: 10.0; lr: 0.00002; sents:  128458; bsz: 7192/7689/321; 21391/22867 tok/s;    329 sec;
[2025-07-18 13:31:24,359 INFO] Step 300/200000; acc: 9.9; ppl: 8707.7; xent: 9.1; lr: 0.00004; sents:  138383; bsz: 7526/8174/346; 22229/24144 tok/s;    464 sec;
[2025-07-18 13:33:39,621 INFO] Step 400/200000; acc: 11.5; ppl: 4007.7; xent: 8.3; lr: 0.00005; sents:  118050; bsz: 7436/7801/295; 21990/23070 tok/s;    600 sec;
[2025-07-18 13:35:57,389 INFO] Step 500/200000; acc: 14.8; ppl: 2344.9; xent: 7.8; lr: 0.00006; sents:  129555; bsz: 7981/8682/324; 23175/25210 tok/s;    737 sec;
[2025-07-18 13:38:15,212 INFO] Step 600/200000; acc: 16.1; ppl: 1715.2; xent: 7.4; lr: 0.00007; sents:  140630; bsz: 7610/7887/352; 22087/22893 tok/s;    875 sec;
[2025-07-18 13:40:32,138 INFO] Step 700/200000; acc: 18.7; ppl: 1227.4; xent: 7.1; lr: 0.00009; sents:  129265; bsz: 7690/8052/323; 22466/23523 tok/s;   1012 sec;
[2025-07-18 13:42:47,913 INFO] Step 800/200000; acc: 20.4; ppl: 927.1; xent: 6.8; lr: 0.00010; sents:  134774; bsz: 7459/8167/337; 21977/24061 tok/s;   1148 sec;
[2025-07-18 13:45:05,272 INFO] Step 900/200000; acc: 20.1; ppl: 839.1; xent: 6.7; lr: 0.00011; sents:  125311; bsz: 7808/8121/313; 22743/23655 tok/s;   1285 sec;
[2025-07-18 13:47:21,431 INFO] Step 1000/200000; acc: 22.0; ppl: 675.6; xent: 6.5; lr: 0.00012; sents:  115794; bsz: 7530/8229/289; 22131/24184 tok/s;   1421 sec;
[2025-07-18 13:47:53,002 INFO] valid stats calculation
                           took: 31.562780380249023 s.
[2025-07-18 13:48:04,493 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.490330696105957 s.
[2025-07-18 13:48:04,493 INFO] UPDATING VALIDATION BLEU
[2025-07-18 13:48:05,037 INFO] validation BLEU: 0.5127234978630901
[2025-07-18 13:48:05,038 INFO] Train perplexity: 3095.69
[2025-07-18 13:48:05,038 INFO] Train accuracy: 14.4734
[2025-07-18 13:48:05,038 INFO] Sentences processed: 1.28399e+06
[2025-07-18 13:48:05,038 INFO] Average bsz: 7600/8096/321
[2025-07-18 13:48:05,038 INFO] Validation perplexity: 1035.98
[2025-07-18 13:48:05,039 INFO] Validation accuracy: 18.607
[2025-07-18 13:48:05,045 INFO] Model is improving acc: -inf --> 18.607.
[2025-07-18 13:50:20,263 INFO] Step 1100/200000; acc: 25.9; ppl: 474.8; xent: 6.2; lr: 0.00014; sents:  148422; bsz: 7642/8279/371; 17094/18519 tok/s;   1600 sec;
[2025-07-18 13:52:36,350 INFO] Step 1200/200000; acc: 24.9; ppl: 454.7; xent: 6.1; lr: 0.00015; sents:  129644; bsz: 7684/8424/324; 22587/24762 tok/s;   1736 sec;
[2025-07-18 13:54:53,901 INFO] Step 1300/200000; acc: 28.0; ppl: 361.8; xent: 5.9; lr: 0.00016; sents:  142157; bsz: 7834/8204/355; 22782/23858 tok/s;   1874 sec;
[2025-07-18 13:57:09,725 INFO] Step 1400/200000; acc: 29.3; ppl: 309.1; xent: 5.7; lr: 0.00017; sents:  115966; bsz: 7672/8143/290; 22608/23994 tok/s;   2010 sec;
[2025-07-18 13:59:23,131 INFO] Step 1500/200000; acc: 32.4; ppl: 238.1; xent: 5.5; lr: 0.00019; sents:  194516; bsz: 7124/8015/486; 21361/24032 tok/s;   2143 sec;
[2025-07-18 14:01:40,042 INFO] Step 1600/200000; acc: 34.3; ppl: 213.6; xent: 5.4; lr: 0.00020; sents:  128965; bsz: 7623/8142/322; 22319/23839 tok/s;   2280 sec;
[2025-07-18 14:03:55,682 INFO] Step 1700/200000; acc: 36.8; ppl: 175.0; xent: 5.2; lr: 0.00021; sents:  150721; bsz: 7442/8175/377; 21948/24111 tok/s;   2416 sec;
[2025-07-18 14:06:11,578 INFO] Step 1800/200000; acc: 40.5; ppl: 139.6; xent: 4.9; lr: 0.00022; sents:  137336; bsz: 7630/7980/343; 22459/23489 tok/s;   2552 sec;
[2025-07-18 14:08:25,878 INFO] Step 1900/200000; acc: 38.9; ppl: 185.7; xent: 5.2; lr: 0.00023; sents:  151150; bsz: 7128/7710/378; 21235/22967 tok/s;   2686 sec;
[2025-07-18 14:10:41,752 INFO] Step 2000/200000; acc: 43.6; ppl: 131.3; xent: 4.9; lr: 0.00025; sents:  147982; bsz: 7532/8167/370; 22176/24045 tok/s;   2822 sec;
[2025-07-18 14:11:12,655 INFO] valid stats calculation
                           took: 30.895615816116333 s.
[2025-07-18 14:11:24,648 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.993218421936035 s.
[2025-07-18 14:11:24,649 INFO] UPDATING VALIDATION BLEU
[2025-07-18 14:11:25,197 INFO] validation BLEU: 8.994554975956044
[2025-07-18 14:11:25,198 INFO] Train perplexity: 868.781
[2025-07-18 14:11:25,198 INFO] Train accuracy: 23.9429
[2025-07-18 14:11:25,198 INFO] Sentences processed: 2.73085e+06
[2025-07-18 14:11:25,198 INFO] Average bsz: 7565/8110/341
[2025-07-18 14:11:25,199 INFO] Validation perplexity: 201.528
[2025-07-18 14:11:25,199 INFO] Validation accuracy: 35.86
[2025-07-18 14:11:25,205 INFO] Model is improving acc: 18.607 --> 35.86.
[2025-07-18 14:11:25,213 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_2000.pt
[2025-07-18 14:13:43,074 INFO] Step 2100/200000; acc: 45.3; ppl: 114.8; xent: 4.7; lr: 0.00026; sents:  133038; bsz: 7211/7875/333; 15908/17373 tok/s;   3003 sec;
[2025-07-18 14:15:58,540 INFO] Step 2200/200000; acc: 46.8; ppl: 100.9; xent: 4.6; lr: 0.00027; sents:  151831; bsz: 7369/7956/380; 21817/23554 tok/s;   3139 sec;
[2025-07-18 14:18:14,733 INFO] Step 2300/200000; acc: 50.0; ppl:  79.1; xent: 4.4; lr: 0.00028; sents:  167518; bsz: 7475/7966/419; 21957/23396 tok/s;   3275 sec;
[2025-07-18 14:20:30,427 INFO] Step 2400/200000; acc: 52.1; ppl:  70.2; xent: 4.3; lr: 0.00030; sents:  148840; bsz: 7464/8023/372; 22029/23677 tok/s;   3410 sec;
[2025-07-18 14:22:49,235 INFO] Step 2500/200000; acc: 52.6; ppl:  67.4; xent: 4.2; lr: 0.00031; sents:  135305; bsz: 7583/8025/338; 21854/23128 tok/s;   3549 sec;
[2025-07-18 14:25:03,892 INFO] Step 2600/200000; acc: 50.2; ppl:  77.3; xent: 4.3; lr: 0.00032; sents:  130939; bsz: 7089/7710/327; 21059/22905 tok/s;   3684 sec;
[2025-07-18 14:27:20,495 INFO] Step 2700/200000; acc: 51.9; ppl:  68.0; xent: 4.2; lr: 0.00033; sents:  127559; bsz: 7410/7994/319; 21698/23409 tok/s;   3821 sec;
[2025-07-18 14:29:35,348 INFO] Step 2800/200000; acc: 52.3; ppl:  64.8; xent: 4.2; lr: 0.00035; sents:  120754; bsz: 6887/7539/302; 20431/22364 tok/s;   3955 sec;
[2025-07-18 14:31:49,390 INFO] Step 2900/200000; acc: 53.3; ppl:  59.7; xent: 4.1; lr: 0.00036; sents:  130777; bsz: 7123/7762/327; 21265/23172 tok/s;   4089 sec;
[2025-07-18 14:34:05,153 INFO] Step 3000/200000; acc: 54.3; ppl:  56.5; xent: 4.0; lr: 0.00037; sents:  119080; bsz: 7555/7977/298; 22271/23513 tok/s;   4225 sec;
[2025-07-18 14:34:34,455 INFO] valid stats calculation
                           took: 29.208280086517334 s.
[2025-07-18 14:34:46,143 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.687943935394287 s.
[2025-07-18 14:34:46,143 INFO] UPDATING VALIDATION BLEU
[2025-07-18 14:34:46,693 INFO] validation BLEU: 20.555256408144302
[2025-07-18 14:34:46,694 INFO] Train perplexity: 388.393
[2025-07-18 14:34:46,694 INFO] Train accuracy: 32.7455
[2025-07-18 14:34:46,694 INFO] Sentences processed: 4.09649e+06
[2025-07-18 14:34:46,694 INFO] Average bsz: 7482/8034/341
[2025-07-18 14:34:46,695 INFO] Validation perplexity: 77.0543
[2025-07-18 14:34:46,695 INFO] Validation accuracy: 47.4246
[2025-07-18 14:34:46,702 INFO] Model is improving acc: 35.86 --> 47.4246.
[2025-07-18 14:37:03,184 INFO] Step 3100/200000; acc: 55.9; ppl:  50.5; xent: 3.9; lr: 0.00038; sents:  119183; bsz: 7640/7971/298; 17174/17919 tok/s;   4403 sec;
[2025-07-18 14:39:18,848 INFO] Step 3200/200000; acc: 56.6; ppl:  46.9; xent: 3.8; lr: 0.00040; sents:  167094; bsz: 7339/7876/418; 21669/23255 tok/s;   4539 sec;
[2025-07-18 14:41:35,836 INFO] Step 3300/200000; acc: 57.6; ppl:  44.4; xent: 3.8; lr: 0.00041; sents:  122365; bsz: 7547/7913/306; 22038/23107 tok/s;   4676 sec;
[2025-07-18 14:43:51,036 INFO] Step 3400/200000; acc: 55.3; ppl:  50.0; xent: 3.9; lr: 0.00042; sents:  115440; bsz: 7373/7804/289; 21815/23091 tok/s;   4811 sec;
[2025-07-18 14:46:04,695 INFO] Step 3500/200000; acc: 56.5; ppl:  47.0; xent: 3.9; lr: 0.00043; sents:  139317; bsz: 7153/7970/348; 21407/23852 tok/s;   4945 sec;
[2025-07-18 14:48:17,891 INFO] Step 3600/200000; acc: 55.9; ppl:  48.9; xent: 3.9; lr: 0.00044; sents:  131034; bsz: 6992/7680/328; 20998/23064 tok/s;   5078 sec;
[2025-07-18 14:50:32,965 INFO] Step 3700/200000; acc: 56.3; ppl:  46.6; xent: 3.8; lr: 0.00046; sents:  111590; bsz: 7366/7910/279; 21813/23425 tok/s;   5213 sec;
[2025-07-18 14:52:48,960 INFO] Step 3800/200000; acc: 55.9; ppl:  46.2; xent: 3.8; lr: 0.00047; sents:  146714; bsz: 7657/8220/367; 22523/24178 tok/s;   5349 sec;
[2025-07-18 14:55:05,477 INFO] Step 3900/200000; acc: 58.8; ppl:  39.5; xent: 3.7; lr: 0.00048; sents:  151231; bsz: 7423/8035/378; 21749/23543 tok/s;   5486 sec;
[2025-07-18 14:57:20,174 INFO] Step 4000/200000; acc: 58.1; ppl:  39.8; xent: 3.7; lr: 0.00049; sents:  125490; bsz: 7505/7949/314; 22289/23607 tok/s;   5620 sec;
[2025-07-18 14:58:46,199 INFO] valid stats calculation
                           took: 85.70795702934265 s.
[2025-07-18 14:58:58,310 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.870266199111938 s.
[2025-07-18 14:58:58,310 INFO] UPDATING VALIDATION BLEU
[2025-07-18 14:58:58,868 INFO] validation BLEU: 24.313759773924225
[2025-07-18 14:58:58,869 INFO] Train perplexity: 228.775
[2025-07-18 14:58:58,869 INFO] Train accuracy: 38.6748
[2025-07-18 14:58:58,869 INFO] Sentences processed: 5.42595e+06
[2025-07-18 14:58:58,869 INFO] Average bsz: 7462/8009/339
[2025-07-18 14:58:58,869 INFO] Validation perplexity: 52.3321
[2025-07-18 14:58:58,869 INFO] Validation accuracy: 52.0864
[2025-07-18 14:58:58,877 INFO] Model is improving acc: 47.4246 --> 52.0864.
[2025-07-18 14:58:58,885 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_4000.pt
[2025-07-18 15:01:15,482 INFO] Step 4100/200000; acc: 58.2; ppl:  38.4; xent: 3.6; lr: 0.00051; sents:  135588; bsz: 7297/7733/339; 12420/13164 tok/s;   5856 sec;
[2025-07-18 15:03:30,783 INFO] Step 4200/200000; acc: 58.5; ppl:  38.1; xent: 3.6; lr: 0.00052; sents:  111844; bsz: 7344/7807/280; 21713/23084 tok/s;   5991 sec;
[2025-07-18 15:05:44,967 INFO] Step 4300/200000; acc: 60.4; ppl:  35.4; xent: 3.6; lr: 0.00053; sents:  157456; bsz: 7210/7615/394; 21493/22701 tok/s;   6125 sec;
[2025-07-18 15:08:00,683 INFO] Step 4400/200000; acc: 59.7; ppl:  35.5; xent: 3.6; lr: 0.00054; sents:  123575; bsz: 7349/7983/309; 21668/23539 tok/s;   6261 sec;
[2025-07-18 15:10:14,495 INFO] Step 4500/200000; acc: 60.8; ppl:  33.9; xent: 3.5; lr: 0.00056; sents:  162093; bsz: 7379/7856/405; 22058/23485 tok/s;   6395 sec;
[2025-07-18 15:12:28,771 INFO] Step 4600/200000; acc: 60.9; ppl:  33.3; xent: 3.5; lr: 0.00057; sents:  140881; bsz: 7301/7712/352; 21752/22976 tok/s;   6529 sec;
[2025-07-18 15:14:41,920 INFO] Step 4700/200000; acc: 59.2; ppl:  36.7; xent: 3.6; lr: 0.00058; sents:  139416; bsz: 7152/7627/349; 21486/22915 tok/s;   6662 sec;
[2025-07-18 15:16:54,899 INFO] Step 4800/200000; acc: 60.5; ppl:  34.0; xent: 3.5; lr: 0.00059; sents:  151136; bsz: 7109/7670/378; 21385/23072 tok/s;   6795 sec;
[2025-07-18 15:19:09,674 INFO] Step 4900/200000; acc: 61.1; ppl:  32.0; xent: 3.5; lr: 0.00061; sents:  148919; bsz: 7493/7866/372; 22270/23378 tok/s;   6930 sec;
[2025-07-18 15:21:25,817 INFO] Step 5000/200000; acc: 62.0; ppl:  30.1; xent: 3.4; lr: 0.00062; sents:  138943; bsz: 7544/8004/347; 22205/23561 tok/s;   7066 sec;
[2025-07-18 15:21:58,540 INFO] valid stats calculation
                           took: 32.711939334869385 s.
[2025-07-18 15:22:09,665 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.124170780181885 s.
[2025-07-18 15:22:09,665 INFO] UPDATING VALIDATION BLEU
[2025-07-18 15:22:10,382 INFO] validation BLEU: 26.17271901770003
[2025-07-18 15:22:10,383 INFO] Train perplexity: 158.136
[2025-07-18 15:22:10,383 INFO] Train accuracy: 42.8679
[2025-07-18 15:22:10,383 INFO] Sentences processed: 6.8358e+06
[2025-07-18 15:22:10,383 INFO] Average bsz: 7433/7965/342
[2025-07-18 15:22:10,383 INFO] Validation perplexity: 42.4734
[2025-07-18 15:22:10,384 INFO] Validation accuracy: 54.6563
[2025-07-18 15:22:10,391 INFO] Model is improving acc: 52.0864 --> 54.6563.
[2025-07-18 15:24:25,502 INFO] Step 5100/200000; acc: 62.2; ppl:  30.3; xent: 3.4; lr: 0.00063; sents:  147740; bsz: 7434/7892/369; 16551/17569 tok/s;   7246 sec;
[2025-07-18 15:26:40,441 INFO] Step 5200/200000; acc: 62.0; ppl:  29.9; xent: 3.4; lr: 0.00064; sents:  143907; bsz: 7300/7914/360; 21676/23498 tok/s;   7380 sec;
[2025-07-18 15:28:55,816 INFO] Step 5300/200000; acc: 63.7; ppl:  27.2; xent: 3.3; lr: 0.00065; sents:  171881; bsz: 7344/8014/430; 21702/23682 tok/s;   7516 sec;
[2025-07-18 15:31:11,173 INFO] Step 5400/200000; acc: 64.1; ppl:  26.9; xent: 3.3; lr: 0.00067; sents:  177623; bsz: 7410/7962/444; 21898/23531 tok/s;   7651 sec;
[2025-07-18 15:33:05,833 INFO] Step 5484, cuda OOM - batch removed
[2025-07-18 15:33:28,154 INFO] Step 5500/200000; acc: 58.3; ppl:  39.5; xent: 3.7; lr: 0.00068; sents:  164618; bsz: 7508/7958/413; 21869/23182 tok/s;   7788 sec;
[2025-07-18 15:35:43,006 INFO] Step 5600/200000; acc: 54.7; ppl:  49.1; xent: 3.9; lr: 0.00069; sents:  143188; bsz: 7298/7935/358; 21649/23538 tok/s;   7923 sec;
[2025-07-18 15:37:58,390 INFO] Step 5700/200000; acc: 59.7; ppl:  36.7; xent: 3.6; lr: 0.00070; sents:  163413; bsz: 7578/8043/409; 22391/23765 tok/s;   8058 sec;
[2025-07-18 15:40:12,501 INFO] Step 5800/200000; acc: 58.1; ppl:  39.8; xent: 3.7; lr: 0.00072; sents:  145810; bsz: 7409/7641/365; 22112/22804 tok/s;   8193 sec;
[2025-07-18 15:42:26,231 INFO] Step 5900/200000; acc: 58.5; ppl:  38.1; xent: 3.6; lr: 0.00073; sents:  130335; bsz: 7300/7817/326; 21853/23399 tok/s;   8326 sec;
[2025-07-18 15:44:40,831 INFO] Step 6000/200000; acc: 60.3; ppl:  34.2; xent: 3.5; lr: 0.00074; sents:  153551; bsz: 7358/8069/384; 21891/24007 tok/s;   8461 sec;
[2025-07-18 15:45:13,264 INFO] valid stats calculation
                           took: 32.33885979652405 s.
[2025-07-18 15:45:24,498 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.233017921447754 s.
[2025-07-18 15:45:24,498 INFO] UPDATING VALIDATION BLEU
[2025-07-18 15:45:25,227 INFO] validation BLEU: 26.19917989633938
[2025-07-18 15:45:25,228 INFO] Train perplexity: 122.856
[2025-07-18 15:45:25,228 INFO] Train accuracy: 45.7374
[2025-07-18 15:45:25,228 INFO] Sentences processed: 8.37787e+06
[2025-07-18 15:45:25,228 INFO] Average bsz: 7426/7958/349
[2025-07-18 15:45:25,228 INFO] Validation perplexity: 39.6851
[2025-07-18 15:45:25,229 INFO] Validation accuracy: 55.4972
[2025-07-18 15:45:25,236 INFO] Model is improving acc: 54.6563 --> 55.4972.
[2025-07-18 15:45:25,244 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_6000.pt
[2025-07-18 15:47:41,146 INFO] Step 6100/200000; acc: 58.7; ppl:  37.1; xent: 3.6; lr: 0.00075; sents:  126386; bsz: 7358/7749/316; 16331/17198 tok/s;   8641 sec;
[2025-07-18 15:49:56,819 INFO] Step 6200/200000; acc: 62.3; ppl:  29.9; xent: 3.4; lr: 0.00077; sents:  155301; bsz: 7638/8215/388; 22520/24222 tok/s;   8777 sec;
[2025-07-18 15:52:11,801 INFO] Step 6300/200000; acc: 60.3; ppl:  33.6; xent: 3.5; lr: 0.00078; sents:  142016; bsz: 7536/8088/355; 22334/23970 tok/s;   8912 sec;
[2025-07-18 15:54:26,383 INFO] Step 6400/200000; acc: 61.1; ppl:  32.1; xent: 3.5; lr: 0.00079; sents:  142282; bsz: 7145/7976/356; 21238/23707 tok/s;   9046 sec;
[2025-07-18 15:56:41,499 INFO] Step 6500/200000; acc: 62.3; ppl:  29.5; xent: 3.4; lr: 0.00080; sents:  137733; bsz: 7444/8011/344; 22040/23718 tok/s;   9182 sec;
[2025-07-18 15:58:53,770 INFO] Step 6600/200000; acc: 59.9; ppl:  34.1; xent: 3.5; lr: 0.00082; sents:  135507; bsz: 7030/7700/339; 21262/23288 tok/s;   9314 sec;
[2025-07-18 16:01:07,438 INFO] Step 6700/200000; acc: 60.4; ppl:  33.1; xent: 3.5; lr: 0.00083; sents:  138487; bsz: 7386/7819/346; 22114/23409 tok/s;   9447 sec;
[2025-07-18 16:03:21,621 INFO] Step 6800/200000; acc: 58.5; ppl:  36.2; xent: 3.6; lr: 0.00084; sents:  106013; bsz: 7369/7769/265; 21969/23161 tok/s;   9582 sec;
[2025-07-18 16:05:34,651 INFO] Step 6900/200000; acc: 59.5; ppl:  34.0; xent: 3.5; lr: 0.00085; sents:  118659; bsz: 6994/7506/297; 21030/22571 tok/s;   9715 sec;
[2025-07-18 16:07:47,796 INFO] Step 7000/200000; acc: 60.4; ppl:  32.4; xent: 3.5; lr: 0.00086; sents:  131922; bsz: 7260/7782/330; 21812/23381 tok/s;   9848 sec;
[2025-07-18 16:08:20,963 INFO] valid stats calculation
                           took: 33.15816307067871 s.
[2025-07-18 16:08:31,671 INFO] The translation of the valid dataset for dynamic scoring
                               took : 10.707741260528564 s.
[2025-07-18 16:08:31,671 INFO] UPDATING VALIDATION BLEU
[2025-07-18 16:08:32,231 INFO] validation BLEU: 27.641408965446686
[2025-07-18 16:08:32,232 INFO] Train perplexity: 102.051
[2025-07-18 16:08:32,232 INFO] Train accuracy: 47.8052
[2025-07-18 16:08:32,233 INFO] Sentences processed: 9.71217e+06
[2025-07-18 16:08:32,233 INFO] Average bsz: 7411/7944/347
[2025-07-18 16:08:32,233 INFO] Validation perplexity: 34.8405
[2025-07-18 16:08:32,233 INFO] Validation accuracy: 57.1862
[2025-07-18 16:08:32,240 INFO] Model is improving acc: 55.4972 --> 57.1862.
[2025-07-18 16:10:46,297 INFO] Step 7100/200000; acc: 60.6; ppl:  31.9; xent: 3.5; lr: 0.00088; sents:  127565; bsz: 7376/7759/319; 16529/17388 tok/s;  10026 sec;
[2025-07-18 16:12:59,650 INFO] Step 7200/200000; acc: 60.6; ppl:  31.6; xent: 3.5; lr: 0.00089; sents:  133947; bsz: 7168/7811/335; 21501/23431 tok/s;  10160 sec;
[2025-07-18 16:15:13,312 INFO] Step 7300/200000; acc: 59.1; ppl:  34.6; xent: 3.5; lr: 0.00090; sents:  119342; bsz: 7172/7776/298; 21503/23312 tok/s;  10293 sec;
[2025-07-18 16:17:26,511 INFO] Step 7400/200000; acc: 55.4; ppl:  42.5; xent: 3.7; lr: 0.00091; sents:  115732; bsz: 7186/7680/289; 21582/23064 tok/s;  10427 sec;
[2025-07-18 16:19:40,964 INFO] Step 7500/200000; acc: 56.6; ppl:  40.4; xent: 3.7; lr: 0.00093; sents:  148579; bsz: 7526/8320/371; 22390/24753 tok/s;  10561 sec;
[2025-07-18 16:21:55,500 INFO] Step 7600/200000; acc: 58.2; ppl:  36.3; xent: 3.6; lr: 0.00094; sents:  123841; bsz: 7370/8063/310; 21915/23975 tok/s;  10696 sec;
[2025-07-18 16:24:08,242 INFO] Step 7700/200000; acc: 54.2; ppl:  44.8; xent: 3.8; lr: 0.00095; sents:  103036; bsz: 7270/7686/258; 21909/23163 tok/s;  10828 sec;
[2025-07-18 16:26:22,288 INFO] Step 7800/200000; acc: 58.8; ppl:  34.3; xent: 3.5; lr: 0.00096; sents:  133263; bsz: 7387/8030/333; 22056/23976 tok/s;  10962 sec;
[2025-07-18 16:28:35,460 INFO] Step 7900/200000; acc: 56.5; ppl:  39.1; xent: 3.7; lr: 0.00098; sents:  125046; bsz: 7234/7608/313; 21730/22853 tok/s;  11096 sec;
[2025-07-18 16:30:49,278 INFO] Step 8000/200000; acc: 58.3; ppl:  35.1; xent: 3.6; lr: 0.00099; sents:  155757; bsz: 7420/8290/389; 22181/24781 tok/s;  11229 sec;
[2025-07-18 16:31:16,835 INFO] valid stats calculation
                           took: 27.548574924468994 s.
[2025-07-18 16:31:28,199 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.363188982009888 s.
[2025-07-18 16:31:28,199 INFO] UPDATING VALIDATION BLEU
[2025-07-18 16:31:28,759 INFO] validation BLEU: 28.836116761168544
[2025-07-18 16:31:28,760 INFO] Train perplexity: 89.8869
[2025-07-18 16:31:28,760 INFO] Train accuracy: 49.0553
[2025-07-18 16:31:28,760 INFO] Sentences processed: 1.09983e+07
[2025-07-18 16:31:28,760 INFO] Average bsz: 7398/7939/344
[2025-07-18 16:31:28,760 INFO] Validation perplexity: 30.8825
[2025-07-18 16:31:28,761 INFO] Validation accuracy: 58.8825
[2025-07-18 16:31:28,767 INFO] Model is improving acc: 57.1862 --> 58.8825.
[2025-07-18 16:31:28,776 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_8000.pt
[2025-07-18 16:33:44,286 INFO] Step 8100/200000; acc: 57.9; ppl:  35.7; xent: 3.6; lr: 0.00098; sents:  129995; bsz: 7527/7866/325; 17205/17980 tok/s;  11404 sec;
[2025-07-18 16:35:59,739 INFO] Step 8200/200000; acc: 57.4; ppl:  36.3; xent: 3.6; lr: 0.00098; sents:  131150; bsz: 7657/8231/328; 22612/24308 tok/s;  11540 sec;
[2025-07-18 16:38:16,451 INFO] Step 8300/200000; acc: 59.7; ppl:  31.5; xent: 3.5; lr: 0.00097; sents:  123557; bsz: 7968/8391/309; 23314/24551 tok/s;  11677 sec;
[2025-07-18 16:40:31,104 INFO] Step 8400/200000; acc: 58.0; ppl:  35.0; xent: 3.6; lr: 0.00096; sents:  124733; bsz: 7343/8043/312; 21816/23895 tok/s;  11811 sec;
[2025-07-18 16:42:44,405 INFO] Step 8500/200000; acc: 57.9; ppl:  35.0; xent: 3.6; lr: 0.00096; sents:  134374; bsz: 7293/8093/336; 21886/24286 tok/s;  11944 sec;
[2025-07-18 16:44:58,915 INFO] Step 8600/200000; acc: 57.1; ppl:  36.4; xent: 3.6; lr: 0.00095; sents:  110472; bsz: 7688/8224/276; 22863/24457 tok/s;  12079 sec;
[2025-07-18 16:47:12,501 INFO] Step 8700/200000; acc: 57.9; ppl:  35.3; xent: 3.6; lr: 0.00095; sents:  123640; bsz: 7291/7833/309; 21847/23470 tok/s;  12213 sec;
[2025-07-18 16:49:26,649 INFO] Step 8800/200000; acc: 59.1; ppl:  32.8; xent: 3.5; lr: 0.00094; sents:  122634; bsz: 7406/8256/307; 22088/24621 tok/s;  12347 sec;
[2025-07-18 16:51:40,120 INFO] Step 8900/200000; acc: 58.1; ppl:  35.1; xent: 3.6; lr: 0.00094; sents:  123964; bsz: 7165/7899/310; 21475/23674 tok/s;  12480 sec;
[2025-07-18 16:53:54,297 INFO] Step 9000/200000; acc: 58.1; ppl:  34.8; xent: 3.5; lr: 0.00093; sents:  115157; bsz: 7445/7941/288; 22196/23675 tok/s;  12614 sec;
[2025-07-18 16:54:27,833 INFO] valid stats calculation
                           took: 33.45172452926636 s.
[2025-07-18 16:54:39,751 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.917053937911987 s.
[2025-07-18 16:54:39,751 INFO] UPDATING VALIDATION BLEU
[2025-07-18 16:54:40,316 INFO] validation BLEU: 29.573844570911152
[2025-07-18 16:54:40,317 INFO] Train perplexity: 80.7441
[2025-07-18 16:54:40,317 INFO] Train accuracy: 50.078
[2025-07-18 16:54:40,317 INFO] Sentences processed: 1.2238e+07
[2025-07-18 16:54:40,317 INFO] Average bsz: 7407/7954/340
[2025-07-18 16:54:40,317 INFO] Validation perplexity: 27.9003
[2025-07-18 16:54:40,317 INFO] Validation accuracy: 60.2111
[2025-07-18 16:54:40,328 INFO] Model is improving acc: 58.8825 --> 60.2111.
[2025-07-18 16:56:54,545 INFO] Step 9100/200000; acc: 59.6; ppl:  31.9; xent: 3.5; lr: 0.00093; sents:  141963; bsz: 7721/8162/355; 17141/18121 tok/s;  12795 sec;
[2025-07-18 16:59:08,582 INFO] Step 9200/200000; acc: 58.4; ppl:  34.2; xent: 3.5; lr: 0.00092; sents:  118512; bsz: 7452/7891/296; 22238/23550 tok/s;  12929 sec;
[2025-07-18 17:01:22,894 INFO] Step 9300/200000; acc: 59.5; ppl:  32.1; xent: 3.5; lr: 0.00092; sents:  129668; bsz: 7400/8156/324; 22041/24290 tok/s;  13063 sec;
[2025-07-18 17:03:38,671 INFO] Step 9400/200000; acc: 63.4; ppl:  26.0; xent: 3.3; lr: 0.00091; sents:  174243; bsz: 7633/8218/436; 22512/24238 tok/s;  13199 sec;
[2025-07-18 17:05:53,075 INFO] Step 9500/200000; acc: 62.8; ppl:  25.9; xent: 3.3; lr: 0.00091; sents:  142374; bsz: 7266/8146/356; 21648/24269 tok/s;  13333 sec;
[2025-07-18 17:08:10,869 INFO] Step 9600/200000; acc: 66.4; ppl:  21.7; xent: 3.1; lr: 0.00090; sents:  147096; bsz: 7738/8199/368; 22464/23802 tok/s;  13471 sec;
[2025-07-18 17:10:26,180 INFO] Step 9700/200000; acc: 62.9; ppl:  25.4; xent: 3.2; lr: 0.00090; sents:  106523; bsz: 7584/7918/266; 22423/23410 tok/s;  13606 sec;
[2025-07-18 17:12:41,722 INFO] Step 9800/200000; acc: 62.9; ppl:  25.5; xent: 3.2; lr: 0.00089; sents:  138933; bsz: 7391/8016/347; 21812/23658 tok/s;  13742 sec;
[2025-07-18 17:14:56,264 INFO] Step 9900/200000; acc: 63.6; ppl:  24.6; xent: 3.2; lr: 0.00089; sents:  114277; bsz: 7298/7771/286; 21700/23106 tok/s;  13876 sec;
[2025-07-18 17:17:10,784 INFO] Step 10000/200000; acc: 66.2; ppl:  21.7; xent: 3.1; lr: 0.00088; sents:  134863; bsz: 7304/7737/337; 21720/23006 tok/s;  14011 sec;
[2025-07-18 17:17:38,739 INFO] valid stats calculation
                           took: 27.945773363113403 s.
[2025-07-18 17:17:50,182 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.44273042678833 s.
[2025-07-18 17:17:50,182 INFO] UPDATING VALIDATION BLEU
[2025-07-18 17:17:50,749 INFO] validation BLEU: 30.751249606864913
[2025-07-18 17:17:50,750 INFO] Train perplexity: 72.2025
[2025-07-18 17:17:50,750 INFO] Train accuracy: 51.3356
[2025-07-18 17:17:50,750 INFO] Sentences processed: 1.35864e+07
[2025-07-18 17:17:50,750 INFO] Average bsz: 7414/7961/340
[2025-07-18 17:17:50,751 INFO] Validation perplexity: 25.703
[2025-07-18 17:17:50,751 INFO] Validation accuracy: 61.4342
[2025-07-18 17:17:50,796 INFO] Model is improving acc: 60.2111 --> 61.4342.
[2025-07-18 17:17:50,811 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_10000.pt
[2025-07-18 17:20:06,787 INFO] Step 10100/200000; acc: 65.6; ppl:  22.5; xent: 3.1; lr: 0.00088; sents:  144029; bsz: 7529/7875/360; 17112/17899 tok/s;  14187 sec;
[2025-07-18 17:22:22,527 INFO] Step 10200/200000; acc: 64.5; ppl:  23.3; xent: 3.1; lr: 0.00088; sents:  127365; bsz: 7623/8157/318; 22464/24040 tok/s;  14323 sec;
[2025-07-18 17:24:36,273 INFO] Step 10300/200000; acc: 65.0; ppl:  22.8; xent: 3.1; lr: 0.00087; sents:  168731; bsz: 7234/7783/422; 21635/23279 tok/s;  14456 sec;
[2025-07-18 17:26:49,963 INFO] Step 10400/200000; acc: 64.0; ppl:  24.1; xent: 3.2; lr: 0.00087; sents:  129800; bsz: 7119/7881/324; 21302/23582 tok/s;  14590 sec;
[2025-07-18 17:29:03,590 INFO] Step 10500/200000; acc: 66.4; ppl:  21.2; xent: 3.1; lr: 0.00086; sents:  168650; bsz: 7141/7845/422; 21382/23492 tok/s;  14724 sec;
[2025-07-18 17:31:20,005 INFO] Step 10600/200000; acc: 66.6; ppl:  20.6; xent: 3.0; lr: 0.00086; sents:  131328; bsz: 7736/8280/328; 22686/24281 tok/s;  14860 sec;
[2025-07-18 17:33:36,148 INFO] Step 10700/200000; acc: 64.7; ppl:  22.3; xent: 3.1; lr: 0.00085; sents:  134459; bsz: 7777/8205/336; 22851/24109 tok/s;  14996 sec;
[2025-07-18 17:35:51,501 INFO] Step 10800/200000; acc: 66.7; ppl:  20.5; xent: 3.0; lr: 0.00085; sents:  134117; bsz: 7652/8207/335; 22613/24255 tok/s;  15132 sec;
[2025-07-18 17:38:07,349 INFO] Step 10900/200000; acc: 67.0; ppl:  20.2; xent: 3.0; lr: 0.00085; sents:  143992; bsz: 7700/8389/360; 22673/24704 tok/s;  15267 sec;
[2025-07-18 17:40:21,637 INFO] Step 11000/200000; acc: 65.7; ppl:  21.5; xent: 3.1; lr: 0.00084; sents:  127797; bsz: 7373/7881/319; 21962/23477 tok/s;  15402 sec;
[2025-07-18 17:40:51,312 INFO] valid stats calculation
                           took: 29.666869401931763 s.
[2025-07-18 17:41:02,357 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.04375147819519 s.
[2025-07-18 17:41:02,357 INFO] UPDATING VALIDATION BLEU
[2025-07-18 17:41:02,925 INFO] validation BLEU: 31.849532545096345
[2025-07-18 17:41:02,926 INFO] Train perplexity: 64.6941
[2025-07-18 17:41:02,926 INFO] Train accuracy: 52.648
[2025-07-18 17:41:02,926 INFO] Sentences processed: 1.49967e+07
[2025-07-18 17:41:02,926 INFO] Average bsz: 7421/7969/341
[2025-07-18 17:41:02,926 INFO] Validation perplexity: 24.1727
[2025-07-18 17:41:02,927 INFO] Validation accuracy: 62.525
[2025-07-18 17:41:02,932 INFO] Model is improving acc: 61.4342 --> 62.525.
[2025-07-18 17:43:16,812 INFO] Step 11100/200000; acc: 62.6; ppl:  26.8; xent: 3.3; lr: 0.00084; sents:  138518; bsz: 7232/7785/346; 16514/17777 tok/s;  15577 sec;
[2025-07-18 17:45:31,542 INFO] Step 11200/200000; acc: 63.3; ppl:  26.8; xent: 3.3; lr: 0.00084; sents:  142315; bsz: 7220/7921/356; 21444/23528 tok/s;  15712 sec;
[2025-07-18 17:47:46,460 INFO] Step 11300/200000; acc: 62.2; ppl:  28.7; xent: 3.4; lr: 0.00083; sents:  149751; bsz: 7274/8041/374; 21600/23876 tok/s;  15847 sec;
[2025-07-18 17:50:03,524 INFO] Step 11400/200000; acc: 64.1; ppl:  25.2; xent: 3.2; lr: 0.00083; sents:  104649; bsz: 7668/7975/262; 22381/23279 tok/s;  15984 sec;
[2025-07-18 17:52:19,777 INFO] Step 11500/200000; acc: 65.3; ppl:  23.8; xent: 3.2; lr: 0.00082; sents:  146504; bsz: 7358/7843/366; 21603/23026 tok/s;  16120 sec;
[2025-07-18 17:54:34,445 INFO] Step 11600/200000; acc: 64.6; ppl:  24.5; xent: 3.2; lr: 0.00082; sents:  149270; bsz: 7240/7589/373; 21507/22543 tok/s;  16254 sec;
[2025-07-18 17:56:50,275 INFO] Step 11700/200000; acc: 67.2; ppl:  21.4; xent: 3.1; lr: 0.00082; sents:  149060; bsz: 7310/7935/373; 21569/23412 tok/s;  16390 sec;
[2025-07-18 17:59:06,818 INFO] Step 11800/200000; acc: 65.6; ppl:  23.0; xent: 3.1; lr: 0.00081; sents:  133389; bsz: 7551/8008/333; 22123/23459 tok/s;  16527 sec;
[2025-07-18 18:01:19,353 INFO] Step 11900/200000; acc: 64.2; ppl:  25.2; xent: 3.2; lr: 0.00081; sents:  131249; bsz: 6707/7517/328; 20262/22710 tok/s;  16659 sec;
[2025-07-18 18:03:34,129 INFO] Step 12000/200000; acc: 65.2; ppl:  23.3; xent: 3.1; lr: 0.00081; sents:  128548; bsz: 7445/7931/321; 22106/23551 tok/s;  16794 sec;
[2025-07-18 18:04:07,861 INFO] valid stats calculation
                           took: 33.660176515579224 s.
[2025-07-18 18:04:19,427 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.5646653175354 s.
[2025-07-18 18:04:19,427 INFO] UPDATING VALIDATION BLEU
[2025-07-18 18:04:20,009 INFO] validation BLEU: 31.846800223263976
[2025-07-18 18:04:20,010 INFO] Train perplexity: 59.7873
[2025-07-18 18:04:20,010 INFO] Train accuracy: 53.618
[2025-07-18 18:04:20,011 INFO] Sentences processed: 1.63699e+07
[2025-07-18 18:04:20,011 INFO] Average bsz: 7411/7960/341
[2025-07-18 18:04:20,011 INFO] Validation perplexity: 24.12
[2025-07-18 18:04:20,011 INFO] Validation accuracy: 62.4656
[2025-07-18 18:04:20,188 INFO] Decreasing patience: 2/3
[2025-07-18 18:04:20,205 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_12000.pt
[2025-07-18 18:06:34,554 INFO] Step 12100/200000; acc: 64.2; ppl:  24.6; xent: 3.2; lr: 0.00080; sents:  133931; bsz: 7092/7672/335; 15728/17016 tok/s;  16975 sec;
[2025-07-18 18:08:51,560 INFO] Step 12200/200000; acc: 66.4; ppl:  21.9; xent: 3.1; lr: 0.00080; sents:  123053; bsz: 7615/8044/308; 22251/23503 tok/s;  17112 sec;
[2025-07-18 18:11:06,247 INFO] Step 12300/200000; acc: 64.8; ppl:  24.1; xent: 3.2; lr: 0.00080; sents:  129235; bsz: 7202/7795/323; 21390/23150 tok/s;  17246 sec;
[2025-07-18 18:13:23,024 INFO] Step 12400/200000; acc: 65.5; ppl:  22.8; xent: 3.1; lr: 0.00079; sents:  107709; bsz: 7648/7985/269; 22366/23352 tok/s;  17383 sec;
[2025-07-18 18:15:40,054 INFO] Step 12500/200000; acc: 67.2; ppl:  21.0; xent: 3.0; lr: 0.00079; sents:  120009; bsz: 7551/8013/300; 22043/23392 tok/s;  17520 sec;
[2025-07-18 18:17:56,152 INFO] Step 12600/200000; acc: 66.4; ppl:  22.0; xent: 3.1; lr: 0.00079; sents:  129533; bsz: 7515/8123/324; 22088/23874 tok/s;  17656 sec;
[2025-07-18 18:20:10,447 INFO] Step 12700/200000; acc: 65.6; ppl:  22.8; xent: 3.1; lr: 0.00078; sents:  130578; bsz: 7305/7923/326; 21761/23601 tok/s;  17790 sec;
[2025-07-18 18:22:26,040 INFO] Step 12800/200000; acc: 66.7; ppl:  21.6; xent: 3.1; lr: 0.00078; sents:  130127; bsz: 7281/7972/325; 21505/23546 tok/s;  17926 sec;
[2025-07-18 18:24:41,918 INFO] Step 12900/200000; acc: 66.8; ppl:  21.2; xent: 3.1; lr: 0.00078; sents:  147185; bsz: 7306/7807/368; 21507/22983 tok/s;  18062 sec;
[2025-07-18 18:26:57,693 INFO] Step 13000/200000; acc: 66.6; ppl:  21.8; xent: 3.1; lr: 0.00078; sents:  151568; bsz: 7533/7977/379; 22194/23502 tok/s;  18198 sec;
[2025-07-18 18:27:29,763 INFO] valid stats calculation
                           took: 32.061771631240845 s.
[2025-07-18 18:27:40,955 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.191184997558594 s.
[2025-07-18 18:27:40,955 INFO] UPDATING VALIDATION BLEU
[2025-07-18 18:27:41,529 INFO] validation BLEU: 31.973787005481878
[2025-07-18 18:27:41,530 INFO] Train perplexity: 55.4418
[2025-07-18 18:27:41,530 INFO] Train accuracy: 54.5695
[2025-07-18 18:27:41,530 INFO] Sentences processed: 1.76729e+07
[2025-07-18 18:27:41,530 INFO] Average bsz: 7410/7957/340
[2025-07-18 18:27:41,530 INFO] Validation perplexity: 23.3756
[2025-07-18 18:27:41,531 INFO] Validation accuracy: 62.8223
[2025-07-18 18:27:41,633 INFO] Model is improving acc: 62.525 --> 62.8223.
[2025-07-18 18:29:55,989 INFO] Step 13100/200000; acc: 65.2; ppl:  23.7; xent: 3.2; lr: 0.00077; sents:  134109; bsz: 7377/7789/335; 16551/17475 tok/s;  18376 sec;
[2025-07-18 18:32:11,229 INFO] Step 13200/200000; acc: 65.4; ppl:  22.9; xent: 3.1; lr: 0.00077; sents:  132461; bsz: 7223/7741/331; 21364/22896 tok/s;  18511 sec;
[2025-07-18 18:34:26,685 INFO] Step 13300/200000; acc: 67.9; ppl:  19.5; xent: 3.0; lr: 0.00077; sents:  150709; bsz: 7357/7915/377; 21727/23373 tok/s;  18647 sec;
[2025-07-18 18:36:40,120 INFO] Step 13400/200000; acc: 65.4; ppl:  22.8; xent: 3.1; lr: 0.00076; sents:  108952; bsz: 7213/7779/272; 21624/23320 tok/s;  18780 sec;
[2025-07-18 18:38:53,808 INFO] Step 13500/200000; acc: 66.8; ppl:  21.1; xent: 3.0; lr: 0.00076; sents:  158293; bsz: 7068/7784/396; 21149/23291 tok/s;  18914 sec;
[2025-07-18 18:41:09,088 INFO] Step 13600/200000; acc: 67.3; ppl:  20.4; xent: 3.0; lr: 0.00076; sents:  153001; bsz: 7392/7876/383; 21867/23299 tok/s;  19049 sec;
[2025-07-18 18:43:23,872 INFO] Step 13700/200000; acc: 67.7; ppl:  20.0; xent: 3.0; lr: 0.00076; sents:  165291; bsz: 7303/7934/413; 21676/23548 tok/s;  19184 sec;
[2025-07-18 18:45:39,870 INFO] Step 13800/200000; acc: 71.2; ppl:  17.1; xent: 2.8; lr: 0.00075; sents:  227438; bsz: 7562/8283/569; 22277/24403 tok/s;  19320 sec;
[2025-07-18 18:47:54,884 INFO] Step 13900/200000; acc: 68.5; ppl:  19.2; xent: 3.0; lr: 0.00075; sents:  175656; bsz: 7434/8014/439; 22026/23744 tok/s;  19455 sec;
[2025-07-18 18:50:07,978 INFO] Step 14000/200000; acc: 66.5; ppl:  21.1; xent: 3.0; lr: 0.00075; sents:  126219; bsz: 7056/7769/316; 21208/23349 tok/s;  19588 sec;
[2025-07-18 18:50:41,407 INFO] valid stats calculation
                           took: 33.421183347702026 s.
[2025-07-18 18:50:52,319 INFO] The translation of the valid dataset for dynamic scoring
                               took : 10.911569118499756 s.
[2025-07-18 18:50:52,319 INFO] UPDATING VALIDATION BLEU
[2025-07-18 18:50:52,905 INFO] validation BLEU: 33.00516546503975
[2025-07-18 18:50:52,906 INFO] Train perplexity: 51.6975
[2025-07-18 18:50:52,907 INFO] Train accuracy: 55.4669
[2025-07-18 18:50:52,907 INFO] Sentences processed: 1.9205e+07
[2025-07-18 18:50:52,907 INFO] Average bsz: 7402/7952/343
[2025-07-18 18:50:52,907 INFO] Validation perplexity: 22.963
[2025-07-18 18:50:52,907 INFO] Validation accuracy: 63.281
[2025-07-18 18:50:52,908 INFO] Model is improving acc: 62.8223 --> 63.281.
[2025-07-18 18:50:52,916 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_14000.pt
[2025-07-18 18:53:09,425 INFO] Step 14100/200000; acc: 67.4; ppl:  20.0; xent: 3.0; lr: 0.00074; sents:  128257; bsz: 7521/7978/321; 16582/17588 tok/s;  19769 sec;
[2025-07-18 18:55:25,084 INFO] Step 14200/200000; acc: 67.6; ppl:  20.0; xent: 3.0; lr: 0.00074; sents:  141391; bsz: 7626/8109/353; 22507/23933 tok/s;  19905 sec;
[2025-07-18 18:57:38,651 INFO] Step 14300/200000; acc: 67.5; ppl:  20.0; xent: 3.0; lr: 0.00074; sents:  146169; bsz: 7259/7823/365; 21739/23429 tok/s;  20039 sec;
[2025-07-18 18:59:53,129 INFO] Step 14400/200000; acc: 67.5; ppl:  19.6; xent: 3.0; lr: 0.00074; sents:  143922; bsz: 7376/7631/360; 21944/22702 tok/s;  20173 sec;
[2025-07-18 19:02:05,347 INFO] Step 14500/200000; acc: 67.3; ppl:  20.5; xent: 3.0; lr: 0.00073; sents:  149888; bsz: 6893/7528/375; 20854/22777 tok/s;  20305 sec;
[2025-07-18 19:04:18,080 INFO] Step 14600/200000; acc: 66.3; ppl:  21.1; xent: 3.0; lr: 0.00073; sents:  127353; bsz: 6977/7446/318; 21026/22440 tok/s;  20438 sec;
[2025-07-18 19:06:32,763 INFO] Step 14700/200000; acc: 66.5; ppl:  21.0; xent: 3.0; lr: 0.00073; sents:  139227; bsz: 7513/7859/348; 22313/23341 tok/s;  20573 sec;
[2025-07-18 19:08:48,289 INFO] Step 14800/200000; acc: 63.4; ppl:  26.2; xent: 3.3; lr: 0.00073; sents:  140335; bsz: 7502/8234/351; 22146/24306 tok/s;  20708 sec;
[2025-07-18 19:11:02,170 INFO] Step 14900/200000; acc: 62.2; ppl:  27.6; xent: 3.3; lr: 0.00072; sents:  139153; bsz: 7510/7899/348; 22465/23628 tok/s;  20842 sec;
[2025-07-18 19:13:16,477 INFO] Step 15000/200000; acc: 61.2; ppl:  28.9; xent: 3.4; lr: 0.00072; sents:  108609; bsz: 7413/7898/272; 22078/23522 tok/s;  20977 sec;
[2025-07-18 19:13:44,793 INFO] valid stats calculation
                           took: 28.306188106536865 s.
[2025-07-18 19:13:55,863 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.069154977798462 s.
[2025-07-18 19:13:55,863 INFO] UPDATING VALIDATION BLEU
[2025-07-18 19:13:56,446 INFO] validation BLEU: 32.69922556854215
[2025-07-18 19:13:56,447 INFO] Train perplexity: 48.9132
[2025-07-18 19:13:56,447 INFO] Train accuracy: 56.1384
[2025-07-18 19:13:56,447 INFO] Sentences processed: 2.05693e+07
[2025-07-18 19:13:56,447 INFO] Average bsz: 7400/7945/343
[2025-07-18 19:13:56,447 INFO] Validation perplexity: 22.273
[2025-07-18 19:13:56,448 INFO] Validation accuracy: 63.571
[2025-07-18 19:13:56,454 INFO] Model is improving acc: 63.281 --> 63.571.
[2025-07-18 19:16:09,248 INFO] Step 15100/200000; acc: 61.3; ppl:  29.0; xent: 3.4; lr: 0.00072; sents:  122157; bsz: 7291/7649/305; 16881/17710 tok/s;  21149 sec;
[2025-07-18 19:18:23,818 INFO] Step 15200/200000; acc: 61.7; ppl:  28.2; xent: 3.3; lr: 0.00072; sents:  137539; bsz: 7493/8122/344; 22307/24178 tok/s;  21284 sec;
[2025-07-18 19:20:36,549 INFO] Step 15300/200000; acc: 62.2; ppl:  28.0; xent: 3.3; lr: 0.00071; sents:  147381; bsz: 7040/7977/368; 21218/24042 tok/s;  21417 sec;
[2025-07-18 19:22:49,965 INFO] Step 15400/200000; acc: 62.1; ppl:  28.0; xent: 3.3; lr: 0.00071; sents:  131114; bsz: 7220/7988/328; 21649/23951 tok/s;  21550 sec;
[2025-07-18 19:25:04,008 INFO] Step 15500/200000; acc: 62.7; ppl:  26.6; xent: 3.3; lr: 0.00071; sents:  127152; bsz: 7378/7732/318; 22019/23076 tok/s;  21684 sec;
[2025-07-18 19:27:18,492 INFO] Step 15600/200000; acc: 62.0; ppl:  27.5; xent: 3.3; lr: 0.00071; sents:  127278; bsz: 7621/7675/318; 22670/22829 tok/s;  21819 sec;
[2025-07-18 19:29:31,877 INFO] Step 15700/200000; acc: 61.2; ppl:  28.9; xent: 3.4; lr: 0.00071; sents:  126460; bsz: 7372/7784/316; 22109/23346 tok/s;  21952 sec;
[2025-07-18 19:31:46,672 INFO] Step 15800/200000; acc: 63.9; ppl:  24.7; xent: 3.2; lr: 0.00070; sents:  127930; bsz: 7372/7797/320; 21876/23138 tok/s;  22087 sec;
[2025-07-18 19:34:02,073 INFO] Step 15900/200000; acc: 64.4; ppl:  24.0; xent: 3.2; lr: 0.00070; sents:  145317; bsz: 7651/7973/363; 22604/23555 tok/s;  22222 sec;
[2025-07-18 19:36:13,221 INFO] Step 16000/200000; acc: 59.6; ppl:  31.4; xent: 3.4; lr: 0.00070; sents:  102673; bsz: 6969/7317/257; 21258/22320 tok/s;  22353 sec;
[2025-07-18 19:36:44,212 INFO] valid stats calculation
                           took: 30.980875253677368 s.
[2025-07-18 19:36:55,636 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.42383599281311 s.
[2025-07-18 19:36:55,636 INFO] UPDATING VALIDATION BLEU
[2025-07-18 19:36:56,220 INFO] validation BLEU: 33.60698852325975
[2025-07-18 19:36:56,221 INFO] Train perplexity: 47.2165
[2025-07-18 19:36:56,221 INFO] Train accuracy: 56.5061
[2025-07-18 19:36:56,221 INFO] Sentences processed: 2.18643e+07
[2025-07-18 19:36:56,222 INFO] Average bsz: 7396/7936/342
[2025-07-18 19:36:56,222 INFO] Validation perplexity: 22.0269
[2025-07-18 19:36:56,222 INFO] Validation accuracy: 63.8209
[2025-07-18 19:36:56,223 INFO] Model is improving acc: 63.571 --> 63.8209.
[2025-07-18 19:36:56,231 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_16000.pt
[2025-07-18 19:39:09,782 INFO] Step 16100/200000; acc: 63.1; ppl:  26.1; xent: 3.3; lr: 0.00070; sents:  139958; bsz: 7261/7841/350; 16451/17765 tok/s;  22530 sec;
[2025-07-18 19:41:24,221 INFO] Step 16200/200000; acc: 63.8; ppl:  25.0; xent: 3.2; lr: 0.00069; sents:  152658; bsz: 7361/8072/382; 21927/24045 tok/s;  22664 sec;
[2025-07-18 19:43:39,275 INFO] Step 16300/200000; acc: 64.6; ppl:  23.9; xent: 3.2; lr: 0.00069; sents:  145040; bsz: 7408/8018/363; 21941/23748 tok/s;  22799 sec;
[2025-07-18 19:45:54,854 INFO] Step 16400/200000; acc: 63.8; ppl:  25.0; xent: 3.2; lr: 0.00069; sents:  138127; bsz: 7443/8021/345; 21960/23665 tok/s;  22935 sec;
[2025-07-18 19:48:11,922 INFO] Step 16500/200000; acc: 62.2; ppl:  27.3; xent: 3.3; lr: 0.00069; sents:  122020; bsz: 7391/7849/305; 21572/22908 tok/s;  23072 sec;
[2025-07-18 19:50:26,179 INFO] Step 16600/200000; acc: 62.6; ppl:  26.3; xent: 3.3; lr: 0.00069; sents:  120883; bsz: 7395/7960/302; 22039/23723 tok/s;  23206 sec;
[2025-07-18 19:52:40,019 INFO] Step 16700/200000; acc: 61.0; ppl:  28.7; xent: 3.4; lr: 0.00068; sents:  120504; bsz: 7324/7924/301; 21890/23684 tok/s;  23340 sec;
[2025-07-18 19:54:53,054 INFO] Step 16800/200000; acc: 63.3; ppl:  24.8; xent: 3.2; lr: 0.00068; sents:  140315; bsz: 7245/8112/351; 21783/24389 tok/s;  23473 sec;
[2025-07-18 19:57:05,461 INFO] Step 16900/200000; acc: 63.6; ppl:  24.1; xent: 3.2; lr: 0.00068; sents:  139036; bsz: 6948/7828/348; 20990/23647 tok/s;  23606 sec;
[2025-07-18 19:59:20,728 INFO] Step 17000/200000; acc: 64.4; ppl:  22.8; xent: 3.1; lr: 0.00068; sents:  126340; bsz: 7664/8144/316; 22663/24084 tok/s;  23741 sec;
[2025-07-18 19:59:57,023 INFO] valid stats calculation
                           took: 36.29196262359619 s.
[2025-07-18 20:00:08,189 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.165174722671509 s.
[2025-07-18 20:00:08,189 INFO] UPDATING VALIDATION BLEU
[2025-07-18 20:00:08,775 INFO] validation BLEU: 33.727325086738325
[2025-07-18 20:00:08,874 INFO] Train perplexity: 45.5102
[2025-07-18 20:00:08,874 INFO] Train accuracy: 56.906
[2025-07-18 20:00:08,874 INFO] Sentences processed: 2.32092e+07
[2025-07-18 20:00:08,874 INFO] Average bsz: 7393/7938/341
[2025-07-18 20:00:08,875 INFO] Validation perplexity: 21.0146
[2025-07-18 20:00:08,875 INFO] Validation accuracy: 64.6436
[2025-07-18 20:00:08,876 INFO] Model is improving acc: 63.8209 --> 64.6436.
[2025-07-18 20:02:21,774 INFO] Step 17100/200000; acc: 62.7; ppl:  25.2; xent: 3.2; lr: 0.00068; sents:  118045; bsz: 7282/7937/295; 16088/17537 tok/s;  23922 sec;
[2025-07-18 20:04:37,361 INFO] Step 17200/200000; acc: 63.5; ppl:  23.6; xent: 3.2; lr: 0.00067; sents:  109242; bsz: 7692/8176/273; 22692/24119 tok/s;  24057 sec;
[2025-07-18 20:06:51,352 INFO] Step 17300/200000; acc: 64.2; ppl:  23.0; xent: 3.1; lr: 0.00067; sents:  140046; bsz: 7487/8098/350; 22350/24174 tok/s;  24191 sec;
[2025-07-18 20:09:06,182 INFO] Step 17400/200000; acc: 64.0; ppl:  23.2; xent: 3.1; lr: 0.00067; sents:  128712; bsz: 7364/7906/322; 21848/23455 tok/s;  24326 sec;
[2025-07-18 20:11:21,153 INFO] Step 17500/200000; acc: 64.5; ppl:  22.7; xent: 3.1; lr: 0.00067; sents:  138579; bsz: 7410/8009/346; 21960/23737 tok/s;  24461 sec;
[2025-07-18 20:13:37,010 INFO] Step 17600/200000; acc: 66.2; ppl:  20.2; xent: 3.0; lr: 0.00067; sents:  139062; bsz: 7749/8186/348; 22815/24101 tok/s;  24597 sec;
[2025-07-18 20:15:53,261 INFO] Step 17700/200000; acc: 65.9; ppl:  20.5; xent: 3.0; lr: 0.00066; sents:  133541; bsz: 7812/8086/334; 22934/23739 tok/s;  24733 sec;
[2025-07-18 20:18:07,378 INFO] Step 17800/200000; acc: 64.1; ppl:  22.9; xent: 3.1; lr: 0.00066; sents:  122564; bsz: 7193/7971/306; 21454/23774 tok/s;  24867 sec;
[2025-07-18 20:20:22,126 INFO] Step 17900/200000; acc: 64.5; ppl:  22.5; xent: 3.1; lr: 0.00066; sents:  125815; bsz: 7517/8222/315; 22314/24409 tok/s;  25002 sec;
[2025-07-18 20:22:37,057 INFO] Step 18000/200000; acc: 65.3; ppl:  21.6; xent: 3.1; lr: 0.00066; sents:  135521; bsz: 7417/7890/339; 21987/23389 tok/s;  25137 sec;
[2025-07-18 20:23:13,355 INFO] valid stats calculation
                           took: 36.29480719566345 s.
[2025-07-18 20:23:24,784 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.42903447151184 s.
[2025-07-18 20:23:24,784 INFO] UPDATING VALIDATION BLEU
[2025-07-18 20:23:25,364 INFO] validation BLEU: 34.243668946852594
[2025-07-18 20:23:25,365 INFO] Train perplexity: 43.7414
[2025-07-18 20:23:25,365 INFO] Train accuracy: 57.3327
[2025-07-18 20:23:25,365 INFO] Sentences processed: 2.45003e+07
[2025-07-18 20:23:25,365 INFO] Average bsz: 7398/7945/340
[2025-07-18 20:23:25,366 INFO] Validation perplexity: 20.5517
[2025-07-18 20:23:25,366 INFO] Validation accuracy: 64.9566
[2025-07-18 20:23:25,366 INFO] Model is improving acc: 64.6436 --> 64.9566.
[2025-07-18 20:23:25,375 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_18000.pt
[2025-07-18 20:25:41,861 INFO] Step 18100/200000; acc: 64.9; ppl:  21.9; xent: 3.1; lr: 0.00066; sents:  132035; bsz: 7720/8173/330; 16710/17691 tok/s;  25322 sec;
[2025-07-18 20:27:57,570 INFO] Step 18200/200000; acc: 66.1; ppl:  20.5; xent: 3.0; lr: 0.00066; sents:  131086; bsz: 7726/8288/328; 22773/24430 tok/s;  25458 sec;
[2025-07-18 20:30:13,340 INFO] Step 18300/200000; acc: 65.5; ppl:  21.3; xent: 3.1; lr: 0.00065; sents:  130427; bsz: 7593/8158/326; 22370/24036 tok/s;  25593 sec;
[2025-07-18 20:32:28,608 INFO] Step 18400/200000; acc: 64.8; ppl:  21.9; xent: 3.1; lr: 0.00065; sents:  115959; bsz: 7455/8151/290; 22044/24102 tok/s;  25729 sec;
[2025-07-18 20:34:44,672 INFO] Step 18500/200000; acc: 65.7; ppl:  21.0; xent: 3.0; lr: 0.00065; sents:  138669; bsz: 7691/8261/347; 22610/24287 tok/s;  25865 sec;
[2025-07-18 20:37:00,411 INFO] Step 18600/200000; acc: 66.2; ppl:  20.5; xent: 3.0; lr: 0.00065; sents:  131508; bsz: 7542/8169/329; 22225/24072 tok/s;  26000 sec;
[2025-07-18 20:39:16,025 INFO] Step 18700/200000; acc: 65.8; ppl:  21.0; xent: 3.0; lr: 0.00065; sents:  126337; bsz: 7465/8040/316; 22019/23716 tok/s;  26136 sec;
[2025-07-18 20:41:32,554 INFO] Step 18800/200000; acc: 69.3; ppl:  18.0; xent: 2.9; lr: 0.00064; sents:  132617; bsz: 7475/7976/332; 21902/23367 tok/s;  26273 sec;
[2025-07-18 20:43:47,614 INFO] Step 18900/200000; acc: 67.5; ppl:  19.9; xent: 3.0; lr: 0.00064; sents:  141519; bsz: 7362/7804/354; 21805/23112 tok/s;  26408 sec;
[2025-07-18 20:46:03,359 INFO] Step 19000/200000; acc: 68.5; ppl:  18.4; xent: 2.9; lr: 0.00064; sents:  139574; bsz: 7336/7834/349; 21618/23086 tok/s;  26543 sec;
[2025-07-18 20:46:40,112 INFO] valid stats calculation
                           took: 36.75109601020813 s.
[2025-07-18 20:46:51,739 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.625831604003906 s.
[2025-07-18 20:46:51,739 INFO] UPDATING VALIDATION BLEU
[2025-07-18 20:46:52,334 INFO] validation BLEU: 34.34184891236276
[2025-07-18 20:46:52,335 INFO] Train perplexity: 41.992
[2025-07-18 20:46:52,335 INFO] Train accuracy: 57.8191
[2025-07-18 20:46:52,336 INFO] Sentences processed: 2.582e+07
[2025-07-18 20:46:52,336 INFO] Average bsz: 7406/7952/340
[2025-07-18 20:46:52,336 INFO] Validation perplexity: 20.2045
[2025-07-18 20:46:52,336 INFO] Validation accuracy: 65.2624
[2025-07-18 20:46:52,337 INFO] Model is improving acc: 64.9566 --> 65.2624.
[2025-07-18 20:49:05,765 INFO] Step 19100/200000; acc: 67.8; ppl:  19.3; xent: 3.0; lr: 0.00064; sents:  145188; bsz: 7235/7782/363; 15866/17065 tok/s;  26726 sec;
[2025-07-18 20:51:21,838 INFO] Step 19200/200000; acc: 68.1; ppl:  18.9; xent: 2.9; lr: 0.00064; sents:  154262; bsz: 7679/8135/386; 22573/23915 tok/s;  26862 sec;
[2025-07-18 20:53:35,795 INFO] Step 19300/200000; acc: 67.9; ppl:  19.0; xent: 2.9; lr: 0.00064; sents:  128331; bsz: 7162/7695/321; 21386/22977 tok/s;  26996 sec;
[2025-07-18 20:55:49,514 INFO] Step 19400/200000; acc: 67.6; ppl:  19.6; xent: 3.0; lr: 0.00063; sents:  129142; bsz: 6900/7465/323; 20640/22330 tok/s;  27130 sec;
[2025-07-18 20:58:04,443 INFO] Step 19500/200000; acc: 67.3; ppl:  19.7; xent: 3.0; lr: 0.00063; sents:  107938; bsz: 7272/7687/270; 21557/22790 tok/s;  27264 sec;
[2025-07-18 21:00:18,235 INFO] Step 19600/200000; acc: 67.8; ppl:  18.7; xent: 2.9; lr: 0.00063; sents:  192278; bsz: 7030/7925/481; 21017/23693 tok/s;  27398 sec;
[2025-07-18 21:02:33,118 INFO] Step 19700/200000; acc: 68.3; ppl:  18.4; xent: 2.9; lr: 0.00063; sents:  139885; bsz: 7452/8081/350; 22099/23963 tok/s;  27533 sec;
[2025-07-18 21:04:48,778 INFO] Step 19800/200000; acc: 68.7; ppl:  18.3; xent: 2.9; lr: 0.00063; sents:  128551; bsz: 7532/8259/321; 22209/24353 tok/s;  27669 sec;
[2025-07-18 21:07:03,580 INFO] Step 19900/200000; acc: 68.5; ppl:  18.5; xent: 2.9; lr: 0.00063; sents:  126110; bsz: 7292/7835/315; 21637/23250 tok/s;  27804 sec;
[2025-07-18 21:09:18,231 INFO] Step 20000/200000; acc: 68.6; ppl:  18.3; xent: 2.9; lr: 0.00062; sents:  129108; bsz: 7278/8002/323; 21620/23773 tok/s;  27938 sec;
[2025-07-18 21:09:54,612 INFO] valid stats calculation
                           took: 36.377044677734375 s.
[2025-07-18 21:10:05,965 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.352477788925171 s.
[2025-07-18 21:10:05,965 INFO] UPDATING VALIDATION BLEU
[2025-07-18 21:10:06,575 INFO] validation BLEU: 34.406984834795665
[2025-07-18 21:10:06,575 INFO] Train perplexity: 40.3566
[2025-07-18 21:10:06,576 INFO] Train accuracy: 58.3285
[2025-07-18 21:10:06,576 INFO] Sentences processed: 2.72008e+07
[2025-07-18 21:10:06,576 INFO] Average bsz: 7400/7949/340
[2025-07-18 21:10:06,576 INFO] Validation perplexity: 19.8222
[2025-07-18 21:10:06,576 INFO] Validation accuracy: 65.4699
[2025-07-18 21:10:06,577 INFO] Model is improving acc: 65.2624 --> 65.4699.
[2025-07-18 21:10:06,585 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_20000.pt
[2025-07-18 21:12:23,214 INFO] Step 20100/200000; acc: 69.8; ppl:  17.1; xent: 2.8; lr: 0.00062; sents:  147989; bsz: 7510/8113/370; 16240/17544 tok/s;  28123 sec;
[2025-07-18 21:14:40,090 INFO] Step 20200/200000; acc: 70.3; ppl:  16.7; xent: 2.8; lr: 0.00062; sents:  139285; bsz: 7761/8337/348; 22681/24365 tok/s;  28260 sec;
[2025-07-18 21:16:56,610 INFO] Step 20300/200000; acc: 70.7; ppl:  16.5; xent: 2.8; lr: 0.00062; sents:  137451; bsz: 7626/8133/344; 22344/23829 tok/s;  28397 sec;
[2025-07-18 21:19:11,537 INFO] Step 20400/200000; acc: 68.2; ppl:  19.3; xent: 3.0; lr: 0.00062; sents:  148159; bsz: 7276/7917/370; 21571/23471 tok/s;  28532 sec;
[2025-07-18 21:21:25,564 INFO] Step 20500/200000; acc: 66.3; ppl:  21.9; xent: 3.1; lr: 0.00062; sents:  160828; bsz: 7170/7889/402; 21399/23544 tok/s;  28666 sec;
[2025-07-18 21:23:41,266 INFO] Step 20600/200000; acc: 66.4; ppl:  21.3; xent: 3.1; lr: 0.00062; sents:  143870; bsz: 7333/7829/360; 21616/23076 tok/s;  28801 sec;
[2025-07-18 21:25:56,796 INFO] Step 20700/200000; acc: 67.2; ppl:  20.4; xent: 3.0; lr: 0.00061; sents:  142648; bsz: 7515/7927/357; 22180/23396 tok/s;  28937 sec;
[2025-07-18 21:28:12,513 INFO] Step 20800/200000; acc: 68.6; ppl:  19.0; xent: 2.9; lr: 0.00061; sents:  130157; bsz: 7562/7958/325; 22289/23456 tok/s;  29073 sec;
[2025-07-18 21:30:27,673 INFO] Step 20900/200000; acc: 67.3; ppl:  20.2; xent: 3.0; lr: 0.00061; sents:  137591; bsz: 7524/7885/344; 22266/23336 tok/s;  29208 sec;
[2025-07-18 21:32:42,882 INFO] Step 21000/200000; acc: 67.9; ppl:  19.5; xent: 3.0; lr: 0.00061; sents:  134085; bsz: 7511/7950/335; 22220/23520 tok/s;  29343 sec;
[2025-07-18 21:33:17,814 INFO] valid stats calculation
                           took: 34.92991280555725 s.
[2025-07-18 21:33:29,081 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.267054557800293 s.
[2025-07-18 21:33:29,081 INFO] UPDATING VALIDATION BLEU
[2025-07-18 21:33:29,660 INFO] validation BLEU: 34.03946053010736
[2025-07-18 21:33:29,661 INFO] Train perplexity: 38.934
[2025-07-18 21:33:29,661 INFO] Train accuracy: 58.8049
[2025-07-18 21:33:29,661 INFO] Sentences processed: 2.86229e+07
[2025-07-18 21:33:29,661 INFO] Average bsz: 7403/7951/341
[2025-07-18 21:33:29,662 INFO] Validation perplexity: 19.8203
[2025-07-18 21:33:29,662 INFO] Validation accuracy: 65.4177
[2025-07-18 21:33:29,663 INFO] Decreasing patience: 2/3
[2025-07-18 21:35:44,715 INFO] Step 21100/200000; acc: 67.5; ppl:  19.7; xent: 3.0; lr: 0.00061; sents:  154957; bsz: 7709/8123/387; 16959/17869 tok/s;  29525 sec;
[2025-07-18 21:38:00,447 INFO] Step 21200/200000; acc: 67.6; ppl:  19.8; xent: 3.0; lr: 0.00061; sents:  126613; bsz: 7482/8045/317; 22048/23708 tok/s;  29660 sec;
[2025-07-18 21:40:16,569 INFO] Step 21300/200000; acc: 68.2; ppl:  19.1; xent: 2.9; lr: 0.00061; sents:  124422; bsz: 7611/7898/311; 22365/23210 tok/s;  29797 sec;
[2025-07-18 21:42:32,876 INFO] Step 21400/200000; acc: 68.2; ppl:  19.3; xent: 3.0; lr: 0.00060; sents:  140924; bsz: 7684/8217/352; 22550/24114 tok/s;  29933 sec;
[2025-07-18 21:44:48,524 INFO] Step 21500/200000; acc: 67.5; ppl:  20.0; xent: 3.0; lr: 0.00060; sents:  115329; bsz: 7264/7773/288; 21421/22920 tok/s;  30069 sec;
[2025-07-18 21:47:02,517 INFO] Step 21600/200000; acc: 67.4; ppl:  20.1; xent: 3.0; lr: 0.00060; sents:  139365; bsz: 7205/7711/348; 21508/23019 tok/s;  30203 sec;
[2025-07-18 21:49:18,882 INFO] Step 21700/200000; acc: 68.2; ppl:  19.1; xent: 2.9; lr: 0.00060; sents:  147196; bsz: 7573/8127/368; 22217/23841 tok/s;  30339 sec;
[2025-07-18 21:51:33,703 INFO] Step 21800/200000; acc: 67.3; ppl:  20.0; xent: 3.0; lr: 0.00060; sents:  132914; bsz: 7249/8018/332; 21507/23789 tok/s;  30474 sec;
[2025-07-18 21:53:48,237 INFO] Step 21900/200000; acc: 67.2; ppl:  20.1; xent: 3.0; lr: 0.00060; sents:  124245; bsz: 7295/7793/311; 21689/23170 tok/s;  30608 sec;
[2025-07-18 21:56:01,555 INFO] Step 22000/200000; acc: 66.5; ppl:  21.1; xent: 3.0; lr: 0.00060; sents:  134471; bsz: 7034/7635/336; 21105/22908 tok/s;  30742 sec;
[2025-07-18 21:56:37,719 INFO] valid stats calculation
                           took: 36.16143321990967 s.
[2025-07-18 21:56:49,078 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.358933210372925 s.
[2025-07-18 21:56:49,079 INFO] UPDATING VALIDATION BLEU
[2025-07-18 21:56:49,659 INFO] validation BLEU: 34.59771571227132
[2025-07-18 21:56:49,660 INFO] Train perplexity: 37.7574
[2025-07-18 21:56:49,660 INFO] Train accuracy: 59.2029
[2025-07-18 21:56:49,660 INFO] Sentences processed: 2.99633e+07
[2025-07-18 21:56:49,660 INFO] Average bsz: 7404/7950/340
[2025-07-18 21:56:49,660 INFO] Validation perplexity: 19.7837
[2025-07-18 21:56:49,660 INFO] Validation accuracy: 65.6567
[2025-07-18 21:56:49,672 INFO] Model is improving acc: 65.4699 --> 65.6567.
[2025-07-18 21:56:49,682 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_22000.pt
[2025-07-18 21:59:04,939 INFO] Step 22100/200000; acc: 67.2; ppl:  20.0; xent: 3.0; lr: 0.00059; sents:  126191; bsz: 7119/7698/315; 15528/16790 tok/s;  30925 sec;
[2025-07-18 22:01:20,390 INFO] Step 22200/200000; acc: 67.5; ppl:  19.7; xent: 3.0; lr: 0.00059; sents:  134400; bsz: 7397/7985/336; 21846/23583 tok/s;  31060 sec;
[2025-07-18 22:03:35,950 INFO] Step 22300/200000; acc: 67.7; ppl:  19.5; xent: 3.0; lr: 0.00059; sents:  141961; bsz: 7331/7981/355; 21631/23551 tok/s;  31196 sec;
[2025-07-18 22:05:49,430 INFO] Step 22400/200000; acc: 68.1; ppl:  19.2; xent: 3.0; lr: 0.00059; sents:  162168; bsz: 7120/7933/405; 21337/23773 tok/s;  31329 sec;
[2025-07-18 22:08:04,006 INFO] Step 22500/200000; acc: 69.0; ppl:  18.1; xent: 2.9; lr: 0.00059; sents:  159972; bsz: 7376/8077/400; 21923/24007 tok/s;  31464 sec;
[2025-07-18 22:10:18,817 INFO] Step 22600/200000; acc: 69.3; ppl:  18.2; xent: 2.9; lr: 0.00059; sents:  168502; bsz: 7483/7798/421; 22202/23137 tok/s;  31599 sec;
[2025-07-18 22:12:34,787 INFO] Step 22700/200000; acc: 70.1; ppl:  17.2; xent: 2.8; lr: 0.00059; sents:  154453; bsz: 7603/7876/386; 22366/23170 tok/s;  31735 sec;
[2025-07-18 22:14:50,565 INFO] Step 22800/200000; acc: 69.5; ppl:  18.0; xent: 2.9; lr: 0.00059; sents:  142640; bsz: 7244/7658/357; 21342/22560 tok/s;  31871 sec;
[2025-07-18 22:17:05,855 INFO] Step 22900/200000; acc: 68.7; ppl:  18.5; xent: 2.9; lr: 0.00058; sents:  137863; bsz: 7507/8099/345; 22194/23945 tok/s;  32006 sec;
[2025-07-18 22:19:21,020 INFO] Step 23000/200000; acc: 70.5; ppl:  16.9; xent: 2.8; lr: 0.00058; sents:  163738; bsz: 7341/7911/409; 21725/23412 tok/s;  32141 sec;
[2025-07-18 22:19:57,470 INFO] valid stats calculation
                           took: 36.447694063186646 s.
[2025-07-18 22:20:08,354 INFO] The translation of the valid dataset for dynamic scoring
                               took : 10.882970809936523 s.
[2025-07-18 22:20:08,354 INFO] UPDATING VALIDATION BLEU
[2025-07-18 22:20:08,941 INFO] validation BLEU: 34.90580954509638
[2025-07-18 22:20:08,942 INFO] Train perplexity: 36.6116
[2025-07-18 22:20:08,943 INFO] Train accuracy: 59.6157
[2025-07-18 22:20:08,943 INFO] Sentences processed: 3.14552e+07
[2025-07-18 22:20:08,943 INFO] Average bsz: 7401/7948/342
[2025-07-18 22:20:08,943 INFO] Validation perplexity: 19.4922
[2025-07-18 22:20:08,943 INFO] Validation accuracy: 65.7235
[2025-07-18 22:20:08,944 INFO] Model is improving acc: 65.6567 --> 65.7235.
[2025-07-18 22:22:23,091 INFO] Step 23100/200000; acc: 70.0; ppl:  17.0; xent: 2.8; lr: 0.00058; sents:  155689; bsz: 7357/7779/389; 16162/17091 tok/s;  32323 sec;
[2025-07-18 22:24:36,396 INFO] Step 23200/200000; acc: 69.2; ppl:  17.8; xent: 2.9; lr: 0.00058; sents:  159417; bsz: 7166/7891/399; 21503/23677 tok/s;  32456 sec;
[2025-07-18 22:26:50,673 INFO] Step 23300/200000; acc: 69.7; ppl:  17.6; xent: 2.9; lr: 0.00058; sents:  161836; bsz: 7224/7841/405; 21519/23358 tok/s;  32591 sec;
[2025-07-18 22:29:06,016 INFO] Step 23400/200000; acc: 68.0; ppl:  19.0; xent: 2.9; lr: 0.00058; sents:  112689; bsz: 7299/7675/282; 21572/22684 tok/s;  32726 sec;
[2025-07-18 22:31:20,264 INFO] Step 23500/200000; acc: 68.3; ppl:  18.8; xent: 2.9; lr: 0.00058; sents:  115283; bsz: 7302/7677/288; 21758/22875 tok/s;  32860 sec;
[2025-07-18 22:33:34,099 INFO] Step 23600/200000; acc: 68.6; ppl:  18.2; xent: 2.9; lr: 0.00058; sents:  145637; bsz: 7193/7858/364; 21499/23487 tok/s;  32994 sec;
[2025-07-18 22:35:47,094 INFO] Step 23700/200000; acc: 67.9; ppl:  18.9; xent: 2.9; lr: 0.00057; sents:  122953; bsz: 6925/7503/307; 20828/22565 tok/s;  33127 sec;
[2025-07-18 22:38:00,428 INFO] Step 23800/200000; acc: 68.1; ppl:  19.1; xent: 2.9; lr: 0.00057; sents:  141256; bsz: 7125/7934/353; 21376/23802 tok/s;  33260 sec;
[2025-07-18 22:40:13,106 INFO] Step 23900/200000; acc: 68.5; ppl:  18.5; xent: 2.9; lr: 0.00057; sents:  146337; bsz: 6980/7604/366; 21044/22926 tok/s;  33393 sec;
[2025-07-18 22:42:26,796 INFO] Step 24000/200000; acc: 65.6; ppl:  22.0; xent: 3.1; lr: 0.00057; sents:  142996; bsz: 7168/7751/357; 21448/23192 tok/s;  33527 sec;
[2025-07-18 22:43:01,317 INFO] valid stats calculation
                           took: 34.518635272979736 s.
[2025-07-18 22:43:12,786 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.468066930770874 s.
[2025-07-18 22:43:12,786 INFO] UPDATING VALIDATION BLEU
[2025-07-18 22:43:13,370 INFO] validation BLEU: 34.98981507981285
[2025-07-18 22:43:13,371 INFO] Train perplexity: 35.6206
[2025-07-18 22:43:13,371 INFO] Train accuracy: 59.973
[2025-07-18 22:43:13,371 INFO] Sentences processed: 3.28593e+07
[2025-07-18 22:43:13,371 INFO] Average bsz: 7392/7940/342
[2025-07-18 22:43:13,371 INFO] Validation perplexity: 19.6037
[2025-07-18 22:43:13,372 INFO] Validation accuracy: 65.6604
[2025-07-18 22:43:13,372 INFO] Decreasing patience: 2/3
[2025-07-18 22:43:13,380 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_24000.pt
[2025-07-18 22:45:26,689 INFO] Step 24100/200000; acc: 60.9; ppl:  29.0; xent: 3.4; lr: 0.00057; sents:  125585; bsz: 7045/7809/314; 15666/17364 tok/s;  33707 sec;
[2025-07-18 22:47:40,068 INFO] Step 24200/200000; acc: 61.7; ppl:  27.4; xent: 3.3; lr: 0.00057; sents:  121674; bsz: 7325/7938/304; 21970/23808 tok/s;  33840 sec;
[2025-07-18 22:49:53,816 INFO] Step 24300/200000; acc: 61.6; ppl:  27.7; xent: 3.3; lr: 0.00057; sents:  124296; bsz: 7342/7963/311; 21957/23816 tok/s;  33974 sec;
[2025-07-18 22:52:08,784 INFO] Step 24400/200000; acc: 63.1; ppl:  25.1; xent: 3.2; lr: 0.00057; sents:  126144; bsz: 7297/8054/315; 21625/23869 tok/s;  34109 sec;
[2025-07-18 22:54:23,471 INFO] Step 24500/200000; acc: 61.6; ppl:  27.1; xent: 3.3; lr: 0.00056; sents:  104113; bsz: 7442/7919/260; 22101/23519 tok/s;  34244 sec;
[2025-07-18 22:56:37,046 INFO] Step 24600/200000; acc: 62.9; ppl:  25.6; xent: 3.2; lr: 0.00056; sents:  142659; bsz: 7546/7866/357; 22598/23556 tok/s;  34377 sec;
[2025-07-18 22:58:52,495 INFO] Step 24700/200000; acc: 63.8; ppl:  24.3; xent: 3.2; lr: 0.00056; sents:  145512; bsz: 7863/8075/364; 23222/23848 tok/s;  34513 sec;
[2025-07-18 23:01:07,552 INFO] Step 24800/200000; acc: 62.6; ppl:  25.6; xent: 3.2; lr: 0.00056; sents:  115795; bsz: 7480/8153/289; 22154/24148 tok/s;  34648 sec;
[2025-07-18 23:03:22,719 INFO] Step 24900/200000; acc: 63.6; ppl:  24.7; xent: 3.2; lr: 0.00056; sents:  131653; bsz: 7642/8110/329; 22616/24000 tok/s;  34783 sec;
[2025-07-18 23:05:36,773 INFO] Step 25000/200000; acc: 62.5; ppl:  26.2; xent: 3.3; lr: 0.00056; sents:  144239; bsz: 7471/8129/361; 22293/24256 tok/s;  34917 sec;
[2025-07-18 23:06:12,883 INFO] valid stats calculation
                           took: 36.10663866996765 s.
[2025-07-18 23:06:24,526 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.642899990081787 s.
[2025-07-18 23:06:24,526 INFO] UPDATING VALIDATION BLEU
[2025-07-18 23:06:25,109 INFO] validation BLEU: 34.803409301619034
[2025-07-18 23:06:25,110 INFO] Train perplexity: 35.1842
[2025-07-18 23:06:25,110 INFO] Train accuracy: 60.0721
[2025-07-18 23:06:25,110 INFO] Sentences processed: 3.4141e+07
[2025-07-18 23:06:25,110 INFO] Average bsz: 7394/7942/341
[2025-07-18 23:06:25,111 INFO] Validation perplexity: 19.1588
[2025-07-18 23:06:25,111 INFO] Validation accuracy: 66.096
[2025-07-18 23:06:25,111 INFO] Model is improving acc: 65.7235 --> 66.096.
[2025-07-18 23:08:38,189 INFO] Step 25100/200000; acc: 61.7; ppl:  27.4; xent: 3.3; lr: 0.00056; sents:  124337; bsz: 7258/7895/311; 16003/17408 tok/s;  35098 sec;
[2025-07-18 23:10:51,129 INFO] Step 25200/200000; acc: 62.2; ppl:  26.2; xent: 3.3; lr: 0.00056; sents:  118121; bsz: 7308/7964/295; 21990/23962 tok/s;  35231 sec;
[2025-07-18 23:13:05,405 INFO] Step 25300/200000; acc: 63.5; ppl:  24.6; xent: 3.2; lr: 0.00056; sents:  138525; bsz: 7473/8117/346; 22260/24179 tok/s;  35365 sec;
[2025-07-18 23:15:21,381 INFO] Step 25400/200000; acc: 65.6; ppl:  21.9; xent: 3.1; lr: 0.00055; sents:  135633; bsz: 7624/7999/339; 22427/23532 tok/s;  35501 sec;
[2025-07-18 23:17:36,416 INFO] Step 25500/200000; acc: 64.0; ppl:  23.6; xent: 3.2; lr: 0.00055; sents:  123385; bsz: 7594/7981/308; 22494/23641 tok/s;  35636 sec;
[2025-07-18 23:19:52,238 INFO] Step 25600/200000; acc: 64.7; ppl:  22.7; xent: 3.1; lr: 0.00055; sents:  132803; bsz: 7681/8238/332; 22620/24262 tok/s;  35772 sec;
[2025-07-18 23:22:07,049 INFO] Step 25700/200000; acc: 62.7; ppl:  25.4; xent: 3.2; lr: 0.00055; sents:  113856; bsz: 7498/8039/285; 22248/23852 tok/s;  35907 sec;
[2025-07-18 23:24:21,536 INFO] Step 25800/200000; acc: 63.8; ppl:  23.8; xent: 3.2; lr: 0.00055; sents:  117939; bsz: 7449/7871/295; 22156/23412 tok/s;  36042 sec;
[2025-07-18 23:26:34,548 INFO] Step 25900/200000; acc: 63.5; ppl:  24.5; xent: 3.2; lr: 0.00055; sents:  127637; bsz: 7246/7867/319; 21790/23660 tok/s;  36175 sec;
[2025-07-18 23:28:48,827 INFO] Step 26000/200000; acc: 64.7; ppl:  22.8; xent: 3.1; lr: 0.00055; sents:  132749; bsz: 7334/7774/332; 21846/23157 tok/s;  36309 sec;
[2025-07-18 23:29:25,535 INFO] valid stats calculation
                           took: 36.70616626739502 s.
[2025-07-18 23:29:36,653 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.118080854415894 s.
[2025-07-18 23:29:36,654 INFO] UPDATING VALIDATION BLEU
[2025-07-18 23:29:37,246 INFO] validation BLEU: 35.392849727330265
[2025-07-18 23:29:37,247 INFO] Train perplexity: 34.6808
[2025-07-18 23:29:37,247 INFO] Train accuracy: 60.2106
[2025-07-18 23:29:37,247 INFO] Sentences processed: 3.5406e+07
[2025-07-18 23:29:37,247 INFO] Average bsz: 7396/7943/340
[2025-07-18 23:29:37,247 INFO] Validation perplexity: 18.88
[2025-07-18 23:29:37,247 INFO] Validation accuracy: 66.4964
[2025-07-18 23:29:37,248 INFO] Model is improving acc: 66.096 --> 66.4964.
[2025-07-18 23:29:37,256 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_26000.pt
[2025-07-18 23:31:51,649 INFO] Step 26100/200000; acc: 66.9; ppl:  19.6; xent: 3.0; lr: 0.00055; sents:  146205; bsz: 7499/8119/366; 16407/17764 tok/s;  36492 sec;
[2025-07-18 23:34:07,384 INFO] Step 26200/200000; acc: 67.3; ppl:  19.0; xent: 2.9; lr: 0.00055; sents:  135857; bsz: 7533/7924/340; 22198/23351 tok/s;  36627 sec;
[2025-07-18 23:36:22,168 INFO] Step 26300/200000; acc: 66.9; ppl:  19.4; xent: 3.0; lr: 0.00055; sents:  132425; bsz: 7550/7889/331; 22407/23413 tok/s;  36762 sec;
[2025-07-18 23:38:38,196 INFO] Step 26400/200000; acc: 67.2; ppl:  19.1; xent: 3.0; lr: 0.00054; sents:  139745; bsz: 7524/8080/349; 22126/23760 tok/s;  36898 sec;
[2025-07-18 23:40:53,690 INFO] Step 26500/200000; acc: 66.9; ppl:  19.4; xent: 3.0; lr: 0.00054; sents:  134684; bsz: 7697/8247/337; 22723/24346 tok/s;  37034 sec;
[2025-07-18 23:43:09,630 INFO] Step 26600/200000; acc: 68.0; ppl:  18.2; xent: 2.9; lr: 0.00054; sents:  130931; bsz: 7730/8154/327; 22746/23993 tok/s;  37170 sec;
[2025-07-18 23:45:24,621 INFO] Step 26700/200000; acc: 67.3; ppl:  18.9; xent: 2.9; lr: 0.00054; sents:  129130; bsz: 7467/7941/323; 22125/23530 tok/s;  37305 sec;
[2025-07-18 23:47:39,503 INFO] Step 26800/200000; acc: 66.9; ppl:  19.4; xent: 3.0; lr: 0.00054; sents:  121748; bsz: 7370/7916/304; 21857/23475 tok/s;  37440 sec;
[2025-07-18 23:49:52,974 INFO] Step 26900/200000; acc: 66.9; ppl:  19.4; xent: 3.0; lr: 0.00054; sents:  133865; bsz: 7259/7841/335; 21753/23498 tok/s;  37573 sec;
[2025-07-18 23:52:07,862 INFO] Step 27000/200000; acc: 68.4; ppl:  17.9; xent: 2.9; lr: 0.00054; sents:  136698; bsz: 7487/8334/342; 22202/24713 tok/s;  37708 sec;
[2025-07-18 23:52:43,645 INFO] valid stats calculation
                           took: 35.78016948699951 s.
[2025-07-18 23:52:55,263 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.617088794708252 s.
[2025-07-18 23:52:55,263 INFO] UPDATING VALIDATION BLEU
[2025-07-18 23:52:55,855 INFO] validation BLEU: 35.45820120867258
[2025-07-18 23:52:55,856 INFO] Train perplexity: 33.909
[2025-07-18 23:52:55,856 INFO] Train accuracy: 60.4755
[2025-07-18 23:52:55,856 INFO] Sentences processed: 3.67472e+07
[2025-07-18 23:52:55,856 INFO] Average bsz: 7400/7947/340
[2025-07-18 23:52:55,856 INFO] Validation perplexity: 18.6556
[2025-07-18 23:52:55,856 INFO] Validation accuracy: 66.5656
[2025-07-18 23:52:55,857 INFO] Model is improving acc: 66.4964 --> 66.5656.
[2025-07-18 23:55:09,267 INFO] Step 27100/200000; acc: 68.6; ppl:  17.7; xent: 2.9; lr: 0.00054; sents:  156226; bsz: 7477/8146/391; 16487/17963 tok/s;  37889 sec;
[2025-07-18 23:57:24,570 INFO] Step 27200/200000; acc: 67.3; ppl:  18.8; xent: 2.9; lr: 0.00054; sents:  125087; bsz: 7689/8207/313; 22733/24264 tok/s;  38025 sec;
[2025-07-18 23:59:40,332 INFO] Step 27300/200000; acc: 67.3; ppl:  18.7; xent: 2.9; lr: 0.00053; sents:  119796; bsz: 7637/8262/299; 22502/24343 tok/s;  38160 sec;
[2025-07-19 00:01:55,061 INFO] Step 27400/200000; acc: 67.6; ppl:  18.6; xent: 2.9; lr: 0.00053; sents:  124338; bsz: 7432/7963/311; 22066/23642 tok/s;  38295 sec;
[2025-07-19 00:04:11,014 INFO] Step 27500/200000; acc: 67.8; ppl:  18.4; xent: 2.9; lr: 0.00053; sents:  125991; bsz: 7545/8198/315; 22200/24122 tok/s;  38431 sec;
[2025-07-19 00:06:25,480 INFO] Step 27600/200000; acc: 67.6; ppl:  18.8; xent: 2.9; lr: 0.00053; sents:  122690; bsz: 7283/7899/307; 21665/23497 tok/s;  38566 sec;
[2025-07-19 00:08:40,134 INFO] Step 27700/200000; acc: 67.9; ppl:  18.3; xent: 2.9; lr: 0.00053; sents:  138336; bsz: 7414/7979/346; 22024/23702 tok/s;  38700 sec;
[2025-07-19 00:10:55,797 INFO] Step 27800/200000; acc: 68.1; ppl:  18.2; xent: 2.9; lr: 0.00053; sents:  142883; bsz: 7452/8054/357; 21972/23746 tok/s;  38836 sec;
[2025-07-19 00:13:10,209 INFO] Step 27900/200000; acc: 68.4; ppl:  18.3; xent: 2.9; lr: 0.00053; sents:  157716; bsz: 7290/7922/394; 21694/23576 tok/s;  38970 sec;
[2025-07-19 00:15:26,133 INFO] Step 28000/200000; acc: 69.9; ppl:  17.2; xent: 2.8; lr: 0.00053; sents:  187619; bsz: 7531/8081/469; 22163/23782 tok/s;  39106 sec;
[2025-07-19 00:16:02,713 INFO] valid stats calculation
                           took: 36.5781364440918 s.
[2025-07-19 00:16:14,220 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.50618314743042 s.
[2025-07-19 00:16:14,220 INFO] UPDATING VALIDATION BLEU
[2025-07-19 00:16:14,812 INFO] validation BLEU: 35.42257608059348
[2025-07-19 00:16:14,813 INFO] Train perplexity: 33.158
[2025-07-19 00:16:14,813 INFO] Train accuracy: 60.7501
[2025-07-19 00:16:14,813 INFO] Sentences processed: 3.81479e+07
[2025-07-19 00:16:14,813 INFO] Average bsz: 7403/7952/341
[2025-07-19 00:16:14,813 INFO] Validation perplexity: 18.3986
[2025-07-19 00:16:14,813 INFO] Validation accuracy: 66.733
[2025-07-19 00:16:14,821 INFO] Model is improving acc: 66.5656 --> 66.733.
[2025-07-19 00:16:14,830 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_28000.pt
[2025-07-19 00:18:31,123 INFO] Step 28100/200000; acc: 69.3; ppl:  17.8; xent: 2.9; lr: 0.00053; sents:  140704; bsz: 7306/7757/352; 15797/16773 tok/s;  39291 sec;
[2025-07-19 00:20:47,437 INFO] Step 28200/200000; acc: 69.9; ppl:  17.3; xent: 2.9; lr: 0.00053; sents:  172043; bsz: 7483/8288/430; 21960/24323 tok/s;  39427 sec;
[2025-07-19 00:23:03,586 INFO] Step 28300/200000; acc: 68.9; ppl:  17.7; xent: 2.9; lr: 0.00053; sents:  157131; bsz: 7517/8000/393; 22084/23505 tok/s;  39564 sec;
[2025-07-19 00:25:18,279 INFO] Step 28400/200000; acc: 69.7; ppl:  17.4; xent: 2.9; lr: 0.00052; sents:  129944; bsz: 7201/7750/325; 21384/23015 tok/s;  39698 sec;
[2025-07-19 00:27:32,877 INFO] Step 28500/200000; acc: 68.5; ppl:  18.5; xent: 2.9; lr: 0.00052; sents:  123869; bsz: 7266/7772/310; 21593/23098 tok/s;  39833 sec;
[2025-07-19 00:29:47,817 INFO] Step 28600/200000; acc: 68.5; ppl:  18.4; xent: 2.9; lr: 0.00052; sents:  137089; bsz: 7265/7892/343; 21535/23395 tok/s;  39968 sec;
[2025-07-19 00:32:04,130 INFO] Step 28700/200000; acc: 70.2; ppl:  16.8; xent: 2.8; lr: 0.00052; sents:  126901; bsz: 7489/7954/317; 21978/23343 tok/s;  40104 sec;
[2025-07-19 00:34:19,744 INFO] Step 28800/200000; acc: 69.2; ppl:  17.9; xent: 2.9; lr: 0.00052; sents:  133770; bsz: 7536/8004/334; 22229/23609 tok/s;  40240 sec;
[2025-07-19 00:36:34,991 INFO] Step 28900/200000; acc: 69.7; ppl:  17.2; xent: 2.8; lr: 0.00052; sents:  133029; bsz: 7412/8054/333; 21922/23819 tok/s;  40375 sec;
[2025-07-19 00:38:51,084 INFO] Step 29000/200000; acc: 69.8; ppl:  17.0; xent: 2.8; lr: 0.00052; sents:  128156; bsz: 7619/8201/320; 22393/24104 tok/s;  40511 sec;
[2025-07-19 00:39:27,409 INFO] valid stats calculation
                           took: 36.321659326553345 s.
[2025-07-19 00:39:38,624 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.215125322341919 s.
[2025-07-19 00:39:38,624 INFO] UPDATING VALIDATION BLEU
[2025-07-19 00:39:39,218 INFO] validation BLEU: 35.700094552315264
[2025-07-19 00:39:39,219 INFO] Train perplexity: 32.4394
[2025-07-19 00:39:39,219 INFO] Train accuracy: 61.048
[2025-07-19 00:39:39,219 INFO] Sentences processed: 3.95306e+07
[2025-07-19 00:39:39,219 INFO] Average bsz: 7403/7952/341
[2025-07-19 00:39:39,219 INFO] Validation perplexity: 18.1856
[2025-07-19 00:39:39,219 INFO] Validation accuracy: 66.8458
[2025-07-19 00:39:39,220 INFO] Model is improving acc: 66.733 --> 66.8458.
[2025-07-19 00:41:53,482 INFO] Step 29100/200000; acc: 69.7; ppl:  17.4; xent: 2.9; lr: 0.00052; sents:  147546; bsz: 7379/8052/369; 16182/17657 tok/s;  40694 sec;
[2025-07-19 00:44:07,820 INFO] Step 29200/200000; acc: 69.7; ppl:  17.4; xent: 2.9; lr: 0.00052; sents:  123107; bsz: 7241/7880/308; 21562/23465 tok/s;  40828 sec;
[2025-07-19 00:46:22,468 INFO] Step 29300/200000; acc: 68.9; ppl:  17.9; xent: 2.9; lr: 0.00052; sents:  111495; bsz: 7217/7866/279; 21441/23367 tok/s;  40963 sec;
[2025-07-19 00:48:38,309 INFO] Step 29400/200000; acc: 69.9; ppl:  17.1; xent: 2.8; lr: 0.00052; sents:  121863; bsz: 7323/7879/305; 21563/23201 tok/s;  41098 sec;
[2025-07-19 00:50:53,024 INFO] Step 29500/200000; acc: 69.5; ppl:  17.4; xent: 2.9; lr: 0.00051; sents:  126397; bsz: 7392/7885/316; 21948/23413 tok/s;  41233 sec;
[2025-07-19 00:53:08,454 INFO] Step 29600/200000; acc: 69.4; ppl:  17.5; xent: 2.9; lr: 0.00051; sents:  126475; bsz: 7381/7830/316; 21799/23128 tok/s;  41369 sec;
[2025-07-19 00:55:22,853 INFO] Step 29700/200000; acc: 67.7; ppl:  19.3; xent: 3.0; lr: 0.00051; sents:  130504; bsz: 7342/7861/326; 21852/23396 tok/s;  41503 sec;
[2025-07-19 00:57:38,811 INFO] Step 29800/200000; acc: 68.2; ppl:  19.1; xent: 3.0; lr: 0.00051; sents:  143254; bsz: 7733/7970/358; 22752/23450 tok/s;  41639 sec;
[2025-07-19 00:59:54,235 INFO] Step 29900/200000; acc: 68.4; ppl:  18.6; xent: 2.9; lr: 0.00051; sents:  130174; bsz: 7386/7910/325; 21817/23365 tok/s;  41774 sec;
[2025-07-19 01:02:09,898 INFO] Step 30000/200000; acc: 68.4; ppl:  18.7; xent: 2.9; lr: 0.00051; sents:  140925; bsz: 7405/7934/352; 21833/23393 tok/s;  41910 sec;
[2025-07-19 01:02:46,258 INFO] valid stats calculation
                           took: 36.35727334022522 s.
[2025-07-19 01:02:57,600 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.341475248336792 s.
[2025-07-19 01:02:57,600 INFO] UPDATING VALIDATION BLEU
[2025-07-19 01:02:58,187 INFO] validation BLEU: 35.71401852443379
[2025-07-19 01:02:58,188 INFO] Train perplexity: 31.8133
[2025-07-19 01:02:58,188 INFO] Train accuracy: 61.311
[2025-07-19 01:02:58,188 INFO] Sentences processed: 4.08323e+07
[2025-07-19 01:02:58,188 INFO] Average bsz: 7402/7951/340
[2025-07-19 01:02:58,189 INFO] Validation perplexity: 18.4035
[2025-07-19 01:02:58,189 INFO] Validation accuracy: 66.8446
[2025-07-19 01:02:58,189 INFO] Decreasing patience: 2/3
[2025-07-19 01:02:58,198 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_30000.pt
[2025-07-19 01:05:14,372 INFO] Step 30100/200000; acc: 68.3; ppl:  18.2; xent: 2.9; lr: 0.00051; sents:  132739; bsz: 7669/8212/332; 16629/17806 tok/s;  42094 sec;
[2025-07-19 01:07:30,005 INFO] Step 30200/200000; acc: 68.2; ppl:  18.7; xent: 2.9; lr: 0.00051; sents:  117853; bsz: 7538/7932/295; 22231/23391 tok/s;  42230 sec;
[2025-07-19 01:09:43,464 INFO] Step 30300/200000; acc: 68.1; ppl:  19.2; xent: 3.0; lr: 0.00051; sents:  123345; bsz: 7147/7675/308; 21421/23003 tok/s;  42364 sec;
[2025-07-19 01:11:59,613 INFO] Step 30400/200000; acc: 68.6; ppl:  18.7; xent: 2.9; lr: 0.00051; sents:  124269; bsz: 7573/7909/311; 22250/23236 tok/s;  42500 sec;
[2025-07-19 01:14:14,475 INFO] Step 30500/200000; acc: 69.9; ppl:  17.4; xent: 2.9; lr: 0.00051; sents:  149742; bsz: 7510/7977/374; 22274/23659 tok/s;  42635 sec;
[2025-07-19 01:16:30,581 INFO] Step 30600/200000; acc: 69.8; ppl:  17.3; xent: 2.8; lr: 0.00051; sents:  149562; bsz: 7472/8070/374; 21959/23717 tok/s;  42771 sec;
[2025-07-19 01:18:45,469 INFO] Step 30700/200000; acc: 68.5; ppl:  18.5; xent: 2.9; lr: 0.00050; sents:  139367; bsz: 7426/7895/348; 22021/23412 tok/s;  42906 sec;
[2025-07-19 01:21:00,007 INFO] Step 30800/200000; acc: 69.0; ppl:  18.1; xent: 2.9; lr: 0.00050; sents:  135192; bsz: 7213/7720/338; 21446/22953 tok/s;  43040 sec;
[2025-07-19 01:23:13,297 INFO] Step 30900/200000; acc: 68.9; ppl:  18.3; xent: 2.9; lr: 0.00050; sents:  151727; bsz: 7078/7783/379; 21240/23358 tok/s;  43173 sec;
[2025-07-19 01:25:27,111 INFO] Step 31000/200000; acc: 68.5; ppl:  18.6; xent: 2.9; lr: 0.00050; sents:  133417; bsz: 7156/7660/334; 21393/22896 tok/s;  43307 sec;
[2025-07-19 01:26:03,193 INFO] valid stats calculation
                           took: 36.08015727996826 s.
[2025-07-19 01:26:14,580 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.386967182159424 s.
[2025-07-19 01:26:14,581 INFO] UPDATING VALIDATION BLEU
[2025-07-19 01:26:15,171 INFO] validation BLEU: 35.672379259824375
[2025-07-19 01:26:15,172 INFO] Train perplexity: 31.2535
[2025-07-19 01:26:15,172 INFO] Train accuracy: 61.5497
[2025-07-19 01:26:15,172 INFO] Sentences processed: 4.21895e+07
[2025-07-19 01:26:15,172 INFO] Average bsz: 7402/7949/340
[2025-07-19 01:26:15,172 INFO] Validation perplexity: 18.5351
[2025-07-19 01:26:15,173 INFO] Validation accuracy: 66.6335
[2025-07-19 01:26:15,173 INFO] Decreasing patience: 1/3
[2025-07-19 01:28:30,306 INFO] Step 31100/200000; acc: 70.1; ppl:  17.0; xent: 2.8; lr: 0.00050; sents:  132203; bsz: 7411/7991/331; 16181/17448 tok/s;  43490 sec;
[2025-07-19 01:30:43,987 INFO] Step 31200/200000; acc: 69.4; ppl:  17.8; xent: 2.9; lr: 0.00050; sents:  139448; bsz: 7111/7830/349; 21279/23428 tok/s;  43624 sec;
[2025-07-19 01:32:59,000 INFO] Step 31300/200000; acc: 68.8; ppl:  18.3; xent: 2.9; lr: 0.00050; sents:  147272; bsz: 7289/7967/368; 21595/23604 tok/s;  43759 sec;
[2025-07-19 01:35:15,772 INFO] Step 31400/200000; acc: 69.2; ppl:  17.7; xent: 2.9; lr: 0.00050; sents:  145839; bsz: 7493/8015/365; 21915/23440 tok/s;  43896 sec;
[2025-07-19 01:37:30,762 INFO] Step 31500/200000; acc: 69.3; ppl:  17.8; xent: 2.9; lr: 0.00050; sents:  163082; bsz: 7339/7906/408; 21748/23428 tok/s;  44031 sec;
[2025-07-19 01:39:43,825 INFO] Step 31600/200000; acc: 68.5; ppl:  18.6; xent: 2.9; lr: 0.00050; sents:  147816; bsz: 6995/7848/370; 21027/23591 tok/s;  44164 sec;
[2025-07-19 01:41:58,860 INFO] Step 31700/200000; acc: 68.8; ppl:  18.1; xent: 2.9; lr: 0.00050; sents:  143909; bsz: 7366/7789/360; 21820/23072 tok/s;  44299 sec;
[2025-07-19 01:44:12,864 INFO] Step 31800/200000; acc: 69.8; ppl:  17.5; xent: 2.9; lr: 0.00050; sents:  142585; bsz: 7285/7642/356; 21747/22811 tok/s;  44433 sec;
[2025-07-19 01:46:27,096 INFO] Step 31900/200000; acc: 70.3; ppl:  17.1; xent: 2.8; lr: 0.00049; sents:  151533; bsz: 7047/7636/379; 21000/22754 tok/s;  44567 sec;
[2025-07-19 01:48:40,950 INFO] Step 32000/200000; acc: 68.5; ppl:  18.4; xent: 2.9; lr: 0.00049; sents:  125736; bsz: 7121/7522/314; 21280/22478 tok/s;  44701 sec;
[2025-07-19 01:49:17,187 INFO] valid stats calculation
                           took: 36.23405170440674 s.
[2025-07-19 01:49:28,454 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.26670217514038 s.
[2025-07-19 01:49:28,454 INFO] UPDATING VALIDATION BLEU
[2025-07-19 01:49:29,045 INFO] validation BLEU: 35.71065262217778
[2025-07-19 01:49:29,046 INFO] Train perplexity: 30.7183
[2025-07-19 01:49:29,046 INFO] Train accuracy: 61.787
[2025-07-19 01:49:29,046 INFO] Sentences processed: 4.36289e+07
[2025-07-19 01:49:29,046 INFO] Average bsz: 7397/7944/341
[2025-07-19 01:49:29,046 INFO] Validation perplexity: 18.2382
[2025-07-19 01:49:29,046 INFO] Validation accuracy: 66.8762
[2025-07-19 01:49:29,047 INFO] Model is improving acc: 66.8458 --> 66.8762.
[2025-07-19 01:49:29,055 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_32000.pt
[2025-07-19 01:51:45,502 INFO] Step 32100/200000; acc: 69.7; ppl:  17.6; xent: 2.9; lr: 0.00049; sents:  152096; bsz: 7310/7760/380; 15845/16820 tok/s;  44886 sec;
[2025-07-19 01:53:59,719 INFO] Step 32200/200000; acc: 70.2; ppl:  16.9; xent: 2.8; lr: 0.00049; sents:  165659; bsz: 7238/7927/414; 21574/23627 tok/s;  45020 sec;
[2025-07-19 01:56:13,609 INFO] Step 32300/200000; acc: 69.8; ppl:  17.7; xent: 2.9; lr: 0.00049; sents:  170134; bsz: 7273/7819/425; 21728/23359 tok/s;  45154 sec;
[2025-07-19 01:58:27,769 INFO] Step 32400/200000; acc: 69.9; ppl:  17.4; xent: 2.9; lr: 0.00049; sents:  142942; bsz: 7095/7787/357; 21155/23216 tok/s;  45288 sec;
[2025-07-19 02:00:42,242 INFO] Step 32500/200000; acc: 70.6; ppl:  16.5; xent: 2.8; lr: 0.00049; sents:  149412; bsz: 7260/7784/374; 21596/23154 tok/s;  45422 sec;
[2025-07-19 02:02:56,113 INFO] Step 32600/200000; acc: 69.9; ppl:  17.1; xent: 2.8; lr: 0.00049; sents:  135382; bsz: 7022/7760/338; 20982/23187 tok/s;  45556 sec;
[2025-07-19 02:05:11,626 INFO] Step 32700/200000; acc: 70.4; ppl:  16.6; xent: 2.8; lr: 0.00049; sents:  156199; bsz: 7448/7989/390; 21985/23581 tok/s;  45692 sec;
[2025-07-19 02:07:27,911 INFO] Step 32800/200000; acc: 70.5; ppl:  16.5; xent: 2.8; lr: 0.00049; sents:  148216; bsz: 7639/8112/371; 22421/23809 tok/s;  45828 sec;
[2025-07-19 02:09:42,184 INFO] Step 32900/200000; acc: 69.2; ppl:  17.6; xent: 2.9; lr: 0.00049; sents:  123840; bsz: 7340/7914/310; 21867/23577 tok/s;  45962 sec;
[2025-07-19 02:11:56,162 INFO] Step 33000/200000; acc: 70.2; ppl:  16.8; xent: 2.8; lr: 0.00049; sents:  157609; bsz: 7207/7910/394; 21516/23615 tok/s;  46096 sec;
[2025-07-19 02:12:31,972 INFO] valid stats calculation
                           took: 35.807363510131836 s.
[2025-07-19 02:12:43,723 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.750633001327515 s.
[2025-07-19 02:12:43,724 INFO] UPDATING VALIDATION BLEU
[2025-07-19 02:12:44,326 INFO] validation BLEU: 35.96130223713914
[2025-07-19 02:12:44,327 INFO] Train perplexity: 30.1799
[2025-07-19 02:12:44,327 INFO] Train accuracy: 62.0347
[2025-07-19 02:12:44,327 INFO] Sentences processed: 4.51304e+07
[2025-07-19 02:12:44,327 INFO] Average bsz: 7393/7942/342
[2025-07-19 02:12:44,327 INFO] Validation perplexity: 18.0734
[2025-07-19 02:12:44,327 INFO] Validation accuracy: 66.9356
[2025-07-19 02:12:44,328 INFO] Model is improving acc: 66.8762 --> 66.9356.
[2025-07-19 02:14:57,506 INFO] Step 33100/200000; acc: 69.5; ppl:  17.5; xent: 2.9; lr: 0.00049; sents:  138905; bsz: 6952/7472/347; 15334/16482 tok/s;  46278 sec;
[2025-07-19 02:17:11,309 INFO] Step 33200/200000; acc: 68.4; ppl:  18.6; xent: 2.9; lr: 0.00049; sents:  140709; bsz: 7326/7793/352; 21900/23296 tok/s;  46411 sec;
[2025-07-19 02:19:25,068 INFO] Step 33300/200000; acc: 66.0; ppl:  21.2; xent: 3.1; lr: 0.00048; sents:  137445; bsz: 7286/7811/344; 21790/23358 tok/s;  46545 sec;
[2025-07-19 02:21:40,567 INFO] Step 33400/200000; acc: 64.4; ppl:  23.0; xent: 3.1; lr: 0.00048; sents:  148786; bsz: 7771/8138/372; 22942/24023 tok/s;  46681 sec;
[2025-07-19 02:23:56,907 INFO] Step 33500/200000; acc: 63.8; ppl:  23.6; xent: 3.2; lr: 0.00048; sents:  130198; bsz: 7667/8421/325; 22494/24707 tok/s;  46817 sec;
[2025-07-19 02:26:12,064 INFO] Step 33600/200000; acc: 64.5; ppl:  23.0; xent: 3.1; lr: 0.00048; sents:  128905; bsz: 7499/8309/322; 22195/24590 tok/s;  46952 sec;
[2025-07-19 02:28:25,887 INFO] Step 33700/200000; acc: 62.1; ppl:  26.4; xent: 3.3; lr: 0.00048; sents:  120677; bsz: 7359/7970/302; 21996/23824 tok/s;  47086 sec;
[2025-07-19 02:30:37,744 INFO] Step 33800/200000; acc: 59.9; ppl:  29.7; xent: 3.4; lr: 0.00048; sents:  103372; bsz: 6935/7703/258; 21038/23369 tok/s;  47218 sec;
[2025-07-19 02:32:51,543 INFO] Step 33900/200000; acc: 62.3; ppl:  26.1; xent: 3.3; lr: 0.00048; sents:  125455; bsz: 7188/7896/314; 21489/23607 tok/s;  47352 sec;
[2025-07-19 02:35:04,874 INFO] Step 34000/200000; acc: 63.2; ppl:  24.8; xent: 3.2; lr: 0.00048; sents:  147758; bsz: 7243/7921/369; 21729/23764 tok/s;  47485 sec;
[2025-07-19 02:35:41,086 INFO] valid stats calculation
                           took: 36.2090106010437 s.
[2025-07-19 02:35:52,712 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.62560772895813 s.
[2025-07-19 02:35:52,712 INFO] UPDATING VALIDATION BLEU
[2025-07-19 02:35:53,306 INFO] validation BLEU: 36.413544416743534
[2025-07-19 02:35:53,307 INFO] Train perplexity: 29.9456
[2025-07-19 02:35:53,308 INFO] Train accuracy: 62.1037
[2025-07-19 02:35:53,308 INFO] Sentences processed: 4.64526e+07
[2025-07-19 02:35:53,308 INFO] Average bsz: 7391/7942/342
[2025-07-19 02:35:53,308 INFO] Validation perplexity: 17.9029
[2025-07-19 02:35:53,308 INFO] Validation accuracy: 67.296
[2025-07-19 02:35:53,308 INFO] Model is improving acc: 66.9356 --> 67.296.
[2025-07-19 02:35:53,317 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_34000.pt
[2025-07-19 02:38:08,068 INFO] Step 34100/200000; acc: 64.6; ppl:  22.8; xent: 3.1; lr: 0.00048; sents:  141517; bsz: 7628/8188/354; 16655/17879 tok/s;  47668 sec;
[2025-07-19 02:40:22,247 INFO] Step 34200/200000; acc: 63.4; ppl:  24.2; xent: 3.2; lr: 0.00048; sents:  123953; bsz: 7457/7797/310; 22232/23245 tok/s;  47802 sec;
[2025-07-19 02:42:36,854 INFO] Step 34300/200000; acc: 62.8; ppl:  24.7; xent: 3.2; lr: 0.00048; sents:  102403; bsz: 7359/7750/256; 21868/23029 tok/s;  47937 sec;
[2025-07-19 02:44:50,203 INFO] Step 34400/200000; acc: 62.3; ppl:  25.9; xent: 3.3; lr: 0.00048; sents:  118375; bsz: 7283/7880/296; 21845/23636 tok/s;  48070 sec;
[2025-07-19 02:47:04,906 INFO] Step 34500/200000; acc: 63.0; ppl:  24.8; xent: 3.2; lr: 0.00048; sents:  114116; bsz: 7284/7929/285; 21629/23545 tok/s;  48205 sec;
[2025-07-19 02:49:19,242 INFO] Step 34600/200000; acc: 61.8; ppl:  26.4; xent: 3.3; lr: 0.00048; sents:  108338; bsz: 7453/8081/271; 22193/24061 tok/s;  48339 sec;
[2025-07-19 02:51:34,571 INFO] Step 34700/200000; acc: 63.5; ppl:  24.2; xent: 3.2; lr: 0.00047; sents:  138577; bsz: 7676/8231/346; 22687/24329 tok/s;  48475 sec;
[2025-07-19 02:53:48,136 INFO] Step 34800/200000; acc: 62.7; ppl:  25.3; xent: 3.2; lr: 0.00047; sents:  121343; bsz: 7468/8008/303; 22365/23982 tok/s;  48608 sec;
[2025-07-19 02:56:00,945 INFO] Step 34900/200000; acc: 61.9; ppl:  26.4; xent: 3.3; lr: 0.00047; sents:  115245; bsz: 7295/7917/288; 21973/23844 tok/s;  48741 sec;
[2025-07-19 02:58:15,522 INFO] Step 35000/200000; acc: 63.6; ppl:  23.9; xent: 3.2; lr: 0.00047; sents:  129770; bsz: 7642/8004/324; 22715/23791 tok/s;  48876 sec;
[2025-07-19 02:58:52,123 INFO] valid stats calculation
                           took: 36.599037408828735 s.
[2025-07-19 02:59:03,244 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.120227575302124 s.
[2025-07-19 02:59:03,244 INFO] UPDATING VALIDATION BLEU
[2025-07-19 02:59:03,832 INFO] validation BLEU: 35.91861051634387
[2025-07-19 02:59:03,833 INFO] Train perplexity: 29.7848
[2025-07-19 02:59:03,834 INFO] Train accuracy: 62.1288
[2025-07-19 02:59:03,834 INFO] Sentences processed: 4.76663e+07
[2025-07-19 02:59:03,834 INFO] Average bsz: 7393/7943/340
[2025-07-19 02:59:03,834 INFO] Validation perplexity: 17.9219
[2025-07-19 02:59:03,834 INFO] Validation accuracy: 67.1528
[2025-07-19 02:59:03,835 INFO] Decreasing patience: 2/3
[2025-07-19 03:01:18,433 INFO] Step 35100/200000; acc: 64.4; ppl:  23.1; xent: 3.1; lr: 0.00047; sents:  137635; bsz: 7618/8110/344; 16660/17736 tok/s;  49058 sec;
[2025-07-19 03:03:32,449 INFO] Step 35200/200000; acc: 63.6; ppl:  23.9; xent: 3.2; lr: 0.00047; sents:  129327; bsz: 7482/7916/323; 22332/23629 tok/s;  49193 sec;
[2025-07-19 03:05:47,056 INFO] Step 35300/200000; acc: 65.0; ppl:  21.8; xent: 3.1; lr: 0.00047; sents:  126708; bsz: 7358/7942/317; 21865/23600 tok/s;  49327 sec;
[2025-07-19 03:08:01,807 INFO] Step 35400/200000; acc: 68.6; ppl:  17.7; xent: 2.9; lr: 0.00047; sents:  158246; bsz: 7462/8029/396; 22150/23832 tok/s;  49462 sec;
[2025-07-19 03:10:16,380 INFO] Step 35500/200000; acc: 67.8; ppl:  18.3; xent: 2.9; lr: 0.00047; sents:  135405; bsz: 7342/8031/339; 21822/23871 tok/s;  49596 sec;
[2025-07-19 03:12:31,920 INFO] Step 35600/200000; acc: 68.5; ppl:  17.4; xent: 2.9; lr: 0.00047; sents:  135792; bsz: 7583/8227/339; 22378/24281 tok/s;  49732 sec;
[2025-07-19 03:14:47,800 INFO] Step 35700/200000; acc: 69.0; ppl:  16.9; xent: 2.8; lr: 0.00047; sents:  155443; bsz: 7489/8067/389; 22045/23748 tok/s;  49868 sec;
[2025-07-19 03:17:02,856 INFO] Step 35800/200000; acc: 68.1; ppl:  17.6; xent: 2.9; lr: 0.00047; sents:  115043; bsz: 7551/8118/288; 22363/24045 tok/s;  50003 sec;
[2025-07-19 03:19:18,438 INFO] Step 35900/200000; acc: 68.8; ppl:  17.1; xent: 2.8; lr: 0.00047; sents:  121970; bsz: 7779/8111/305; 22951/23929 tok/s;  50138 sec;
[2025-07-19 03:21:33,660 INFO] Step 36000/200000; acc: 68.6; ppl:  17.4; xent: 2.9; lr: 0.00047; sents:  138642; bsz: 7531/8113/347; 22278/24000 tok/s;  50274 sec;
[2025-07-19 03:22:09,976 INFO] valid stats calculation
                           took: 36.312997341156006 s.
[2025-07-19 03:22:21,654 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.677453756332397 s.
[2025-07-19 03:22:21,654 INFO] UPDATING VALIDATION BLEU
[2025-07-19 03:22:22,251 INFO] validation BLEU: 36.6092134047446
[2025-07-19 03:22:22,252 INFO] Train perplexity: 29.4073
[2025-07-19 03:22:22,252 INFO] Train accuracy: 62.2732
[2025-07-19 03:22:22,252 INFO] Sentences processed: 4.90205e+07
[2025-07-19 03:22:22,252 INFO] Average bsz: 7397/7947/340
[2025-07-19 03:22:22,252 INFO] Validation perplexity: 17.6208
[2025-07-19 03:22:22,252 INFO] Validation accuracy: 67.4889
[2025-07-19 03:22:22,253 INFO] Model is improving acc: 67.296 --> 67.4889.
[2025-07-19 03:22:22,261 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_36000.pt
[2025-07-19 03:24:38,268 INFO] Step 36100/200000; acc: 69.1; ppl:  16.9; xent: 2.8; lr: 0.00047; sents:  120826; bsz: 7634/8086/302; 16542/17521 tok/s;  50458 sec;
[2025-07-19 03:26:52,064 INFO] Step 36200/200000; acc: 68.3; ppl:  17.7; xent: 2.9; lr: 0.00046; sents:  115548; bsz: 7295/7628/289; 21808/22806 tok/s;  50592 sec;
[2025-07-19 03:29:06,061 INFO] Step 36300/200000; acc: 68.0; ppl:  17.8; xent: 2.9; lr: 0.00046; sents:  131748; bsz: 7225/7669/329; 21568/22893 tok/s;  50726 sec;
[2025-07-19 03:31:20,637 INFO] Step 36400/200000; acc: 68.9; ppl:  17.3; xent: 2.9; lr: 0.00046; sents:  131832; bsz: 7273/8001/330; 21616/23781 tok/s;  50861 sec;
[2025-07-19 03:33:36,537 INFO] Step 36500/200000; acc: 69.7; ppl:  16.4; xent: 2.8; lr: 0.00046; sents:  127280; bsz: 7574/8245/318; 22292/24267 tok/s;  50997 sec;
[2025-07-19 03:35:52,008 INFO] Step 36600/200000; acc: 71.4; ppl:  15.3; xent: 2.7; lr: 0.00046; sents:  153143; bsz: 7573/8196/383; 22360/24201 tok/s;  51132 sec;
[2025-07-19 03:38:08,326 INFO] Step 36700/200000; acc: 70.7; ppl:  15.6; xent: 2.7; lr: 0.00046; sents:  144449; bsz: 7824/8331/361; 22958/24447 tok/s;  51268 sec;
[2025-07-19 03:40:23,408 INFO] Step 36800/200000; acc: 69.6; ppl:  16.6; xent: 2.8; lr: 0.00046; sents:  138155; bsz: 7550/8005/345; 22358/23703 tok/s;  51403 sec;
[2025-07-19 03:42:38,916 INFO] Step 36900/200000; acc: 69.3; ppl:  16.9; xent: 2.8; lr: 0.00046; sents:  143316; bsz: 7515/8116/358; 22183/23958 tok/s;  51539 sec;
[2025-07-19 03:44:53,750 INFO] Step 37000/200000; acc: 69.3; ppl:  16.9; xent: 2.8; lr: 0.00046; sents:  134151; bsz: 7520/7990/335; 22308/23703 tok/s;  51674 sec;
[2025-07-19 03:45:30,166 INFO] valid stats calculation
                           took: 36.413822174072266 s.
[2025-07-19 03:45:41,896 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.728594303131104 s.
[2025-07-19 03:45:41,896 INFO] UPDATING VALIDATION BLEU
[2025-07-19 03:45:42,487 INFO] validation BLEU: 36.2475140571486
[2025-07-19 03:45:42,488 INFO] Train perplexity: 28.9567
[2025-07-19 03:45:42,488 INFO] Train accuracy: 62.4692
[2025-07-19 03:45:42,488 INFO] Sentences processed: 5.03609e+07
[2025-07-19 03:45:42,488 INFO] Average bsz: 7399/7949/340
[2025-07-19 03:45:42,488 INFO] Validation perplexity: 17.6174
[2025-07-19 03:45:42,489 INFO] Validation accuracy: 67.4428
[2025-07-19 03:45:42,489 INFO] Decreasing patience: 2/3
[2025-07-19 03:47:56,298 INFO] Step 37100/200000; acc: 69.3; ppl:  17.2; xent: 2.8; lr: 0.00046; sents:  143914; bsz: 7374/7999/360; 16159/17529 tok/s;  51856 sec;
[2025-07-19 03:50:11,164 INFO] Step 37200/200000; acc: 69.0; ppl:  17.9; xent: 2.9; lr: 0.00046; sents:  124123; bsz: 7376/7839/310; 21877/23250 tok/s;  51991 sec;
[2025-07-19 03:52:26,033 INFO] Step 37300/200000; acc: 69.0; ppl:  18.0; xent: 2.9; lr: 0.00046; sents:  137393; bsz: 7328/8011/343; 21734/23759 tok/s;  52126 sec;
[2025-07-19 03:54:42,846 INFO] Step 37400/200000; acc: 70.7; ppl:  16.7; xent: 2.8; lr: 0.00046; sents:  134991; bsz: 7508/7979/337; 21950/23328 tok/s;  52263 sec;
[2025-07-19 03:57:00,054 INFO] Step 37500/200000; acc: 70.9; ppl:  16.1; xent: 2.8; lr: 0.00046; sents:  123930; bsz: 7645/8025/310; 22288/23396 tok/s;  52400 sec;
[2025-07-19 03:59:16,022 INFO] Step 37600/200000; acc: 70.6; ppl:  16.5; xent: 2.8; lr: 0.00046; sents:  164551; bsz: 7512/8023/411; 22101/23604 tok/s;  52536 sec;
[2025-07-19 04:01:31,259 INFO] Step 37700/200000; acc: 70.0; ppl:  17.1; xent: 2.8; lr: 0.00046; sents:  158333; bsz: 7408/8068/396; 21911/23863 tok/s;  52671 sec;
[2025-07-19 04:03:48,922 INFO] Step 37800/200000; acc: 71.8; ppl:  15.5; xent: 2.7; lr: 0.00045; sents:  154951; bsz: 7695/8149/387; 22360/23678 tok/s;  52809 sec;
[2025-07-19 04:06:05,627 INFO] Step 37900/200000; acc: 71.0; ppl:  16.1; xent: 2.8; lr: 0.00045; sents:  176513; bsz: 7697/8250/441; 22522/24139 tok/s;  52946 sec;
[2025-07-19 04:08:20,397 INFO] Step 38000/200000; acc: 69.6; ppl:  17.4; xent: 2.9; lr: 0.00045; sents:  139587; bsz: 7248/7923/349; 21511/23516 tok/s;  53080 sec;
[2025-07-19 04:08:56,503 INFO] valid stats calculation
                           took: 36.10325479507446 s.
[2025-07-19 04:09:08,010 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.50700855255127 s.
[2025-07-19 04:09:08,010 INFO] UPDATING VALIDATION BLEU
[2025-07-19 04:09:08,600 INFO] validation BLEU: 36.35783777111379
[2025-07-19 04:09:08,601 INFO] Train perplexity: 28.542
[2025-07-19 04:09:08,601 INFO] Train accuracy: 62.6743
[2025-07-19 04:09:08,601 INFO] Sentences processed: 5.18192e+07
[2025-07-19 04:09:08,601 INFO] Average bsz: 7401/7951/341
[2025-07-19 04:09:08,601 INFO] Validation perplexity: 17.5676
[2025-07-19 04:09:08,601 INFO] Validation accuracy: 67.5581
[2025-07-19 04:09:08,602 INFO] Model is improving acc: 67.4889 --> 67.5581.
[2025-07-19 04:09:08,610 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_38000.pt
[2025-07-19 04:11:22,833 INFO] Step 38100/200000; acc: 69.0; ppl:  18.0; xent: 2.9; lr: 0.00045; sents:  107399; bsz: 7011/7603/268; 15372/16669 tok/s;  53263 sec;
[2025-07-19 04:13:38,256 INFO] Step 38200/200000; acc: 70.4; ppl:  16.7; xent: 2.8; lr: 0.00045; sents:  112767; bsz: 7318/7857/282; 21614/23206 tok/s;  53398 sec;
[2025-07-19 04:15:53,610 INFO] Step 38300/200000; acc: 70.9; ppl:  16.2; xent: 2.8; lr: 0.00045; sents:  139348; bsz: 7549/7937/348; 22308/23455 tok/s;  53534 sec;
[2025-07-19 04:18:09,695 INFO] Step 38400/200000; acc: 70.4; ppl:  16.4; xent: 2.8; lr: 0.00045; sents:  122018; bsz: 7479/7912/305; 21984/23256 tok/s;  53670 sec;
[2025-07-19 04:20:25,649 INFO] Step 38500/200000; acc: 70.3; ppl:  16.4; xent: 2.8; lr: 0.00045; sents:  118429; bsz: 7623/8177/296; 22429/24060 tok/s;  53806 sec;
[2025-07-19 04:22:40,966 INFO] Step 38600/200000; acc: 70.9; ppl:  16.1; xent: 2.8; lr: 0.00045; sents:  123410; bsz: 7386/7869/309; 21833/23260 tok/s;  53941 sec;
[2025-07-19 04:24:54,618 INFO] Step 38700/200000; acc: 69.9; ppl:  17.1; xent: 2.8; lr: 0.00045; sents:  121623; bsz: 7086/7629/304; 21209/22834 tok/s;  54075 sec;
[2025-07-19 04:27:09,405 INFO] Step 38800/200000; acc: 70.3; ppl:  16.5; xent: 2.8; lr: 0.00045; sents:  140863; bsz: 7249/8012/352; 21511/23778 tok/s;  54209 sec;
[2025-07-19 04:29:24,615 INFO] Step 38900/200000; acc: 70.0; ppl:  16.9; xent: 2.8; lr: 0.00045; sents:  134288; bsz: 7368/7931/336; 21797/23463 tok/s;  54345 sec;
[2025-07-19 04:31:38,002 INFO] Step 39000/200000; acc: 67.8; ppl:  19.1; xent: 2.9; lr: 0.00045; sents:  123363; bsz: 7114/7709/308; 21334/23119 tok/s;  54478 sec;
[2025-07-19 04:32:14,551 INFO] valid stats calculation
                           took: 36.547335386276245 s.
[2025-07-19 04:32:25,860 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.308593988418579 s.
[2025-07-19 04:32:25,860 INFO] UPDATING VALIDATION BLEU
[2025-07-19 04:32:26,448 INFO] validation BLEU: 36.469035242185114
[2025-07-19 04:32:26,449 INFO] Train perplexity: 28.1647
[2025-07-19 04:32:26,449 INFO] Train accuracy: 62.8605
[2025-07-19 04:32:26,449 INFO] Sentences processed: 5.30627e+07
[2025-07-19 04:32:26,449 INFO] Average bsz: 7399/7949/340
[2025-07-19 04:32:26,449 INFO] Validation perplexity: 17.5302
[2025-07-19 04:32:26,449 INFO] Validation accuracy: 67.6091
[2025-07-19 04:32:26,450 INFO] Model is improving acc: 67.5581 --> 67.6091.
[2025-07-19 04:34:41,709 INFO] Step 39100/200000; acc: 68.2; ppl:  18.9; xent: 2.9; lr: 0.00045; sents:  133291; bsz: 7525/7874/333; 16384/17145 tok/s;  54662 sec;
[2025-07-19 04:36:56,408 INFO] Step 39200/200000; acc: 68.2; ppl:  18.9; xent: 2.9; lr: 0.00045; sents:  138916; bsz: 7246/7861/347; 21517/23344 tok/s;  54796 sec;
[2025-07-19 04:39:11,005 INFO] Step 39300/200000; acc: 68.4; ppl:  18.5; xent: 2.9; lr: 0.00045; sents:  137266; bsz: 7240/7763/343; 21516/23070 tok/s;  54931 sec;
[2025-07-19 04:41:25,316 INFO] Step 39400/200000; acc: 69.1; ppl:  17.9; xent: 2.9; lr: 0.00045; sents:  150080; bsz: 7394/7708/375; 22022/22955 tok/s;  55065 sec;
[2025-07-19 04:43:40,809 INFO] Step 39500/200000; acc: 69.5; ppl:  17.2; xent: 2.8; lr: 0.00044; sents:  139181; bsz: 7423/7910/348; 21914/23352 tok/s;  55201 sec;
[2025-07-19 04:45:54,582 INFO] Step 39600/200000; acc: 68.8; ppl:  18.3; xent: 2.9; lr: 0.00044; sents:  143660; bsz: 7119/7654/359; 21287/22885 tok/s;  55335 sec;
[2025-07-19 04:48:09,399 INFO] Step 39700/200000; acc: 69.7; ppl:  17.2; xent: 2.8; lr: 0.00044; sents:  154519; bsz: 7378/7965/386; 21890/23632 tok/s;  55469 sec;
[2025-07-19 04:50:22,788 INFO] Step 39800/200000; acc: 69.3; ppl:  17.6; xent: 2.9; lr: 0.00044; sents:  149653; bsz: 7199/7972/374; 21588/23905 tok/s;  55603 sec;
[2025-07-19 04:52:37,453 INFO] Step 39900/200000; acc: 69.6; ppl:  17.3; xent: 2.8; lr: 0.00044; sents:  121694; bsz: 7409/7759/304; 22008/23047 tok/s;  55738 sec;
[2025-07-19 04:54:52,322 INFO] Step 40000/200000; acc: 70.1; ppl:  17.0; xent: 2.8; lr: 0.00044; sents:  130753; bsz: 7465/7975/327; 22139/23653 tok/s;  55872 sec;
[2025-07-19 04:55:28,108 INFO] valid stats calculation
                           took: 35.78391718864441 s.
[2025-07-19 04:55:39,640 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.531465291976929 s.
[2025-07-19 04:55:39,640 INFO] UPDATING VALIDATION BLEU
[2025-07-19 04:55:40,225 INFO] validation BLEU: 36.05790678751329
[2025-07-19 04:55:40,226 INFO] Train perplexity: 27.8499
[2025-07-19 04:55:40,226 INFO] Train accuracy: 63.0143
[2025-07-19 04:55:40,226 INFO] Sentences processed: 5.44617e+07
[2025-07-19 04:55:40,226 INFO] Average bsz: 7398/7946/340
[2025-07-19 04:55:40,226 INFO] Validation perplexity: 17.5653
[2025-07-19 04:55:40,227 INFO] Validation accuracy: 67.4986
[2025-07-19 04:55:40,227 INFO] Decreasing patience: 2/3
[2025-07-19 04:55:40,235 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_40000.pt
[2025-07-19 04:57:54,984 INFO] Step 40100/200000; acc: 70.5; ppl:  16.6; xent: 2.8; lr: 0.00044; sents:  157258; bsz: 7362/7903/393; 16122/17306 tok/s;  56055 sec;
[2025-07-19 05:00:08,923 INFO] Step 40200/200000; acc: 69.4; ppl:  17.4; xent: 2.9; lr: 0.00044; sents:  133574; bsz: 7140/7642/334; 21325/22823 tok/s;  56189 sec;
[2025-07-19 05:02:24,705 INFO] Step 40300/200000; acc: 69.3; ppl:  17.3; xent: 2.9; lr: 0.00044; sents:  125909; bsz: 7415/7883/315; 21845/23223 tok/s;  56325 sec;
[2025-07-19 05:04:40,338 INFO] Step 40400/200000; acc: 70.2; ppl:  16.7; xent: 2.8; lr: 0.00044; sents:  153728; bsz: 7529/7990/384; 22203/23565 tok/s;  56460 sec;
[2025-07-19 05:06:55,942 INFO] Step 40500/200000; acc: 70.1; ppl:  16.8; xent: 2.8; lr: 0.00044; sents:  153858; bsz: 7527/8069/385; 22203/23803 tok/s;  56596 sec;
[2025-07-19 05:09:11,650 INFO] Step 40600/200000; acc: 69.8; ppl:  17.1; xent: 2.8; lr: 0.00044; sents:  142921; bsz: 7355/7924/357; 21678/23355 tok/s;  56732 sec;
[2025-07-19 05:11:26,668 INFO] Step 40700/200000; acc: 70.4; ppl:  16.5; xent: 2.8; lr: 0.00044; sents:  145850; bsz: 7439/7917/365; 22040/23455 tok/s;  56867 sec;
[2025-07-19 05:13:42,193 INFO] Step 40800/200000; acc: 70.0; ppl:  17.0; xent: 2.8; lr: 0.00044; sents:  148866; bsz: 7531/8034/372; 22229/23713 tok/s;  57002 sec;
[2025-07-19 05:15:56,011 INFO] Step 40900/200000; acc: 70.1; ppl:  16.9; xent: 2.8; lr: 0.00044; sents:  147235; bsz: 7282/7814/368; 21766/23357 tok/s;  57136 sec;
[2025-07-19 05:18:10,607 INFO] Step 41000/200000; acc: 71.3; ppl:  15.8; xent: 2.8; lr: 0.00044; sents:  154164; bsz: 7283/7785/385; 21643/23136 tok/s;  57271 sec;
[2025-07-19 05:18:46,798 INFO] valid stats calculation
                           took: 36.18780040740967 s.
[2025-07-19 05:18:58,273 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.475028991699219 s.
[2025-07-19 05:18:58,273 INFO] UPDATING VALIDATION BLEU
[2025-07-19 05:18:58,860 INFO] validation BLEU: 36.65087767225401
[2025-07-19 05:18:58,860 INFO] Train perplexity: 27.5107
[2025-07-19 05:18:58,861 INFO] Train accuracy: 63.1868
[2025-07-19 05:18:58,861 INFO] Sentences processed: 5.59251e+07
[2025-07-19 05:18:58,861 INFO] Average bsz: 7398/7945/341
[2025-07-19 05:18:58,861 INFO] Validation perplexity: 17.4464
[2025-07-19 05:18:58,861 INFO] Validation accuracy: 67.6988
[2025-07-19 05:18:58,862 INFO] Model is improving acc: 67.6091 --> 67.6988.
[2025-07-19 05:21:12,465 INFO] Step 41100/200000; acc: 70.5; ppl:  16.7; xent: 2.8; lr: 0.00044; sents:  141179; bsz: 7256/7785/353; 15961/17124 tok/s;  57453 sec;
[2025-07-19 05:23:25,873 INFO] Step 41200/200000; acc: 69.3; ppl:  17.9; xent: 2.9; lr: 0.00044; sents:  127914; bsz: 6921/7505/320; 20752/22503 tok/s;  57586 sec;
[2025-07-19 05:25:38,739 INFO] Step 41300/200000; acc: 69.7; ppl:  17.5; xent: 2.9; lr: 0.00043; sents:  139027; bsz: 7079/7637/348; 21312/22992 tok/s;  57719 sec;
[2025-07-19 05:27:53,130 INFO] Step 41400/200000; acc: 71.6; ppl:  15.9; xent: 2.8; lr: 0.00043; sents:  163112; bsz: 7313/7948/408; 21767/23656 tok/s;  57853 sec;
[2025-07-19 05:30:08,190 INFO] Step 41500/200000; acc: 71.0; ppl:  16.0; xent: 2.8; lr: 0.00043; sents:  154248; bsz: 7410/8058/386; 21945/23866 tok/s;  57988 sec;
[2025-07-19 05:32:22,169 INFO] Step 41600/200000; acc: 69.9; ppl:  17.2; xent: 2.8; lr: 0.00043; sents:  142650; bsz: 7110/7819/357; 21227/23344 tok/s;  58122 sec;
[2025-07-19 05:34:36,542 INFO] Step 41700/200000; acc: 70.7; ppl:  16.5; xent: 2.8; lr: 0.00043; sents:  134623; bsz: 7333/7857/337; 21829/23389 tok/s;  58257 sec;
[2025-07-19 05:36:52,400 INFO] Step 41800/200000; acc: 71.3; ppl:  15.9; xent: 2.8; lr: 0.00043; sents:  133791; bsz: 7397/8002/334; 21779/23560 tok/s;  58392 sec;
[2025-07-19 05:39:08,290 INFO] Step 41900/200000; acc: 70.7; ppl:  16.5; xent: 2.8; lr: 0.00043; sents:  134658; bsz: 7136/7670/337; 21006/22577 tok/s;  58528 sec;
[2025-07-19 05:41:21,602 INFO] Step 42000/200000; acc: 70.6; ppl:  16.7; xent: 2.8; lr: 0.00043; sents:  157770; bsz: 7070/7680/394; 21214/23043 tok/s;  58662 sec;
[2025-07-19 05:41:57,827 INFO] valid stats calculation
                           took: 36.09864354133606 s.
[2025-07-19 05:42:09,534 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.706900596618652 s.
[2025-07-19 05:42:09,534 INFO] UPDATING VALIDATION BLEU
[2025-07-19 05:42:10,126 INFO] validation BLEU: 36.37133705228429
[2025-07-19 05:42:10,127 INFO] Train perplexity: 27.1897
[2025-07-19 05:42:10,127 INFO] Train accuracy: 63.3584
[2025-07-19 05:42:10,127 INFO] Sentences processed: 5.73541e+07
[2025-07-19 05:42:10,127 INFO] Average bsz: 7393/7941/341
[2025-07-19 05:42:10,127 INFO] Validation perplexity: 17.5197
[2025-07-19 05:42:10,128 INFO] Validation accuracy: 67.4914
[2025-07-19 05:42:10,135 INFO] Decreasing patience: 2/3
[2025-07-19 05:42:10,144 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_42000.pt
[2025-07-19 05:44:26,081 INFO] Step 42100/200000; acc: 71.5; ppl:  15.5; xent: 2.7; lr: 0.00043; sents:  169204; bsz: 7453/8036/423; 16172/17436 tok/s;  58846 sec;
[2025-07-19 05:46:40,520 INFO] Step 42200/200000; acc: 70.8; ppl:  16.2; xent: 2.8; lr: 0.00043; sents:  154078; bsz: 7227/7914/385; 21504/23548 tok/s;  58981 sec;
[2025-07-19 05:48:54,546 INFO] Step 42300/200000; acc: 71.0; ppl:  16.0; xent: 2.8; lr: 0.00043; sents:  145093; bsz: 7283/7864/363; 21736/23471 tok/s;  59115 sec;
[2025-07-19 05:51:10,198 INFO] Step 42400/200000; acc: 70.7; ppl:  16.3; xent: 2.8; lr: 0.00043; sents:  157697; bsz: 7606/8148/394; 22427/24026 tok/s;  59250 sec;
[2025-07-19 05:53:25,458 INFO] Step 42500/200000; acc: 68.2; ppl:  18.7; xent: 2.9; lr: 0.00043; sents:  137885; bsz: 7498/7844/345; 22174/23197 tok/s;  59386 sec;
[2025-07-19 05:55:39,191 INFO] Step 42600/200000; acc: 62.8; ppl:  24.9; xent: 3.2; lr: 0.00043; sents:  112451; bsz: 7299/7672/281; 21830/22949 tok/s;  59519 sec;
[2025-07-19 05:57:51,662 INFO] Step 42700/200000; acc: 61.2; ppl:  27.2; xent: 3.3; lr: 0.00043; sents:  119558; bsz: 7299/7842/299; 22040/23679 tok/s;  59652 sec;
[2025-07-19 06:00:06,503 INFO] Step 42800/200000; acc: 62.9; ppl:  24.3; xent: 3.2; lr: 0.00043; sents:  121942; bsz: 7564/8107/305; 22438/24050 tok/s;  59787 sec;
[2025-07-19 06:02:22,025 INFO] Step 42900/200000; acc: 63.9; ppl:  23.3; xent: 3.1; lr: 0.00043; sents:  131983; bsz: 7719/8295/330; 22783/24484 tok/s;  59922 sec;
[2025-07-19 06:04:36,606 INFO] Step 43000/200000; acc: 64.0; ppl:  23.4; xent: 3.2; lr: 0.00043; sents:  119781; bsz: 7406/7938/299; 22014/23593 tok/s;  60057 sec;
[2025-07-19 06:05:10,454 INFO] valid stats calculation
                           took: 33.8461492061615 s.
[2025-07-19 06:05:22,099 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.644124031066895 s.
[2025-07-19 06:05:22,099 INFO] UPDATING VALIDATION BLEU
[2025-07-19 06:05:22,699 INFO] validation BLEU: 36.31847091094777
[2025-07-19 06:05:22,700 INFO] Train perplexity: 26.9998
[2025-07-19 06:05:22,701 INFO] Train accuracy: 63.4368
[2025-07-19 06:05:22,701 INFO] Sentences processed: 5.87237e+07
[2025-07-19 06:05:22,701 INFO] Average bsz: 7394/7942/341
[2025-07-19 06:05:22,701 INFO] Validation perplexity: 17.3217
[2025-07-19 06:05:22,701 INFO] Validation accuracy: 67.6612
[2025-07-19 06:05:22,701 INFO] Decreasing patience: 1/3
[2025-07-19 06:07:37,139 INFO] Step 43100/200000; acc: 63.2; ppl:  24.1; xent: 3.2; lr: 0.00043; sents:  119213; bsz: 7611/8107/298; 16864/17962 tok/s;  60237 sec;
[2025-07-19 06:09:52,923 INFO] Step 43200/200000; acc: 64.9; ppl:  21.9; xent: 3.1; lr: 0.00043; sents:  129353; bsz: 7693/8051/323; 22662/23717 tok/s;  60373 sec;
[2025-07-19 06:12:07,402 INFO] Step 43300/200000; acc: 63.0; ppl:  24.7; xent: 3.2; lr: 0.00042; sents:  118011; bsz: 7092/7702/295; 21094/22910 tok/s;  60507 sec;
[2025-07-19 06:14:21,305 INFO] Step 43400/200000; acc: 63.0; ppl:  25.0; xent: 3.2; lr: 0.00042; sents:  135855; bsz: 7156/8171/340; 21376/24410 tok/s;  60641 sec;
[2025-07-19 06:16:34,818 INFO] Step 43500/200000; acc: 63.0; ppl:  24.5; xent: 3.2; lr: 0.00042; sents:  117739; bsz: 7328/8077/294; 21955/24199 tok/s;  60775 sec;
[2025-07-19 06:18:50,232 INFO] Step 43600/200000; acc: 64.8; ppl:  22.2; xent: 3.1; lr: 0.00042; sents:  120048; bsz: 7678/8098/300; 22680/23921 tok/s;  60910 sec;
[2025-07-19 06:21:04,077 INFO] Step 43700/200000; acc: 62.6; ppl:  25.1; xent: 3.2; lr: 0.00042; sents:  122354; bsz: 7427/8025/306; 22195/23984 tok/s;  61044 sec;
[2025-07-19 06:23:17,516 INFO] Step 43800/200000; acc: 62.3; ppl:  25.4; xent: 3.2; lr: 0.00042; sents:  121927; bsz: 7325/7959/305; 21958/23857 tok/s;  61178 sec;
[2025-07-19 06:25:32,346 INFO] Step 43900/200000; acc: 63.7; ppl:  23.4; xent: 3.2; lr: 0.00042; sents:  125403; bsz: 7636/8135/314; 22654/24133 tok/s;  61312 sec;
[2025-07-19 06:27:46,769 INFO] Step 44000/200000; acc: 64.0; ppl:  23.1; xent: 3.1; lr: 0.00042; sents:  132519; bsz: 7578/8235/331; 22551/24505 tok/s;  61447 sec;
[2025-07-19 06:28:22,872 INFO] valid stats calculation
                           took: 36.100425243377686 s.
[2025-07-19 06:28:33,952 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.079596519470215 s.
[2025-07-19 06:28:33,952 INFO] UPDATING VALIDATION BLEU
[2025-07-19 06:28:34,542 INFO] validation BLEU: 36.54793818776106
[2025-07-19 06:28:34,543 INFO] Train perplexity: 26.9244
[2025-07-19 06:28:34,543 INFO] Train accuracy: 63.4373
[2025-07-19 06:28:34,543 INFO] Sentences processed: 5.99662e+07
[2025-07-19 06:28:34,543 INFO] Average bsz: 7395/7944/341
[2025-07-19 06:28:34,544 INFO] Validation perplexity: 17.2971
[2025-07-19 06:28:34,544 INFO] Validation accuracy: 67.8178
[2025-07-19 06:28:34,544 INFO] Model is improving acc: 67.6988 --> 67.8178.
[2025-07-19 06:28:34,553 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_44000.pt
[2025-07-19 06:30:48,460 INFO] Step 44100/200000; acc: 62.1; ppl:  25.8; xent: 3.2; lr: 0.00042; sents:  131955; bsz: 7215/7997/330; 15884/17606 tok/s;  61629 sec;
[2025-07-19 06:33:02,857 INFO] Step 44200/200000; acc: 62.8; ppl:  25.1; xent: 3.2; lr: 0.00042; sents:  119523; bsz: 7540/8148/299; 22442/24251 tok/s;  61763 sec;
[2025-07-19 06:35:15,978 INFO] Step 44300/200000; acc: 61.8; ppl:  26.4; xent: 3.3; lr: 0.00042; sents:  120312; bsz: 7278/7964/301; 21871/23931 tok/s;  61896 sec;
[2025-07-19 06:37:29,434 INFO] Step 44400/200000; acc: 62.6; ppl:  25.3; xent: 3.2; lr: 0.00042; sents:  130279; bsz: 7266/7869/326; 21777/23586 tok/s;  62029 sec;
[2025-07-19 06:39:42,724 INFO] Step 44500/200000; acc: 64.5; ppl:  22.5; xent: 3.1; lr: 0.00042; sents:  136118; bsz: 7253/7940/340; 21766/23829 tok/s;  62163 sec;
[2025-07-19 06:41:57,973 INFO] Step 44600/200000; acc: 66.3; ppl:  20.1; xent: 3.0; lr: 0.00042; sents:  148492; bsz: 7742/8196/371; 22899/24239 tok/s;  62298 sec;
[2025-07-19 06:44:13,543 INFO] Step 44700/200000; acc: 69.2; ppl:  16.8; xent: 2.8; lr: 0.00042; sents:  157177; bsz: 7541/8286/393; 22257/24456 tok/s;  62434 sec;
[2025-07-19 06:46:28,164 INFO] Step 44800/200000; acc: 69.8; ppl:  16.4; xent: 2.8; lr: 0.00042; sents:  152754; bsz: 7286/7954/382; 21648/23634 tok/s;  62568 sec;
[2025-07-19 06:48:43,842 INFO] Step 44900/200000; acc: 70.2; ppl:  16.0; xent: 2.8; lr: 0.00042; sents:  128907; bsz: 7680/8050/322; 22641/23734 tok/s;  62704 sec;
[2025-07-19 06:50:58,327 INFO] Step 45000/200000; acc: 70.0; ppl:  16.2; xent: 2.8; lr: 0.00042; sents:  134135; bsz: 7508/7938/335; 22333/23611 tok/s;  62838 sec;
[2025-07-19 06:51:34,326 INFO] valid stats calculation
                           took: 35.99697828292847 s.
[2025-07-19 06:51:45,682 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.354969263076782 s.
[2025-07-19 06:51:45,682 INFO] UPDATING VALIDATION BLEU
[2025-07-19 06:51:46,268 INFO] validation BLEU: 36.925267766384295
[2025-07-19 06:51:46,269 INFO] Train perplexity: 26.7631
[2025-07-19 06:51:46,269 INFO] Train accuracy: 63.4934
[2025-07-19 06:51:46,269 INFO] Sentences processed: 6.13258e+07
[2025-07-19 06:51:46,269 INFO] Average bsz: 7396/7946/341
[2025-07-19 06:51:46,269 INFO] Validation perplexity: 17.0978
[2025-07-19 06:51:46,270 INFO] Validation accuracy: 68.041
[2025-07-19 06:51:46,270 INFO] Model is improving acc: 67.8178 --> 68.041.
[2025-07-19 06:54:00,881 INFO] Step 45100/200000; acc: 70.2; ppl:  15.8; xent: 2.8; lr: 0.00042; sents:  128245; bsz: 7716/8343/321; 16906/18280 tok/s;  63021 sec;
[2025-07-19 06:56:17,316 INFO] Step 45200/200000; acc: 71.2; ppl:  15.2; xent: 2.7; lr: 0.00042; sents:  146454; bsz: 7592/8170/366; 22258/23952 tok/s;  63157 sec;
[2025-07-19 06:58:31,402 INFO] Step 45300/200000; acc: 70.6; ppl:  15.6; xent: 2.7; lr: 0.00042; sents:  142780; bsz: 7385/7908/357; 22030/23590 tok/s;  63291 sec;
[2025-07-19 07:00:47,290 INFO] Step 45400/200000; acc: 70.4; ppl:  15.8; xent: 2.8; lr: 0.00041; sents:  135056; bsz: 7600/8119/338; 22372/23899 tok/s;  63427 sec;
[2025-07-19 07:03:02,365 INFO] Step 45500/200000; acc: 70.5; ppl:  15.7; xent: 2.8; lr: 0.00041; sents:  137627; bsz: 7559/8010/344; 22384/23719 tok/s;  63562 sec;
[2025-07-19 07:05:17,425 INFO] Step 45600/200000; acc: 69.9; ppl:  16.1; xent: 2.8; lr: 0.00041; sents:  137797; bsz: 7430/8049/344; 22007/23840 tok/s;  63697 sec;
[2025-07-19 07:07:33,313 INFO] Step 45700/200000; acc: 70.1; ppl:  16.0; xent: 2.8; lr: 0.00041; sents:  120163; bsz: 7495/7971/300; 22064/23463 tok/s;  63833 sec;
[2025-07-19 07:09:48,727 INFO] Step 45800/200000; acc: 70.1; ppl:  15.7; xent: 2.8; lr: 0.00041; sents:  132229; bsz: 7646/8234/331; 22587/24324 tok/s;  63969 sec;
[2025-07-19 07:12:03,389 INFO] Step 45900/200000; acc: 70.2; ppl:  15.8; xent: 2.8; lr: 0.00041; sents:  143468; bsz: 7433/8058/359; 22080/23935 tok/s;  64103 sec;
[2025-07-19 07:14:17,933 INFO] Step 46000/200000; acc: 70.3; ppl:  15.9; xent: 2.8; lr: 0.00041; sents:  123541; bsz: 7287/7842/309; 21666/23316 tok/s;  64238 sec;
[2025-07-19 07:14:54,019 INFO] valid stats calculation
                           took: 36.08294677734375 s.
[2025-07-19 07:15:05,278 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.258837699890137 s.
[2025-07-19 07:15:05,278 INFO] UPDATING VALIDATION BLEU
[2025-07-19 07:15:05,872 INFO] validation BLEU: 36.979342828223885
[2025-07-19 07:15:05,873 INFO] Train perplexity: 26.4515
[2025-07-19 07:15:05,873 INFO] Train accuracy: 63.6453
[2025-07-19 07:15:05,873 INFO] Sentences processed: 6.26732e+07
[2025-07-19 07:15:05,873 INFO] Average bsz: 7399/7949/341
[2025-07-19 07:15:05,873 INFO] Validation perplexity: 17.0938
[2025-07-19 07:15:05,873 INFO] Validation accuracy: 68.0192
[2025-07-19 07:15:05,874 INFO] Decreasing patience: 2/3
[2025-07-19 07:15:05,882 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_46000.pt
[2025-07-19 07:17:21,777 INFO] Step 46100/200000; acc: 70.4; ppl:  15.7; xent: 2.8; lr: 0.00041; sents:  125913; bsz: 7609/8054/315; 16556/17525 tok/s;  64422 sec;
[2025-07-19 07:19:38,402 INFO] Step 46200/200000; acc: 70.6; ppl:  15.5; xent: 2.7; lr: 0.00041; sents:  123004; bsz: 7704/8224/308; 22556/24080 tok/s;  64558 sec;
[2025-07-19 07:21:54,450 INFO] Step 46300/200000; acc: 70.1; ppl:  16.1; xent: 2.8; lr: 0.00041; sents:  118004; bsz: 7516/7889/295; 22097/23195 tok/s;  64695 sec;
[2025-07-19 07:24:10,405 INFO] Step 46400/200000; acc: 69.9; ppl:  16.4; xent: 2.8; lr: 0.00041; sents:  126447; bsz: 7596/8026/316; 22348/23614 tok/s;  64830 sec;
[2025-07-19 07:26:23,715 INFO] Step 46500/200000; acc: 68.0; ppl:  18.9; xent: 2.9; lr: 0.00041; sents:  127436; bsz: 7049/7596/319; 21151/22793 tok/s;  64964 sec;
[2025-07-19 07:28:34,778 INFO] Step 46600/200000; acc: 67.2; ppl:  19.9; xent: 3.0; lr: 0.00041; sents:  116761; bsz: 6657/7373/292; 20317/22501 tok/s;  65095 sec;
[2025-07-19 07:30:47,662 INFO] Step 46700/200000; acc: 69.6; ppl:  17.7; xent: 2.9; lr: 0.00041; sents:  124272; bsz: 7139/7692/311; 21490/23157 tok/s;  65228 sec;
[2025-07-19 07:33:02,139 INFO] Step 46800/200000; acc: 70.6; ppl:  16.6; xent: 2.8; lr: 0.00041; sents:  114103; bsz: 7217/7645/285; 21467/22739 tok/s;  65362 sec;
[2025-07-19 07:35:18,569 INFO] Step 46900/200000; acc: 71.1; ppl:  15.9; xent: 2.8; lr: 0.00041; sents:  125367; bsz: 7646/7880/313; 22417/23103 tok/s;  65499 sec;
[2025-07-19 07:37:35,104 INFO] Step 47000/200000; acc: 71.1; ppl:  16.0; xent: 2.8; lr: 0.00041; sents:  122114; bsz: 7589/7900/305; 22233/23144 tok/s;  65635 sec;
[2025-07-19 07:38:10,913 INFO] valid stats calculation
                           took: 35.80694890022278 s.
[2025-07-19 07:38:21,987 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.073846340179443 s.
[2025-07-19 07:38:21,987 INFO] UPDATING VALIDATION BLEU
[2025-07-19 07:38:22,582 INFO] validation BLEU: 36.69405293463933
[2025-07-19 07:38:22,583 INFO] Train perplexity: 26.2001
[2025-07-19 07:38:22,583 INFO] Train accuracy: 63.7762
[2025-07-19 07:38:22,583 INFO] Sentences processed: 6.38966e+07
[2025-07-19 07:38:22,583 INFO] Average bsz: 7398/7947/340
[2025-07-19 07:38:22,583 INFO] Validation perplexity: 16.9704
[2025-07-19 07:38:22,583 INFO] Validation accuracy: 68.0022
[2025-07-19 07:38:22,584 INFO] Decreasing patience: 1/3
[2025-07-19 07:40:35,523 INFO] Step 47100/200000; acc: 69.5; ppl:  17.3; xent: 2.8; lr: 0.00041; sents:  124416; bsz: 7178/8040/311; 15915/17825 tok/s;  65816 sec;
[2025-07-19 07:42:51,602 INFO] Step 47200/200000; acc: 70.2; ppl:  16.6; xent: 2.8; lr: 0.00041; sents:  158592; bsz: 7510/8022/396; 22074/23580 tok/s;  65952 sec;
[2025-07-19 07:45:06,653 INFO] Step 47300/200000; acc: 69.9; ppl:  17.0; xent: 2.8; lr: 0.00041; sents:  141703; bsz: 7287/7884/354; 21585/23352 tok/s;  66087 sec;
[2025-07-19 07:47:20,891 INFO] Step 47400/200000; acc: 69.9; ppl:  17.2; xent: 2.8; lr: 0.00041; sents:  133561; bsz: 7076/7798/334; 21086/23235 tok/s;  66221 sec;
[2025-07-19 07:49:37,415 INFO] Step 47500/200000; acc: 72.1; ppl:  15.3; xent: 2.7; lr: 0.00041; sents:  160624; bsz: 7484/8133/402; 21927/23828 tok/s;  66357 sec;
[2025-07-19 07:51:52,623 INFO] Step 47600/200000; acc: 71.2; ppl:  16.1; xent: 2.8; lr: 0.00041; sents:  137822; bsz: 7223/7883/345; 21368/23322 tok/s;  66493 sec;
[2025-07-19 07:54:09,040 INFO] Step 47700/200000; acc: 71.8; ppl:  15.5; xent: 2.7; lr: 0.00040; sents:  147284; bsz: 7577/8188/368; 22217/24009 tok/s;  66629 sec;
[2025-07-19 07:56:24,938 INFO] Step 47800/200000; acc: 71.8; ppl:  15.4; xent: 2.7; lr: 0.00040; sents:  161891; bsz: 7576/8171/405; 22301/24052 tok/s;  66765 sec;
[2025-07-19 07:58:40,601 INFO] Step 47900/200000; acc: 72.7; ppl:  14.9; xent: 2.7; lr: 0.00040; sents:  149393; bsz: 7420/7869/373; 21878/23203 tok/s;  66901 sec;
[2025-07-19 08:00:55,329 INFO] Step 48000/200000; acc: 70.9; ppl:  16.1; xent: 2.8; lr: 0.00040; sents:  141839; bsz: 7370/7813/355; 21883/23196 tok/s;  67035 sec;
[2025-07-19 08:01:28,305 INFO] valid stats calculation
                           took: 32.97223258018494 s.
[2025-07-19 08:01:39,836 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.530796766281128 s.
[2025-07-19 08:01:39,836 INFO] UPDATING VALIDATION BLEU
[2025-07-19 08:01:40,424 INFO] validation BLEU: 37.189252889260274
[2025-07-19 08:01:40,425 INFO] Train perplexity: 25.9353
[2025-07-19 08:01:40,425 INFO] Train accuracy: 63.9273
[2025-07-19 08:01:40,425 INFO] Sentences processed: 6.53537e+07
[2025-07-19 08:01:40,425 INFO] Average bsz: 7397/7947/340
[2025-07-19 08:01:40,425 INFO] Validation perplexity: 16.8835
[2025-07-19 08:01:40,425 INFO] Validation accuracy: 68.1636
[2025-07-19 08:01:40,426 INFO] Model is improving acc: 68.041 --> 68.1636.
[2025-07-19 08:01:40,435 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_48000.pt
[2025-07-19 08:03:56,533 INFO] Step 48100/200000; acc: 71.0; ppl:  16.2; xent: 2.8; lr: 0.00040; sents:  147060; bsz: 7386/7985/368; 16304/17628 tok/s;  67217 sec;
[2025-07-19 08:06:11,702 INFO] Step 48200/200000; acc: 70.7; ppl:  16.5; xent: 2.8; lr: 0.00040; sents:  144017; bsz: 7466/8045/360; 22107/23821 tok/s;  67352 sec;
[2025-07-19 08:08:27,593 INFO] Step 48300/200000; acc: 69.8; ppl:  16.9; xent: 2.8; lr: 0.00040; sents:  130580; bsz: 7345/7819/326; 21631/23026 tok/s;  67488 sec;
[2025-07-19 08:10:43,672 INFO] Step 48400/200000; acc: 69.1; ppl:  17.6; xent: 2.9; lr: 0.00040; sents:  138418; bsz: 7411/7862/346; 21786/23110 tok/s;  67624 sec;
[2025-07-19 08:12:58,243 INFO] Step 48500/200000; acc: 69.4; ppl:  17.4; xent: 2.9; lr: 0.00040; sents:  138754; bsz: 7428/7902/347; 22080/23490 tok/s;  67758 sec;
[2025-07-19 08:15:10,601 INFO] Step 48600/200000; acc: 69.6; ppl:  17.3; xent: 2.9; lr: 0.00040; sents:  145341; bsz: 6892/7545/363; 20829/22802 tok/s;  67891 sec;
[2025-07-19 08:17:25,836 INFO] Step 48700/200000; acc: 69.4; ppl:  17.0; xent: 2.8; lr: 0.00040; sents:  129863; bsz: 7434/7755/325; 21988/22939 tok/s;  68026 sec;
[2025-07-19 08:19:42,067 INFO] Step 48800/200000; acc: 70.5; ppl:  16.1; xent: 2.8; lr: 0.00040; sents:  131339; bsz: 7665/8077/328; 22527/23739 tok/s;  68162 sec;
[2025-07-19 08:21:56,545 INFO] Step 48900/200000; acc: 69.6; ppl:  16.8; xent: 2.8; lr: 0.00040; sents:  143081; bsz: 7322/7869/358; 21784/23411 tok/s;  68297 sec;
[2025-07-19 08:24:11,697 INFO] Step 49000/200000; acc: 70.7; ppl:  16.2; xent: 2.8; lr: 0.00040; sents:  141637; bsz: 7507/8035/354; 22219/23782 tok/s;  68432 sec;
[2025-07-19 08:24:41,287 INFO] valid stats calculation
                           took: 29.580844163894653 s.
[2025-07-19 08:24:52,326 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.03901481628418 s.
[2025-07-19 08:24:52,326 INFO] UPDATING VALIDATION BLEU
[2025-07-19 08:24:53,116 INFO] validation BLEU: 36.410798273683454
[2025-07-19 08:24:53,116 INFO] Train perplexity: 25.7081
[2025-07-19 08:24:53,117 INFO] Train accuracy: 64.0504
[2025-07-19 08:24:53,117 INFO] Sentences processed: 6.67438e+07
[2025-07-19 08:24:53,117 INFO] Average bsz: 7397/7946/341
[2025-07-19 08:24:53,117 INFO] Validation perplexity: 17.1104
[2025-07-19 08:24:53,117 INFO] Validation accuracy: 67.9743
[2025-07-19 08:24:53,129 INFO] Decreasing patience: 2/3
[2025-07-19 08:27:08,609 INFO] Step 49100/200000; acc: 71.4; ppl:  15.7; xent: 2.8; lr: 0.00040; sents:  144265; bsz: 7466/8043/361; 16882/18186 tok/s;  68609 sec;
[2025-07-19 08:29:25,081 INFO] Step 49200/200000; acc: 70.5; ppl:  16.3; xent: 2.8; lr: 0.00040; sents:  137377; bsz: 7702/8077/343; 22576/23676 tok/s;  68745 sec;
[2025-07-19 08:31:39,444 INFO] Step 49300/200000; acc: 70.8; ppl:  16.4; xent: 2.8; lr: 0.00040; sents:  163849; bsz: 7280/7912/410; 21674/23555 tok/s;  68879 sec;
[2025-07-19 08:33:53,169 INFO] Step 49400/200000; acc: 70.0; ppl:  17.0; xent: 2.8; lr: 0.00040; sents:  159601; bsz: 7114/7856/399; 21280/23502 tok/s;  69013 sec;
[2025-07-19 08:36:08,246 INFO] Step 49500/200000; acc: 70.9; ppl:  16.0; xent: 2.8; lr: 0.00040; sents:  144650; bsz: 7454/7814/362; 22075/23142 tok/s;  69148 sec;
[2025-07-19 08:38:21,658 INFO] Step 49600/200000; acc: 69.7; ppl:  17.1; xent: 2.8; lr: 0.00040; sents:  136887; bsz: 7139/7708/342; 21406/23111 tok/s;  69282 sec;
[2025-07-19 08:40:36,814 INFO] Step 49700/200000; acc: 70.2; ppl:  16.4; xent: 2.8; lr: 0.00040; sents:  147069; bsz: 7430/7877/368; 21992/23315 tok/s;  69417 sec;
[2025-07-19 08:42:53,129 INFO] Step 49800/200000; acc: 70.6; ppl:  16.3; xent: 2.8; lr: 0.00040; sents:  136222; bsz: 7596/8043/341; 22291/23602 tok/s;  69553 sec;
[2025-07-19 08:45:07,550 INFO] Step 49900/200000; acc: 69.9; ppl:  17.1; xent: 2.8; lr: 0.00040; sents:  158020; bsz: 7315/7828/395; 21768/23296 tok/s;  69688 sec;
[2025-07-19 08:47:21,863 INFO] Step 50000/200000; acc: 69.6; ppl:  17.3; xent: 2.9; lr: 0.00040; sents:  150554; bsz: 7058/7618/376; 21020/22688 tok/s;  69822 sec;
[2025-07-19 08:47:53,487 INFO] valid stats calculation
                           took: 31.62075138092041 s.
[2025-07-19 08:48:04,775 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.287978172302246 s.
[2025-07-19 08:48:04,775 INFO] UPDATING VALIDATION BLEU
[2025-07-19 08:48:05,367 INFO] validation BLEU: 36.64634645907267
[2025-07-19 08:48:05,368 INFO] Train perplexity: 25.4843
[2025-07-19 08:48:05,368 INFO] Train accuracy: 64.1756
[2025-07-19 08:48:05,368 INFO] Sentences processed: 6.82223e+07
[2025-07-19 08:48:05,369 INFO] Average bsz: 7396/7945/341
[2025-07-19 08:48:05,369 INFO] Validation perplexity: 17.3153
[2025-07-19 08:48:05,369 INFO] Validation accuracy: 67.6903
[2025-07-19 08:48:05,369 INFO] Decreasing patience: 1/3
[2025-07-19 08:48:05,378 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_50000.pt
[2025-07-19 08:50:19,911 INFO] Step 50100/200000; acc: 69.9; ppl:  17.1; xent: 2.8; lr: 0.00039; sents:  141961; bsz: 7022/7683/355; 15777/17261 tok/s;  70000 sec;
[2025-07-19 08:52:34,392 INFO] Step 50200/200000; acc: 70.2; ppl:  16.7; xent: 2.8; lr: 0.00039; sents:  116730; bsz: 7241/7651/292; 21539/22760 tok/s;  70134 sec;
[2025-07-19 08:54:49,222 INFO] Step 50300/200000; acc: 71.4; ppl:  15.8; xent: 2.8; lr: 0.00039; sents:  142998; bsz: 7352/7892/357; 21812/23413 tok/s;  70269 sec;
[2025-07-19 08:57:04,609 INFO] Step 50400/200000; acc: 71.4; ppl:  15.7; xent: 2.8; lr: 0.00039; sents:  164265; bsz: 7621/8132/411; 22517/24025 tok/s;  70405 sec;
[2025-07-19 08:59:19,737 INFO] Step 50500/200000; acc: 70.8; ppl:  16.3; xent: 2.8; lr: 0.00039; sents:  167430; bsz: 7510/7911/419; 22233/23418 tok/s;  70540 sec;
[2025-07-19 09:01:34,621 INFO] Step 50600/200000; acc: 71.4; ppl:  15.9; xent: 2.8; lr: 0.00039; sents:  161044; bsz: 7335/7806/403; 21753/23150 tok/s;  70675 sec;
[2025-07-19 09:03:50,814 INFO] Step 50700/200000; acc: 71.2; ppl:  16.1; xent: 2.8; lr: 0.00039; sents:  150042; bsz: 7513/8146/375; 22066/23926 tok/s;  70811 sec;
[2025-07-19 09:06:03,687 INFO] Step 50800/200000; acc: 68.9; ppl:  17.8; xent: 2.9; lr: 0.00039; sents:  129813; bsz: 7093/7697/325; 21354/23171 tok/s;  70944 sec;
[2025-07-19 09:08:17,418 INFO] Step 50900/200000; acc: 70.7; ppl:  16.5; xent: 2.8; lr: 0.00039; sents:  151899; bsz: 7162/7658/380; 21423/22906 tok/s;  71077 sec;
[2025-07-19 09:10:31,784 INFO] Step 51000/200000; acc: 71.3; ppl:  15.8; xent: 2.8; lr: 0.00039; sents:  148056; bsz: 7216/7690/370; 21484/22895 tok/s;  71212 sec;
[2025-07-19 09:11:01,398 INFO] valid stats calculation
                           took: 29.612253189086914 s.
[2025-07-19 09:11:12,489 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.090080738067627 s.
[2025-07-19 09:11:12,489 INFO] UPDATING VALIDATION BLEU
[2025-07-19 09:11:13,110 INFO] validation BLEU: 36.480870204289396
[2025-07-19 09:11:13,111 INFO] Train perplexity: 25.2667
[2025-07-19 09:11:13,111 INFO] Train accuracy: 64.3022
[2025-07-19 09:11:13,111 INFO] Sentences processed: 6.96966e+07
[2025-07-19 09:11:13,112 INFO] Average bsz: 7395/7942/342
[2025-07-19 09:11:13,112 INFO] Validation perplexity: 17.1846
[2025-07-19 09:11:13,112 INFO] Validation accuracy: 67.802
[2025-07-19 09:11:13,113 INFO] Decreasing patience: 0/3
[2025-07-19 09:11:13,113 INFO] Training finished after not improving. Early Stop!
[2025-07-19 09:11:13,113 INFO] Best model found at step 48000
[2025-07-19 09:11:13,113 INFO] earlystopper has_stopped!
[2025-07-19 09:11:15,805 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_51000.pt

===== 2025-07-18 13:22:46 =====
Training base WMT model
Return code: 0
--- STDOUT ---

--- STDERR ---
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-18 13:23:11,954 INFO] Missing transforms field for corpus_0 data, set to default: [].
[2025-07-18 13:23:11,954 INFO] Missing transforms field for valid data, set to default: [].
[2025-07-18 13:23:11,955 INFO] Parsed 2 corpora from -data.
[2025-07-18 13:23:11,956 INFO] Get special vocabs from Transforms: {'src': [], 'tgt': []}.
[2025-07-18 13:23:12,118 INFO] The first 10 tokens of the vocabs are:['<unk>', '<blank>', '<s>', '</s>', '"', ',', 'the', '.', 'of', ':']
[2025-07-18 13:23:12,118 INFO] The decoder start token is: <s>
[2025-07-18 13:23:12,118 INFO] Building model...
[2025-07-18 13:23:34,284 INFO] Switching model to float32 for amp/apex_amp
[2025-07-18 13:23:34,284 INFO] Non quantized layer compute is fp32
[2025-07-18 13:23:34,931 INFO] NMTModel(
  (encoder): TransformerEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(57392, 512, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer): ModuleList(
      (0-5): 6 x TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=False)
          (linear_values): Linear(in_features=512, out_features=512, bias=False)
          (linear_query): Linear(in_features=512, out_features=512, bias=False)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=False)
          (w_2): Linear(in_features=2048, out_features=512, bias=False)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
  )
  (decoder): TransformerDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(55744, 512, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
    (transformer_layers): ModuleList(
      (0-5): 6 x TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=False)
          (linear_values): Linear(in_features=512, out_features=512, bias=False)
          (linear_query): Linear(in_features=512, out_features=512, bias=False)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=False)
          (w_2): Linear(in_features=2048, out_features=512, bias=False)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=False)
          (linear_values): Linear(in_features=512, out_features=512, bias=False)
          (linear_query): Linear(in_features=512, out_features=512, bias=False)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=False)
        )
        (layer_norm_2): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
      )
    )
  )
  (generator): Linear(in_features=512, out_features=55744, bias=True)
)
[2025-07-18 13:23:34,933 INFO] encoder: 48272384
[2025-07-18 13:23:34,933 INFO] decoder: 82322880
[2025-07-18 13:23:34,933 INFO] * number of parameters: 130595264
[2025-07-18 13:23:34,934 INFO] Trainable parameters = {'torch.float32': 130595264, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2025-07-18 13:23:34,934 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2025-07-18 13:23:34,934 INFO]  * src vocab size = 57392
[2025-07-18 13:23:34,934 INFO]  * tgt vocab size = 55744
[2025-07-18 13:23:39,947 INFO] Starting training on GPU: [0]
[2025-07-18 13:23:39,947 INFO] Start training loop and validate every 1000 steps...
[2025-07-18 13:23:39,947 INFO] Scoring with: None
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-18 13:23:43,278 INFO] Weighted corpora loaded so far:
			* corpus_0: 1
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-18 13:23:46,252 INFO] Weighted corpora loaded so far:
			* corpus_0: 1
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-18 13:23:49,318 INFO] Weighted corpora loaded so far:
			* corpus_0: 1
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-18 13:23:52,441 INFO] Weighted corpora loaded so far:
			* corpus_0: 1
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-18 13:23:55,382 INFO] Weighted corpora loaded so far:
			* corpus_0: 1
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-18 13:23:58,431 INFO] Weighted corpora loaded so far:
			* corpus_0: 1
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-18 13:24:00,984 INFO] Weighted corpora loaded so far:
			* corpus_0: 1
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-18 13:24:04,137 INFO] Weighted corpora loaded so far:
			* corpus_0: 1
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-18 13:24:07,260 INFO] Weighted corpora loaded so far:
			* corpus_0: 1
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-18 13:24:10,289 INFO] Weighted corpora loaded so far:
			* corpus_0: 1
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/trainer.py:498: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=self.optim.amp):
/home/pourmost/.conda/envs/BPE/lib/python3.10/contextlib.py:103: FutureWarning: `torch.backends.cuda.sdp_kernel()` is deprecated. In the future, this context manager will be removed. Please see `torch.nn.attention.sdpa_kernel()` for the new context manager, with updated signature.
  self.gen = func(*args, **kwds)
[2025-07-18 13:26:54,428 INFO] Step 100/200000; acc: 3.4; ppl: 44700.7; xent: 10.7; lr: 0.00001; sents:  123771; bsz: 7763/8160/309; 15967/16783 tok/s;    194 sec;
[2025-07-18 13:29:08,929 INFO] Step 200/200000; acc: 7.5; ppl: 22461.7; xent: 10.0; lr: 0.00002; sents:  128458; bsz: 7192/7689/321; 21391/22867 tok/s;    329 sec;
[2025-07-18 13:31:24,359 INFO] Step 300/200000; acc: 9.9; ppl: 8707.7; xent: 9.1; lr: 0.00004; sents:  138383; bsz: 7526/8174/346; 22229/24144 tok/s;    464 sec;
[2025-07-18 13:33:39,621 INFO] Step 400/200000; acc: 11.5; ppl: 4007.7; xent: 8.3; lr: 0.00005; sents:  118050; bsz: 7436/7801/295; 21990/23070 tok/s;    600 sec;
[2025-07-18 13:35:57,389 INFO] Step 500/200000; acc: 14.8; ppl: 2344.9; xent: 7.8; lr: 0.00006; sents:  129555; bsz: 7981/8682/324; 23175/25210 tok/s;    737 sec;
[2025-07-18 13:38:15,212 INFO] Step 600/200000; acc: 16.1; ppl: 1715.2; xent: 7.4; lr: 0.00007; sents:  140630; bsz: 7610/7887/352; 22087/22893 tok/s;    875 sec;
[2025-07-18 13:40:32,138 INFO] Step 700/200000; acc: 18.7; ppl: 1227.4; xent: 7.1; lr: 0.00009; sents:  129265; bsz: 7690/8052/323; 22466/23523 tok/s;   1012 sec;
[2025-07-18 13:42:47,913 INFO] Step 800/200000; acc: 20.4; ppl: 927.1; xent: 6.8; lr: 0.00010; sents:  134774; bsz: 7459/8167/337; 21977/24061 tok/s;   1148 sec;
[2025-07-18 13:45:05,272 INFO] Step 900/200000; acc: 20.1; ppl: 839.1; xent: 6.7; lr: 0.00011; sents:  125311; bsz: 7808/8121/313; 22743/23655 tok/s;   1285 sec;
[2025-07-18 13:47:21,431 INFO] Step 1000/200000; acc: 22.0; ppl: 675.6; xent: 6.5; lr: 0.00012; sents:  115794; bsz: 7530/8229/289; 22131/24184 tok/s;   1421 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/trainer.py:397: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=self.optim.amp):
[2025-07-18 13:47:53,002 INFO] valid stats calculation
                           took: 31.562780380249023 s.
[2025-07-18 13:48:04,493 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.490330696105957 s.
[2025-07-18 13:48:04,493 INFO] UPDATING VALIDATION BLEU
[2025-07-18 13:48:05,037 INFO] validation BLEU: 0.5127234978630901
[2025-07-18 13:48:05,038 INFO] Train perplexity: 3095.69
[2025-07-18 13:48:05,038 INFO] Train accuracy: 14.4734
[2025-07-18 13:48:05,038 INFO] Sentences processed: 1.28399e+06
[2025-07-18 13:48:05,038 INFO] Average bsz: 7600/8096/321
[2025-07-18 13:48:05,038 INFO] Validation perplexity: 1035.98
[2025-07-18 13:48:05,039 INFO] Validation accuracy: 18.607
[2025-07-18 13:48:05,045 INFO] Model is improving acc: -inf --> 18.607.
[2025-07-18 13:50:20,263 INFO] Step 1100/200000; acc: 25.9; ppl: 474.8; xent: 6.2; lr: 0.00014; sents:  148422; bsz: 7642/8279/371; 17094/18519 tok/s;   1600 sec;
[2025-07-18 13:52:36,350 INFO] Step 1200/200000; acc: 24.9; ppl: 454.7; xent: 6.1; lr: 0.00015; sents:  129644; bsz: 7684/8424/324; 22587/24762 tok/s;   1736 sec;
[2025-07-18 13:54:53,901 INFO] Step 1300/200000; acc: 28.0; ppl: 361.8; xent: 5.9; lr: 0.00016; sents:  142157; bsz: 7834/8204/355; 22782/23858 tok/s;   1874 sec;
[2025-07-18 13:57:09,725 INFO] Step 1400/200000; acc: 29.3; ppl: 309.1; xent: 5.7; lr: 0.00017; sents:  115966; bsz: 7672/8143/290; 22608/23994 tok/s;   2010 sec;
[2025-07-18 13:59:23,131 INFO] Step 1500/200000; acc: 32.4; ppl: 238.1; xent: 5.5; lr: 0.00019; sents:  194516; bsz: 7124/8015/486; 21361/24032 tok/s;   2143 sec;
[2025-07-18 14:01:40,042 INFO] Step 1600/200000; acc: 34.3; ppl: 213.6; xent: 5.4; lr: 0.00020; sents:  128965; bsz: 7623/8142/322; 22319/23839 tok/s;   2280 sec;
[2025-07-18 14:03:55,682 INFO] Step 1700/200000; acc: 36.8; ppl: 175.0; xent: 5.2; lr: 0.00021; sents:  150721; bsz: 7442/8175/377; 21948/24111 tok/s;   2416 sec;
[2025-07-18 14:06:11,578 INFO] Step 1800/200000; acc: 40.5; ppl: 139.6; xent: 4.9; lr: 0.00022; sents:  137336; bsz: 7630/7980/343; 22459/23489 tok/s;   2552 sec;
[2025-07-18 14:08:25,878 INFO] Step 1900/200000; acc: 38.9; ppl: 185.7; xent: 5.2; lr: 0.00023; sents:  151150; bsz: 7128/7710/378; 21235/22967 tok/s;   2686 sec;
[2025-07-18 14:10:41,752 INFO] Step 2000/200000; acc: 43.6; ppl: 131.3; xent: 4.9; lr: 0.00025; sents:  147982; bsz: 7532/8167/370; 22176/24045 tok/s;   2822 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-18 14:11:12,655 INFO] valid stats calculation
                           took: 30.895615816116333 s.
[2025-07-18 14:11:24,648 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.993218421936035 s.
[2025-07-18 14:11:24,649 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-18 14:11:25,197 INFO] validation BLEU: 8.994554975956044
[2025-07-18 14:11:25,198 INFO] Train perplexity: 868.781
[2025-07-18 14:11:25,198 INFO] Train accuracy: 23.9429
[2025-07-18 14:11:25,198 INFO] Sentences processed: 2.73085e+06
[2025-07-18 14:11:25,198 INFO] Average bsz: 7565/8110/341
[2025-07-18 14:11:25,199 INFO] Validation perplexity: 201.528
[2025-07-18 14:11:25,199 INFO] Validation accuracy: 35.86
[2025-07-18 14:11:25,205 INFO] Model is improving acc: 18.607 --> 35.86.
[2025-07-18 14:11:25,213 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_2000.pt
[2025-07-18 14:13:43,074 INFO] Step 2100/200000; acc: 45.3; ppl: 114.8; xent: 4.7; lr: 0.00026; sents:  133038; bsz: 7211/7875/333; 15908/17373 tok/s;   3003 sec;
[2025-07-18 14:15:58,540 INFO] Step 2200/200000; acc: 46.8; ppl: 100.9; xent: 4.6; lr: 0.00027; sents:  151831; bsz: 7369/7956/380; 21817/23554 tok/s;   3139 sec;
[2025-07-18 14:18:14,733 INFO] Step 2300/200000; acc: 50.0; ppl:  79.1; xent: 4.4; lr: 0.00028; sents:  167518; bsz: 7475/7966/419; 21957/23396 tok/s;   3275 sec;
[2025-07-18 14:20:30,427 INFO] Step 2400/200000; acc: 52.1; ppl:  70.2; xent: 4.3; lr: 0.00030; sents:  148840; bsz: 7464/8023/372; 22029/23677 tok/s;   3410 sec;
[2025-07-18 14:22:49,235 INFO] Step 2500/200000; acc: 52.6; ppl:  67.4; xent: 4.2; lr: 0.00031; sents:  135305; bsz: 7583/8025/338; 21854/23128 tok/s;   3549 sec;
[2025-07-18 14:25:03,892 INFO] Step 2600/200000; acc: 50.2; ppl:  77.3; xent: 4.3; lr: 0.00032; sents:  130939; bsz: 7089/7710/327; 21059/22905 tok/s;   3684 sec;
[2025-07-18 14:27:20,495 INFO] Step 2700/200000; acc: 51.9; ppl:  68.0; xent: 4.2; lr: 0.00033; sents:  127559; bsz: 7410/7994/319; 21698/23409 tok/s;   3821 sec;
[2025-07-18 14:29:35,348 INFO] Step 2800/200000; acc: 52.3; ppl:  64.8; xent: 4.2; lr: 0.00035; sents:  120754; bsz: 6887/7539/302; 20431/22364 tok/s;   3955 sec;
[2025-07-18 14:31:49,390 INFO] Step 2900/200000; acc: 53.3; ppl:  59.7; xent: 4.1; lr: 0.00036; sents:  130777; bsz: 7123/7762/327; 21265/23172 tok/s;   4089 sec;
[2025-07-18 14:34:05,153 INFO] Step 3000/200000; acc: 54.3; ppl:  56.5; xent: 4.0; lr: 0.00037; sents:  119080; bsz: 7555/7977/298; 22271/23513 tok/s;   4225 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-18 14:34:34,455 INFO] valid stats calculation
                           took: 29.208280086517334 s.
[2025-07-18 14:34:46,143 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.687943935394287 s.
[2025-07-18 14:34:46,143 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-18 14:34:46,693 INFO] validation BLEU: 20.555256408144302
[2025-07-18 14:34:46,694 INFO] Train perplexity: 388.393
[2025-07-18 14:34:46,694 INFO] Train accuracy: 32.7455
[2025-07-18 14:34:46,694 INFO] Sentences processed: 4.09649e+06
[2025-07-18 14:34:46,694 INFO] Average bsz: 7482/8034/341
[2025-07-18 14:34:46,695 INFO] Validation perplexity: 77.0543
[2025-07-18 14:34:46,695 INFO] Validation accuracy: 47.4246
[2025-07-18 14:34:46,702 INFO] Model is improving acc: 35.86 --> 47.4246.
[2025-07-18 14:37:03,184 INFO] Step 3100/200000; acc: 55.9; ppl:  50.5; xent: 3.9; lr: 0.00038; sents:  119183; bsz: 7640/7971/298; 17174/17919 tok/s;   4403 sec;
[2025-07-18 14:39:18,848 INFO] Step 3200/200000; acc: 56.6; ppl:  46.9; xent: 3.8; lr: 0.00040; sents:  167094; bsz: 7339/7876/418; 21669/23255 tok/s;   4539 sec;
[2025-07-18 14:41:35,836 INFO] Step 3300/200000; acc: 57.6; ppl:  44.4; xent: 3.8; lr: 0.00041; sents:  122365; bsz: 7547/7913/306; 22038/23107 tok/s;   4676 sec;
[2025-07-18 14:43:51,036 INFO] Step 3400/200000; acc: 55.3; ppl:  50.0; xent: 3.9; lr: 0.00042; sents:  115440; bsz: 7373/7804/289; 21815/23091 tok/s;   4811 sec;
[2025-07-18 14:46:04,695 INFO] Step 3500/200000; acc: 56.5; ppl:  47.0; xent: 3.9; lr: 0.00043; sents:  139317; bsz: 7153/7970/348; 21407/23852 tok/s;   4945 sec;
[2025-07-18 14:48:17,891 INFO] Step 3600/200000; acc: 55.9; ppl:  48.9; xent: 3.9; lr: 0.00044; sents:  131034; bsz: 6992/7680/328; 20998/23064 tok/s;   5078 sec;
[2025-07-18 14:50:32,965 INFO] Step 3700/200000; acc: 56.3; ppl:  46.6; xent: 3.8; lr: 0.00046; sents:  111590; bsz: 7366/7910/279; 21813/23425 tok/s;   5213 sec;
[2025-07-18 14:52:48,960 INFO] Step 3800/200000; acc: 55.9; ppl:  46.2; xent: 3.8; lr: 0.00047; sents:  146714; bsz: 7657/8220/367; 22523/24178 tok/s;   5349 sec;
[2025-07-18 14:55:05,477 INFO] Step 3900/200000; acc: 58.8; ppl:  39.5; xent: 3.7; lr: 0.00048; sents:  151231; bsz: 7423/8035/378; 21749/23543 tok/s;   5486 sec;
[2025-07-18 14:57:20,174 INFO] Step 4000/200000; acc: 58.1; ppl:  39.8; xent: 3.7; lr: 0.00049; sents:  125490; bsz: 7505/7949/314; 22289/23607 tok/s;   5620 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-18 14:58:46,199 INFO] valid stats calculation
                           took: 85.70795702934265 s.
[2025-07-18 14:58:58,310 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.870266199111938 s.
[2025-07-18 14:58:58,310 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-18 14:58:58,868 INFO] validation BLEU: 24.313759773924225
[2025-07-18 14:58:58,869 INFO] Train perplexity: 228.775
[2025-07-18 14:58:58,869 INFO] Train accuracy: 38.6748
[2025-07-18 14:58:58,869 INFO] Sentences processed: 5.42595e+06
[2025-07-18 14:58:58,869 INFO] Average bsz: 7462/8009/339
[2025-07-18 14:58:58,869 INFO] Validation perplexity: 52.3321
[2025-07-18 14:58:58,869 INFO] Validation accuracy: 52.0864
[2025-07-18 14:58:58,877 INFO] Model is improving acc: 47.4246 --> 52.0864.
[2025-07-18 14:58:58,885 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_4000.pt
[2025-07-18 15:01:15,482 INFO] Step 4100/200000; acc: 58.2; ppl:  38.4; xent: 3.6; lr: 0.00051; sents:  135588; bsz: 7297/7733/339; 12420/13164 tok/s;   5856 sec;
[2025-07-18 15:03:30,783 INFO] Step 4200/200000; acc: 58.5; ppl:  38.1; xent: 3.6; lr: 0.00052; sents:  111844; bsz: 7344/7807/280; 21713/23084 tok/s;   5991 sec;
[2025-07-18 15:05:44,967 INFO] Step 4300/200000; acc: 60.4; ppl:  35.4; xent: 3.6; lr: 0.00053; sents:  157456; bsz: 7210/7615/394; 21493/22701 tok/s;   6125 sec;
[2025-07-18 15:08:00,683 INFO] Step 4400/200000; acc: 59.7; ppl:  35.5; xent: 3.6; lr: 0.00054; sents:  123575; bsz: 7349/7983/309; 21668/23539 tok/s;   6261 sec;
[2025-07-18 15:10:14,495 INFO] Step 4500/200000; acc: 60.8; ppl:  33.9; xent: 3.5; lr: 0.00056; sents:  162093; bsz: 7379/7856/405; 22058/23485 tok/s;   6395 sec;
[2025-07-18 15:12:28,771 INFO] Step 4600/200000; acc: 60.9; ppl:  33.3; xent: 3.5; lr: 0.00057; sents:  140881; bsz: 7301/7712/352; 21752/22976 tok/s;   6529 sec;
[2025-07-18 15:14:41,920 INFO] Step 4700/200000; acc: 59.2; ppl:  36.7; xent: 3.6; lr: 0.00058; sents:  139416; bsz: 7152/7627/349; 21486/22915 tok/s;   6662 sec;
[2025-07-18 15:16:54,899 INFO] Step 4800/200000; acc: 60.5; ppl:  34.0; xent: 3.5; lr: 0.00059; sents:  151136; bsz: 7109/7670/378; 21385/23072 tok/s;   6795 sec;
[2025-07-18 15:19:09,674 INFO] Step 4900/200000; acc: 61.1; ppl:  32.0; xent: 3.5; lr: 0.00061; sents:  148919; bsz: 7493/7866/372; 22270/23378 tok/s;   6930 sec;
[2025-07-18 15:21:25,817 INFO] Step 5000/200000; acc: 62.0; ppl:  30.1; xent: 3.4; lr: 0.00062; sents:  138943; bsz: 7544/8004/347; 22205/23561 tok/s;   7066 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-18 15:21:58,540 INFO] valid stats calculation
                           took: 32.711939334869385 s.
[2025-07-18 15:22:09,665 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.124170780181885 s.
[2025-07-18 15:22:09,665 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-18 15:22:10,382 INFO] validation BLEU: 26.17271901770003
[2025-07-18 15:22:10,383 INFO] Train perplexity: 158.136
[2025-07-18 15:22:10,383 INFO] Train accuracy: 42.8679
[2025-07-18 15:22:10,383 INFO] Sentences processed: 6.8358e+06
[2025-07-18 15:22:10,383 INFO] Average bsz: 7433/7965/342
[2025-07-18 15:22:10,383 INFO] Validation perplexity: 42.4734
[2025-07-18 15:22:10,384 INFO] Validation accuracy: 54.6563
[2025-07-18 15:22:10,391 INFO] Model is improving acc: 52.0864 --> 54.6563.
[2025-07-18 15:24:25,502 INFO] Step 5100/200000; acc: 62.2; ppl:  30.3; xent: 3.4; lr: 0.00063; sents:  147740; bsz: 7434/7892/369; 16551/17569 tok/s;   7246 sec;
[2025-07-18 15:26:40,441 INFO] Step 5200/200000; acc: 62.0; ppl:  29.9; xent: 3.4; lr: 0.00064; sents:  143907; bsz: 7300/7914/360; 21676/23498 tok/s;   7380 sec;
[2025-07-18 15:28:55,816 INFO] Step 5300/200000; acc: 63.7; ppl:  27.2; xent: 3.3; lr: 0.00065; sents:  171881; bsz: 7344/8014/430; 21702/23682 tok/s;   7516 sec;
[2025-07-18 15:31:11,173 INFO] Step 5400/200000; acc: 64.1; ppl:  26.9; xent: 3.3; lr: 0.00067; sents:  177623; bsz: 7410/7962/444; 21898/23531 tok/s;   7651 sec;
[2025-07-18 15:33:05,833 INFO] Step 5484, cuda OOM - batch removed
[2025-07-18 15:33:28,154 INFO] Step 5500/200000; acc: 58.3; ppl:  39.5; xent: 3.7; lr: 0.00068; sents:  164618; bsz: 7508/7958/413; 21869/23182 tok/s;   7788 sec;
[2025-07-18 15:35:43,006 INFO] Step 5600/200000; acc: 54.7; ppl:  49.1; xent: 3.9; lr: 0.00069; sents:  143188; bsz: 7298/7935/358; 21649/23538 tok/s;   7923 sec;
[2025-07-18 15:37:58,390 INFO] Step 5700/200000; acc: 59.7; ppl:  36.7; xent: 3.6; lr: 0.00070; sents:  163413; bsz: 7578/8043/409; 22391/23765 tok/s;   8058 sec;
[2025-07-18 15:40:12,501 INFO] Step 5800/200000; acc: 58.1; ppl:  39.8; xent: 3.7; lr: 0.00072; sents:  145810; bsz: 7409/7641/365; 22112/22804 tok/s;   8193 sec;
[2025-07-18 15:42:26,231 INFO] Step 5900/200000; acc: 58.5; ppl:  38.1; xent: 3.6; lr: 0.00073; sents:  130335; bsz: 7300/7817/326; 21853/23399 tok/s;   8326 sec;
[2025-07-18 15:44:40,831 INFO] Step 6000/200000; acc: 60.3; ppl:  34.2; xent: 3.5; lr: 0.00074; sents:  153551; bsz: 7358/8069/384; 21891/24007 tok/s;   8461 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-18 15:45:13,264 INFO] valid stats calculation
                           took: 32.33885979652405 s.
[2025-07-18 15:45:24,498 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.233017921447754 s.
[2025-07-18 15:45:24,498 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-18 15:45:25,227 INFO] validation BLEU: 26.19917989633938
[2025-07-18 15:45:25,228 INFO] Train perplexity: 122.856
[2025-07-18 15:45:25,228 INFO] Train accuracy: 45.7374
[2025-07-18 15:45:25,228 INFO] Sentences processed: 8.37787e+06
[2025-07-18 15:45:25,228 INFO] Average bsz: 7426/7958/349
[2025-07-18 15:45:25,228 INFO] Validation perplexity: 39.6851
[2025-07-18 15:45:25,229 INFO] Validation accuracy: 55.4972
[2025-07-18 15:45:25,236 INFO] Model is improving acc: 54.6563 --> 55.4972.
[2025-07-18 15:45:25,244 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_6000.pt
[2025-07-18 15:47:41,146 INFO] Step 6100/200000; acc: 58.7; ppl:  37.1; xent: 3.6; lr: 0.00075; sents:  126386; bsz: 7358/7749/316; 16331/17198 tok/s;   8641 sec;
[2025-07-18 15:49:56,819 INFO] Step 6200/200000; acc: 62.3; ppl:  29.9; xent: 3.4; lr: 0.00077; sents:  155301; bsz: 7638/8215/388; 22520/24222 tok/s;   8777 sec;
[2025-07-18 15:52:11,801 INFO] Step 6300/200000; acc: 60.3; ppl:  33.6; xent: 3.5; lr: 0.00078; sents:  142016; bsz: 7536/8088/355; 22334/23970 tok/s;   8912 sec;
[2025-07-18 15:54:26,383 INFO] Step 6400/200000; acc: 61.1; ppl:  32.1; xent: 3.5; lr: 0.00079; sents:  142282; bsz: 7145/7976/356; 21238/23707 tok/s;   9046 sec;
[2025-07-18 15:56:41,499 INFO] Step 6500/200000; acc: 62.3; ppl:  29.5; xent: 3.4; lr: 0.00080; sents:  137733; bsz: 7444/8011/344; 22040/23718 tok/s;   9182 sec;
[2025-07-18 15:58:53,770 INFO] Step 6600/200000; acc: 59.9; ppl:  34.1; xent: 3.5; lr: 0.00082; sents:  135507; bsz: 7030/7700/339; 21262/23288 tok/s;   9314 sec;
[2025-07-18 16:01:07,438 INFO] Step 6700/200000; acc: 60.4; ppl:  33.1; xent: 3.5; lr: 0.00083; sents:  138487; bsz: 7386/7819/346; 22114/23409 tok/s;   9447 sec;
[2025-07-18 16:03:02,907 INFO] Weighted corpora loaded so far:
			* corpus_0: 2
[2025-07-18 16:03:21,621 INFO] Step 6800/200000; acc: 58.5; ppl:  36.2; xent: 3.6; lr: 0.00084; sents:  106013; bsz: 7369/7769/265; 21969/23161 tok/s;   9582 sec;
[2025-07-18 16:03:32,757 INFO] Weighted corpora loaded so far:
			* corpus_0: 2
[2025-07-18 16:03:38,567 INFO] Weighted corpora loaded so far:
			* corpus_0: 2
[2025-07-18 16:03:42,010 INFO] Weighted corpora loaded so far:
			* corpus_0: 2
[2025-07-18 16:03:45,422 INFO] Weighted corpora loaded so far:
			* corpus_0: 2
[2025-07-18 16:03:47,509 INFO] Weighted corpora loaded so far:
			* corpus_0: 2
[2025-07-18 16:04:04,889 INFO] Weighted corpora loaded so far:
			* corpus_0: 2
[2025-07-18 16:04:07,358 INFO] Weighted corpora loaded so far:
			* corpus_0: 2
[2025-07-18 16:04:19,237 INFO] Weighted corpora loaded so far:
			* corpus_0: 2
[2025-07-18 16:04:21,532 INFO] Weighted corpora loaded so far:
			* corpus_0: 2
[2025-07-18 16:05:34,651 INFO] Step 6900/200000; acc: 59.5; ppl:  34.0; xent: 3.5; lr: 0.00085; sents:  118659; bsz: 6994/7506/297; 21030/22571 tok/s;   9715 sec;
[2025-07-18 16:07:47,796 INFO] Step 7000/200000; acc: 60.4; ppl:  32.4; xent: 3.5; lr: 0.00086; sents:  131922; bsz: 7260/7782/330; 21812/23381 tok/s;   9848 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-18 16:08:20,963 INFO] valid stats calculation
                           took: 33.15816307067871 s.
[2025-07-18 16:08:31,671 INFO] The translation of the valid dataset for dynamic scoring
                               took : 10.707741260528564 s.
[2025-07-18 16:08:31,671 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-18 16:08:32,231 INFO] validation BLEU: 27.641408965446686
[2025-07-18 16:08:32,232 INFO] Train perplexity: 102.051
[2025-07-18 16:08:32,232 INFO] Train accuracy: 47.8052
[2025-07-18 16:08:32,233 INFO] Sentences processed: 9.71217e+06
[2025-07-18 16:08:32,233 INFO] Average bsz: 7411/7944/347
[2025-07-18 16:08:32,233 INFO] Validation perplexity: 34.8405
[2025-07-18 16:08:32,233 INFO] Validation accuracy: 57.1862
[2025-07-18 16:08:32,240 INFO] Model is improving acc: 55.4972 --> 57.1862.
[2025-07-18 16:10:46,297 INFO] Step 7100/200000; acc: 60.6; ppl:  31.9; xent: 3.5; lr: 0.00088; sents:  127565; bsz: 7376/7759/319; 16529/17388 tok/s;  10026 sec;
[2025-07-18 16:12:59,650 INFO] Step 7200/200000; acc: 60.6; ppl:  31.6; xent: 3.5; lr: 0.00089; sents:  133947; bsz: 7168/7811/335; 21501/23431 tok/s;  10160 sec;
[2025-07-18 16:15:13,312 INFO] Step 7300/200000; acc: 59.1; ppl:  34.6; xent: 3.5; lr: 0.00090; sents:  119342; bsz: 7172/7776/298; 21503/23312 tok/s;  10293 sec;
[2025-07-18 16:17:26,511 INFO] Step 7400/200000; acc: 55.4; ppl:  42.5; xent: 3.7; lr: 0.00091; sents:  115732; bsz: 7186/7680/289; 21582/23064 tok/s;  10427 sec;
[2025-07-18 16:19:40,964 INFO] Step 7500/200000; acc: 56.6; ppl:  40.4; xent: 3.7; lr: 0.00093; sents:  148579; bsz: 7526/8320/371; 22390/24753 tok/s;  10561 sec;
[2025-07-18 16:21:55,500 INFO] Step 7600/200000; acc: 58.2; ppl:  36.3; xent: 3.6; lr: 0.00094; sents:  123841; bsz: 7370/8063/310; 21915/23975 tok/s;  10696 sec;
[2025-07-18 16:24:08,242 INFO] Step 7700/200000; acc: 54.2; ppl:  44.8; xent: 3.8; lr: 0.00095; sents:  103036; bsz: 7270/7686/258; 21909/23163 tok/s;  10828 sec;
[2025-07-18 16:26:22,288 INFO] Step 7800/200000; acc: 58.8; ppl:  34.3; xent: 3.5; lr: 0.00096; sents:  133263; bsz: 7387/8030/333; 22056/23976 tok/s;  10962 sec;
[2025-07-18 16:28:35,460 INFO] Step 7900/200000; acc: 56.5; ppl:  39.1; xent: 3.7; lr: 0.00098; sents:  125046; bsz: 7234/7608/313; 21730/22853 tok/s;  11096 sec;
[2025-07-18 16:30:49,278 INFO] Step 8000/200000; acc: 58.3; ppl:  35.1; xent: 3.6; lr: 0.00099; sents:  155757; bsz: 7420/8290/389; 22181/24781 tok/s;  11229 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-18 16:31:16,835 INFO] valid stats calculation
                           took: 27.548574924468994 s.
[2025-07-18 16:31:28,199 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.363188982009888 s.
[2025-07-18 16:31:28,199 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-18 16:31:28,759 INFO] validation BLEU: 28.836116761168544
[2025-07-18 16:31:28,760 INFO] Train perplexity: 89.8869
[2025-07-18 16:31:28,760 INFO] Train accuracy: 49.0553
[2025-07-18 16:31:28,760 INFO] Sentences processed: 1.09983e+07
[2025-07-18 16:31:28,760 INFO] Average bsz: 7398/7939/344
[2025-07-18 16:31:28,760 INFO] Validation perplexity: 30.8825
[2025-07-18 16:31:28,761 INFO] Validation accuracy: 58.8825
[2025-07-18 16:31:28,767 INFO] Model is improving acc: 57.1862 --> 58.8825.
[2025-07-18 16:31:28,776 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_8000.pt
[2025-07-18 16:33:44,286 INFO] Step 8100/200000; acc: 57.9; ppl:  35.7; xent: 3.6; lr: 0.00098; sents:  129995; bsz: 7527/7866/325; 17205/17980 tok/s;  11404 sec;
[2025-07-18 16:35:59,739 INFO] Step 8200/200000; acc: 57.4; ppl:  36.3; xent: 3.6; lr: 0.00098; sents:  131150; bsz: 7657/8231/328; 22612/24308 tok/s;  11540 sec;
[2025-07-18 16:38:16,451 INFO] Step 8300/200000; acc: 59.7; ppl:  31.5; xent: 3.5; lr: 0.00097; sents:  123557; bsz: 7968/8391/309; 23314/24551 tok/s;  11677 sec;
[2025-07-18 16:40:31,104 INFO] Step 8400/200000; acc: 58.0; ppl:  35.0; xent: 3.6; lr: 0.00096; sents:  124733; bsz: 7343/8043/312; 21816/23895 tok/s;  11811 sec;
[2025-07-18 16:42:44,405 INFO] Step 8500/200000; acc: 57.9; ppl:  35.0; xent: 3.6; lr: 0.00096; sents:  134374; bsz: 7293/8093/336; 21886/24286 tok/s;  11944 sec;
[2025-07-18 16:44:58,915 INFO] Step 8600/200000; acc: 57.1; ppl:  36.4; xent: 3.6; lr: 0.00095; sents:  110472; bsz: 7688/8224/276; 22863/24457 tok/s;  12079 sec;
[2025-07-18 16:47:12,501 INFO] Step 8700/200000; acc: 57.9; ppl:  35.3; xent: 3.6; lr: 0.00095; sents:  123640; bsz: 7291/7833/309; 21847/23470 tok/s;  12213 sec;
[2025-07-18 16:49:26,649 INFO] Step 8800/200000; acc: 59.1; ppl:  32.8; xent: 3.5; lr: 0.00094; sents:  122634; bsz: 7406/8256/307; 22088/24621 tok/s;  12347 sec;
[2025-07-18 16:51:40,120 INFO] Step 8900/200000; acc: 58.1; ppl:  35.1; xent: 3.6; lr: 0.00094; sents:  123964; bsz: 7165/7899/310; 21475/23674 tok/s;  12480 sec;
[2025-07-18 16:53:54,297 INFO] Step 9000/200000; acc: 58.1; ppl:  34.8; xent: 3.5; lr: 0.00093; sents:  115157; bsz: 7445/7941/288; 22196/23675 tok/s;  12614 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-18 16:54:27,833 INFO] valid stats calculation
                           took: 33.45172452926636 s.
[2025-07-18 16:54:39,751 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.917053937911987 s.
[2025-07-18 16:54:39,751 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-18 16:54:40,316 INFO] validation BLEU: 29.573844570911152
[2025-07-18 16:54:40,317 INFO] Train perplexity: 80.7441
[2025-07-18 16:54:40,317 INFO] Train accuracy: 50.078
[2025-07-18 16:54:40,317 INFO] Sentences processed: 1.2238e+07
[2025-07-18 16:54:40,317 INFO] Average bsz: 7407/7954/340
[2025-07-18 16:54:40,317 INFO] Validation perplexity: 27.9003
[2025-07-18 16:54:40,317 INFO] Validation accuracy: 60.2111
[2025-07-18 16:54:40,328 INFO] Model is improving acc: 58.8825 --> 60.2111.
[2025-07-18 16:56:54,545 INFO] Step 9100/200000; acc: 59.6; ppl:  31.9; xent: 3.5; lr: 0.00093; sents:  141963; bsz: 7721/8162/355; 17141/18121 tok/s;  12795 sec;
[2025-07-18 16:59:08,582 INFO] Step 9200/200000; acc: 58.4; ppl:  34.2; xent: 3.5; lr: 0.00092; sents:  118512; bsz: 7452/7891/296; 22238/23550 tok/s;  12929 sec;
[2025-07-18 17:01:22,894 INFO] Step 9300/200000; acc: 59.5; ppl:  32.1; xent: 3.5; lr: 0.00092; sents:  129668; bsz: 7400/8156/324; 22041/24290 tok/s;  13063 sec;
[2025-07-18 17:03:38,671 INFO] Step 9400/200000; acc: 63.4; ppl:  26.0; xent: 3.3; lr: 0.00091; sents:  174243; bsz: 7633/8218/436; 22512/24238 tok/s;  13199 sec;
[2025-07-18 17:05:53,075 INFO] Step 9500/200000; acc: 62.8; ppl:  25.9; xent: 3.3; lr: 0.00091; sents:  142374; bsz: 7266/8146/356; 21648/24269 tok/s;  13333 sec;
[2025-07-18 17:08:10,869 INFO] Step 9600/200000; acc: 66.4; ppl:  21.7; xent: 3.1; lr: 0.00090; sents:  147096; bsz: 7738/8199/368; 22464/23802 tok/s;  13471 sec;
[2025-07-18 17:10:26,180 INFO] Step 9700/200000; acc: 62.9; ppl:  25.4; xent: 3.2; lr: 0.00090; sents:  106523; bsz: 7584/7918/266; 22423/23410 tok/s;  13606 sec;
[2025-07-18 17:12:41,722 INFO] Step 9800/200000; acc: 62.9; ppl:  25.5; xent: 3.2; lr: 0.00089; sents:  138933; bsz: 7391/8016/347; 21812/23658 tok/s;  13742 sec;
[2025-07-18 17:14:56,264 INFO] Step 9900/200000; acc: 63.6; ppl:  24.6; xent: 3.2; lr: 0.00089; sents:  114277; bsz: 7298/7771/286; 21700/23106 tok/s;  13876 sec;
[2025-07-18 17:17:10,784 INFO] Step 10000/200000; acc: 66.2; ppl:  21.7; xent: 3.1; lr: 0.00088; sents:  134863; bsz: 7304/7737/337; 21720/23006 tok/s;  14011 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-18 17:17:38,739 INFO] valid stats calculation
                           took: 27.945773363113403 s.
[2025-07-18 17:17:50,182 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.44273042678833 s.
[2025-07-18 17:17:50,182 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-18 17:17:50,749 INFO] validation BLEU: 30.751249606864913
[2025-07-18 17:17:50,750 INFO] Train perplexity: 72.2025
[2025-07-18 17:17:50,750 INFO] Train accuracy: 51.3356
[2025-07-18 17:17:50,750 INFO] Sentences processed: 1.35864e+07
[2025-07-18 17:17:50,750 INFO] Average bsz: 7414/7961/340
[2025-07-18 17:17:50,751 INFO] Validation perplexity: 25.703
[2025-07-18 17:17:50,751 INFO] Validation accuracy: 61.4342
[2025-07-18 17:17:50,796 INFO] Model is improving acc: 60.2111 --> 61.4342.
[2025-07-18 17:17:50,811 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_10000.pt
[2025-07-18 17:20:06,787 INFO] Step 10100/200000; acc: 65.6; ppl:  22.5; xent: 3.1; lr: 0.00088; sents:  144029; bsz: 7529/7875/360; 17112/17899 tok/s;  14187 sec;
[2025-07-18 17:22:22,527 INFO] Step 10200/200000; acc: 64.5; ppl:  23.3; xent: 3.1; lr: 0.00088; sents:  127365; bsz: 7623/8157/318; 22464/24040 tok/s;  14323 sec;
[2025-07-18 17:24:36,273 INFO] Step 10300/200000; acc: 65.0; ppl:  22.8; xent: 3.1; lr: 0.00087; sents:  168731; bsz: 7234/7783/422; 21635/23279 tok/s;  14456 sec;
[2025-07-18 17:26:49,963 INFO] Step 10400/200000; acc: 64.0; ppl:  24.1; xent: 3.2; lr: 0.00087; sents:  129800; bsz: 7119/7881/324; 21302/23582 tok/s;  14590 sec;
[2025-07-18 17:29:03,590 INFO] Step 10500/200000; acc: 66.4; ppl:  21.2; xent: 3.1; lr: 0.00086; sents:  168650; bsz: 7141/7845/422; 21382/23492 tok/s;  14724 sec;
[2025-07-18 17:31:20,005 INFO] Step 10600/200000; acc: 66.6; ppl:  20.6; xent: 3.0; lr: 0.00086; sents:  131328; bsz: 7736/8280/328; 22686/24281 tok/s;  14860 sec;
[2025-07-18 17:33:36,148 INFO] Step 10700/200000; acc: 64.7; ppl:  22.3; xent: 3.1; lr: 0.00085; sents:  134459; bsz: 7777/8205/336; 22851/24109 tok/s;  14996 sec;
[2025-07-18 17:35:51,501 INFO] Step 10800/200000; acc: 66.7; ppl:  20.5; xent: 3.0; lr: 0.00085; sents:  134117; bsz: 7652/8207/335; 22613/24255 tok/s;  15132 sec;
[2025-07-18 17:38:07,349 INFO] Step 10900/200000; acc: 67.0; ppl:  20.2; xent: 3.0; lr: 0.00085; sents:  143992; bsz: 7700/8389/360; 22673/24704 tok/s;  15267 sec;
[2025-07-18 17:40:21,637 INFO] Step 11000/200000; acc: 65.7; ppl:  21.5; xent: 3.1; lr: 0.00084; sents:  127797; bsz: 7373/7881/319; 21962/23477 tok/s;  15402 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-18 17:40:51,312 INFO] valid stats calculation
                           took: 29.666869401931763 s.
[2025-07-18 17:41:02,357 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.04375147819519 s.
[2025-07-18 17:41:02,357 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-18 17:41:02,925 INFO] validation BLEU: 31.849532545096345
[2025-07-18 17:41:02,926 INFO] Train perplexity: 64.6941
[2025-07-18 17:41:02,926 INFO] Train accuracy: 52.648
[2025-07-18 17:41:02,926 INFO] Sentences processed: 1.49967e+07
[2025-07-18 17:41:02,926 INFO] Average bsz: 7421/7969/341
[2025-07-18 17:41:02,926 INFO] Validation perplexity: 24.1727
[2025-07-18 17:41:02,927 INFO] Validation accuracy: 62.525
[2025-07-18 17:41:02,932 INFO] Model is improving acc: 61.4342 --> 62.525.
[2025-07-18 17:43:16,812 INFO] Step 11100/200000; acc: 62.6; ppl:  26.8; xent: 3.3; lr: 0.00084; sents:  138518; bsz: 7232/7785/346; 16514/17777 tok/s;  15577 sec;
[2025-07-18 17:45:31,542 INFO] Step 11200/200000; acc: 63.3; ppl:  26.8; xent: 3.3; lr: 0.00084; sents:  142315; bsz: 7220/7921/356; 21444/23528 tok/s;  15712 sec;
[2025-07-18 17:47:46,460 INFO] Step 11300/200000; acc: 62.2; ppl:  28.7; xent: 3.4; lr: 0.00083; sents:  149751; bsz: 7274/8041/374; 21600/23876 tok/s;  15847 sec;
[2025-07-18 17:50:03,524 INFO] Step 11400/200000; acc: 64.1; ppl:  25.2; xent: 3.2; lr: 0.00083; sents:  104649; bsz: 7668/7975/262; 22381/23279 tok/s;  15984 sec;
[2025-07-18 17:52:19,777 INFO] Step 11500/200000; acc: 65.3; ppl:  23.8; xent: 3.2; lr: 0.00082; sents:  146504; bsz: 7358/7843/366; 21603/23026 tok/s;  16120 sec;
[2025-07-18 17:54:34,445 INFO] Step 11600/200000; acc: 64.6; ppl:  24.5; xent: 3.2; lr: 0.00082; sents:  149270; bsz: 7240/7589/373; 21507/22543 tok/s;  16254 sec;
[2025-07-18 17:56:50,275 INFO] Step 11700/200000; acc: 67.2; ppl:  21.4; xent: 3.1; lr: 0.00082; sents:  149060; bsz: 7310/7935/373; 21569/23412 tok/s;  16390 sec;
[2025-07-18 17:59:06,818 INFO] Step 11800/200000; acc: 65.6; ppl:  23.0; xent: 3.1; lr: 0.00081; sents:  133389; bsz: 7551/8008/333; 22123/23459 tok/s;  16527 sec;
[2025-07-18 18:01:19,353 INFO] Step 11900/200000; acc: 64.2; ppl:  25.2; xent: 3.2; lr: 0.00081; sents:  131249; bsz: 6707/7517/328; 20262/22710 tok/s;  16659 sec;
[2025-07-18 18:03:34,129 INFO] Step 12000/200000; acc: 65.2; ppl:  23.3; xent: 3.1; lr: 0.00081; sents:  128548; bsz: 7445/7931/321; 22106/23551 tok/s;  16794 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-18 18:04:07,861 INFO] valid stats calculation
                           took: 33.660176515579224 s.
[2025-07-18 18:04:19,427 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.5646653175354 s.
[2025-07-18 18:04:19,427 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-18 18:04:20,009 INFO] validation BLEU: 31.846800223263976
[2025-07-18 18:04:20,010 INFO] Train perplexity: 59.7873
[2025-07-18 18:04:20,010 INFO] Train accuracy: 53.618
[2025-07-18 18:04:20,011 INFO] Sentences processed: 1.63699e+07
[2025-07-18 18:04:20,011 INFO] Average bsz: 7411/7960/341
[2025-07-18 18:04:20,011 INFO] Validation perplexity: 24.12
[2025-07-18 18:04:20,011 INFO] Validation accuracy: 62.4656
[2025-07-18 18:04:20,188 INFO] Decreasing patience: 2/3
[2025-07-18 18:04:20,205 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_12000.pt
[2025-07-18 18:06:34,554 INFO] Step 12100/200000; acc: 64.2; ppl:  24.6; xent: 3.2; lr: 0.00080; sents:  133931; bsz: 7092/7672/335; 15728/17016 tok/s;  16975 sec;
[2025-07-18 18:08:51,560 INFO] Step 12200/200000; acc: 66.4; ppl:  21.9; xent: 3.1; lr: 0.00080; sents:  123053; bsz: 7615/8044/308; 22251/23503 tok/s;  17112 sec;
[2025-07-18 18:11:06,247 INFO] Step 12300/200000; acc: 64.8; ppl:  24.1; xent: 3.2; lr: 0.00080; sents:  129235; bsz: 7202/7795/323; 21390/23150 tok/s;  17246 sec;
[2025-07-18 18:13:23,024 INFO] Step 12400/200000; acc: 65.5; ppl:  22.8; xent: 3.1; lr: 0.00079; sents:  107709; bsz: 7648/7985/269; 22366/23352 tok/s;  17383 sec;
[2025-07-18 18:15:40,054 INFO] Step 12500/200000; acc: 67.2; ppl:  21.0; xent: 3.0; lr: 0.00079; sents:  120009; bsz: 7551/8013/300; 22043/23392 tok/s;  17520 sec;
[2025-07-18 18:17:56,152 INFO] Step 12600/200000; acc: 66.4; ppl:  22.0; xent: 3.1; lr: 0.00079; sents:  129533; bsz: 7515/8123/324; 22088/23874 tok/s;  17656 sec;
[2025-07-18 18:20:10,447 INFO] Step 12700/200000; acc: 65.6; ppl:  22.8; xent: 3.1; lr: 0.00078; sents:  130578; bsz: 7305/7923/326; 21761/23601 tok/s;  17790 sec;
[2025-07-18 18:22:26,040 INFO] Step 12800/200000; acc: 66.7; ppl:  21.6; xent: 3.1; lr: 0.00078; sents:  130127; bsz: 7281/7972/325; 21505/23546 tok/s;  17926 sec;
[2025-07-18 18:24:41,918 INFO] Step 12900/200000; acc: 66.8; ppl:  21.2; xent: 3.1; lr: 0.00078; sents:  147185; bsz: 7306/7807/368; 21507/22983 tok/s;  18062 sec;
[2025-07-18 18:26:57,693 INFO] Step 13000/200000; acc: 66.6; ppl:  21.8; xent: 3.1; lr: 0.00078; sents:  151568; bsz: 7533/7977/379; 22194/23502 tok/s;  18198 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-18 18:27:29,763 INFO] valid stats calculation
                           took: 32.061771631240845 s.
[2025-07-18 18:27:40,955 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.191184997558594 s.
[2025-07-18 18:27:40,955 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-18 18:27:41,529 INFO] validation BLEU: 31.973787005481878
[2025-07-18 18:27:41,530 INFO] Train perplexity: 55.4418
[2025-07-18 18:27:41,530 INFO] Train accuracy: 54.5695
[2025-07-18 18:27:41,530 INFO] Sentences processed: 1.76729e+07
[2025-07-18 18:27:41,530 INFO] Average bsz: 7410/7957/340
[2025-07-18 18:27:41,530 INFO] Validation perplexity: 23.3756
[2025-07-18 18:27:41,531 INFO] Validation accuracy: 62.8223
[2025-07-18 18:27:41,633 INFO] Model is improving acc: 62.525 --> 62.8223.
[2025-07-18 18:29:55,989 INFO] Step 13100/200000; acc: 65.2; ppl:  23.7; xent: 3.2; lr: 0.00077; sents:  134109; bsz: 7377/7789/335; 16551/17475 tok/s;  18376 sec;
[2025-07-18 18:32:11,229 INFO] Step 13200/200000; acc: 65.4; ppl:  22.9; xent: 3.1; lr: 0.00077; sents:  132461; bsz: 7223/7741/331; 21364/22896 tok/s;  18511 sec;
[2025-07-18 18:34:26,685 INFO] Step 13300/200000; acc: 67.9; ppl:  19.5; xent: 3.0; lr: 0.00077; sents:  150709; bsz: 7357/7915/377; 21727/23373 tok/s;  18647 sec;
[2025-07-18 18:36:40,120 INFO] Step 13400/200000; acc: 65.4; ppl:  22.8; xent: 3.1; lr: 0.00076; sents:  108952; bsz: 7213/7779/272; 21624/23320 tok/s;  18780 sec;
[2025-07-18 18:38:53,808 INFO] Step 13500/200000; acc: 66.8; ppl:  21.1; xent: 3.0; lr: 0.00076; sents:  158293; bsz: 7068/7784/396; 21149/23291 tok/s;  18914 sec;
[2025-07-18 18:41:09,088 INFO] Step 13600/200000; acc: 67.3; ppl:  20.4; xent: 3.0; lr: 0.00076; sents:  153001; bsz: 7392/7876/383; 21867/23299 tok/s;  19049 sec;
[2025-07-18 18:43:23,872 INFO] Step 13700/200000; acc: 67.7; ppl:  20.0; xent: 3.0; lr: 0.00076; sents:  165291; bsz: 7303/7934/413; 21676/23548 tok/s;  19184 sec;
[2025-07-18 18:45:39,870 INFO] Step 13800/200000; acc: 71.2; ppl:  17.1; xent: 2.8; lr: 0.00075; sents:  227438; bsz: 7562/8283/569; 22277/24403 tok/s;  19320 sec;
[2025-07-18 18:47:54,884 INFO] Step 13900/200000; acc: 68.5; ppl:  19.2; xent: 3.0; lr: 0.00075; sents:  175656; bsz: 7434/8014/439; 22026/23744 tok/s;  19455 sec;
[2025-07-18 18:50:07,978 INFO] Step 14000/200000; acc: 66.5; ppl:  21.1; xent: 3.0; lr: 0.00075; sents:  126219; bsz: 7056/7769/316; 21208/23349 tok/s;  19588 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-18 18:50:41,407 INFO] valid stats calculation
                           took: 33.421183347702026 s.
[2025-07-18 18:50:52,319 INFO] The translation of the valid dataset for dynamic scoring
                               took : 10.911569118499756 s.
[2025-07-18 18:50:52,319 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-18 18:50:52,905 INFO] validation BLEU: 33.00516546503975
[2025-07-18 18:50:52,906 INFO] Train perplexity: 51.6975
[2025-07-18 18:50:52,907 INFO] Train accuracy: 55.4669
[2025-07-18 18:50:52,907 INFO] Sentences processed: 1.9205e+07
[2025-07-18 18:50:52,907 INFO] Average bsz: 7402/7952/343
[2025-07-18 18:50:52,907 INFO] Validation perplexity: 22.963
[2025-07-18 18:50:52,907 INFO] Validation accuracy: 63.281
[2025-07-18 18:50:52,908 INFO] Model is improving acc: 62.8223 --> 63.281.
[2025-07-18 18:50:52,916 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_14000.pt
[2025-07-18 18:53:09,425 INFO] Step 14100/200000; acc: 67.4; ppl:  20.0; xent: 3.0; lr: 0.00074; sents:  128257; bsz: 7521/7978/321; 16582/17588 tok/s;  19769 sec;
[2025-07-18 18:55:25,084 INFO] Step 14200/200000; acc: 67.6; ppl:  20.0; xent: 3.0; lr: 0.00074; sents:  141391; bsz: 7626/8109/353; 22507/23933 tok/s;  19905 sec;
[2025-07-18 18:57:38,651 INFO] Step 14300/200000; acc: 67.5; ppl:  20.0; xent: 3.0; lr: 0.00074; sents:  146169; bsz: 7259/7823/365; 21739/23429 tok/s;  20039 sec;
[2025-07-18 18:59:53,129 INFO] Step 14400/200000; acc: 67.5; ppl:  19.6; xent: 3.0; lr: 0.00074; sents:  143922; bsz: 7376/7631/360; 21944/22702 tok/s;  20173 sec;
[2025-07-18 19:02:05,347 INFO] Step 14500/200000; acc: 67.3; ppl:  20.5; xent: 3.0; lr: 0.00073; sents:  149888; bsz: 6893/7528/375; 20854/22777 tok/s;  20305 sec;
[2025-07-18 19:04:18,080 INFO] Step 14600/200000; acc: 66.3; ppl:  21.1; xent: 3.0; lr: 0.00073; sents:  127353; bsz: 6977/7446/318; 21026/22440 tok/s;  20438 sec;
[2025-07-18 19:06:32,763 INFO] Step 14700/200000; acc: 66.5; ppl:  21.0; xent: 3.0; lr: 0.00073; sents:  139227; bsz: 7513/7859/348; 22313/23341 tok/s;  20573 sec;
[2025-07-18 19:08:48,289 INFO] Step 14800/200000; acc: 63.4; ppl:  26.2; xent: 3.3; lr: 0.00073; sents:  140335; bsz: 7502/8234/351; 22146/24306 tok/s;  20708 sec;
[2025-07-18 19:11:02,170 INFO] Step 14900/200000; acc: 62.2; ppl:  27.6; xent: 3.3; lr: 0.00072; sents:  139153; bsz: 7510/7899/348; 22465/23628 tok/s;  20842 sec;
[2025-07-18 19:13:16,477 INFO] Step 15000/200000; acc: 61.2; ppl:  28.9; xent: 3.4; lr: 0.00072; sents:  108609; bsz: 7413/7898/272; 22078/23522 tok/s;  20977 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-18 19:13:44,793 INFO] valid stats calculation
                           took: 28.306188106536865 s.
[2025-07-18 19:13:55,863 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.069154977798462 s.
[2025-07-18 19:13:55,863 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-18 19:13:56,446 INFO] validation BLEU: 32.69922556854215
[2025-07-18 19:13:56,447 INFO] Train perplexity: 48.9132
[2025-07-18 19:13:56,447 INFO] Train accuracy: 56.1384
[2025-07-18 19:13:56,447 INFO] Sentences processed: 2.05693e+07
[2025-07-18 19:13:56,447 INFO] Average bsz: 7400/7945/343
[2025-07-18 19:13:56,447 INFO] Validation perplexity: 22.273
[2025-07-18 19:13:56,448 INFO] Validation accuracy: 63.571
[2025-07-18 19:13:56,454 INFO] Model is improving acc: 63.281 --> 63.571.
[2025-07-18 19:16:09,248 INFO] Step 15100/200000; acc: 61.3; ppl:  29.0; xent: 3.4; lr: 0.00072; sents:  122157; bsz: 7291/7649/305; 16881/17710 tok/s;  21149 sec;
[2025-07-18 19:18:23,818 INFO] Step 15200/200000; acc: 61.7; ppl:  28.2; xent: 3.3; lr: 0.00072; sents:  137539; bsz: 7493/8122/344; 22307/24178 tok/s;  21284 sec;
[2025-07-18 19:20:36,549 INFO] Step 15300/200000; acc: 62.2; ppl:  28.0; xent: 3.3; lr: 0.00071; sents:  147381; bsz: 7040/7977/368; 21218/24042 tok/s;  21417 sec;
[2025-07-18 19:22:49,965 INFO] Step 15400/200000; acc: 62.1; ppl:  28.0; xent: 3.3; lr: 0.00071; sents:  131114; bsz: 7220/7988/328; 21649/23951 tok/s;  21550 sec;
[2025-07-18 19:25:04,008 INFO] Step 15500/200000; acc: 62.7; ppl:  26.6; xent: 3.3; lr: 0.00071; sents:  127152; bsz: 7378/7732/318; 22019/23076 tok/s;  21684 sec;
[2025-07-18 19:27:18,492 INFO] Step 15600/200000; acc: 62.0; ppl:  27.5; xent: 3.3; lr: 0.00071; sents:  127278; bsz: 7621/7675/318; 22670/22829 tok/s;  21819 sec;
[2025-07-18 19:29:31,877 INFO] Step 15700/200000; acc: 61.2; ppl:  28.9; xent: 3.4; lr: 0.00071; sents:  126460; bsz: 7372/7784/316; 22109/23346 tok/s;  21952 sec;
[2025-07-18 19:31:46,672 INFO] Step 15800/200000; acc: 63.9; ppl:  24.7; xent: 3.2; lr: 0.00070; sents:  127930; bsz: 7372/7797/320; 21876/23138 tok/s;  22087 sec;
[2025-07-18 19:34:02,073 INFO] Step 15900/200000; acc: 64.4; ppl:  24.0; xent: 3.2; lr: 0.00070; sents:  145317; bsz: 7651/7973/363; 22604/23555 tok/s;  22222 sec;
[2025-07-18 19:36:13,221 INFO] Step 16000/200000; acc: 59.6; ppl:  31.4; xent: 3.4; lr: 0.00070; sents:  102673; bsz: 6969/7317/257; 21258/22320 tok/s;  22353 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-18 19:36:44,212 INFO] valid stats calculation
                           took: 30.980875253677368 s.
[2025-07-18 19:36:55,636 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.42383599281311 s.
[2025-07-18 19:36:55,636 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-18 19:36:56,220 INFO] validation BLEU: 33.60698852325975
[2025-07-18 19:36:56,221 INFO] Train perplexity: 47.2165
[2025-07-18 19:36:56,221 INFO] Train accuracy: 56.5061
[2025-07-18 19:36:56,221 INFO] Sentences processed: 2.18643e+07
[2025-07-18 19:36:56,222 INFO] Average bsz: 7396/7936/342
[2025-07-18 19:36:56,222 INFO] Validation perplexity: 22.0269
[2025-07-18 19:36:56,222 INFO] Validation accuracy: 63.8209
[2025-07-18 19:36:56,223 INFO] Model is improving acc: 63.571 --> 63.8209.
[2025-07-18 19:36:56,231 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_16000.pt
[2025-07-18 19:39:09,782 INFO] Step 16100/200000; acc: 63.1; ppl:  26.1; xent: 3.3; lr: 0.00070; sents:  139958; bsz: 7261/7841/350; 16451/17765 tok/s;  22530 sec;
[2025-07-18 19:39:16,834 INFO] Weighted corpora loaded so far:
			* corpus_0: 3
[2025-07-18 19:40:01,229 INFO] Weighted corpora loaded so far:
			* corpus_0: 3
[2025-07-18 19:40:06,761 INFO] Weighted corpora loaded so far:
			* corpus_0: 3
[2025-07-18 19:40:25,462 INFO] Weighted corpora loaded so far:
			* corpus_0: 3
[2025-07-18 19:40:35,529 INFO] Weighted corpora loaded so far:
			* corpus_0: 3
[2025-07-18 19:40:41,284 INFO] Weighted corpora loaded so far:
			* corpus_0: 3
[2025-07-18 19:40:50,502 INFO] Weighted corpora loaded so far:
			* corpus_0: 3
[2025-07-18 19:41:05,072 INFO] Weighted corpora loaded so far:
			* corpus_0: 3
[2025-07-18 19:41:16,525 INFO] Weighted corpora loaded so far:
			* corpus_0: 3
[2025-07-18 19:41:18,042 INFO] Weighted corpora loaded so far:
			* corpus_0: 3
[2025-07-18 19:41:24,221 INFO] Step 16200/200000; acc: 63.8; ppl:  25.0; xent: 3.2; lr: 0.00069; sents:  152658; bsz: 7361/8072/382; 21927/24045 tok/s;  22664 sec;
[2025-07-18 19:43:39,275 INFO] Step 16300/200000; acc: 64.6; ppl:  23.9; xent: 3.2; lr: 0.00069; sents:  145040; bsz: 7408/8018/363; 21941/23748 tok/s;  22799 sec;
[2025-07-18 19:45:54,854 INFO] Step 16400/200000; acc: 63.8; ppl:  25.0; xent: 3.2; lr: 0.00069; sents:  138127; bsz: 7443/8021/345; 21960/23665 tok/s;  22935 sec;
[2025-07-18 19:48:11,922 INFO] Step 16500/200000; acc: 62.2; ppl:  27.3; xent: 3.3; lr: 0.00069; sents:  122020; bsz: 7391/7849/305; 21572/22908 tok/s;  23072 sec;
[2025-07-18 19:50:26,179 INFO] Step 16600/200000; acc: 62.6; ppl:  26.3; xent: 3.3; lr: 0.00069; sents:  120883; bsz: 7395/7960/302; 22039/23723 tok/s;  23206 sec;
[2025-07-18 19:52:40,019 INFO] Step 16700/200000; acc: 61.0; ppl:  28.7; xent: 3.4; lr: 0.00068; sents:  120504; bsz: 7324/7924/301; 21890/23684 tok/s;  23340 sec;
[2025-07-18 19:54:53,054 INFO] Step 16800/200000; acc: 63.3; ppl:  24.8; xent: 3.2; lr: 0.00068; sents:  140315; bsz: 7245/8112/351; 21783/24389 tok/s;  23473 sec;
[2025-07-18 19:57:05,461 INFO] Step 16900/200000; acc: 63.6; ppl:  24.1; xent: 3.2; lr: 0.00068; sents:  139036; bsz: 6948/7828/348; 20990/23647 tok/s;  23606 sec;
[2025-07-18 19:59:20,728 INFO] Step 17000/200000; acc: 64.4; ppl:  22.8; xent: 3.1; lr: 0.00068; sents:  126340; bsz: 7664/8144/316; 22663/24084 tok/s;  23741 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-18 19:59:57,023 INFO] valid stats calculation
                           took: 36.29196262359619 s.
[2025-07-18 20:00:08,189 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.165174722671509 s.
[2025-07-18 20:00:08,189 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-18 20:00:08,775 INFO] validation BLEU: 33.727325086738325
[2025-07-18 20:00:08,874 INFO] Train perplexity: 45.5102
[2025-07-18 20:00:08,874 INFO] Train accuracy: 56.906
[2025-07-18 20:00:08,874 INFO] Sentences processed: 2.32092e+07
[2025-07-18 20:00:08,874 INFO] Average bsz: 7393/7938/341
[2025-07-18 20:00:08,875 INFO] Validation perplexity: 21.0146
[2025-07-18 20:00:08,875 INFO] Validation accuracy: 64.6436
[2025-07-18 20:00:08,876 INFO] Model is improving acc: 63.8209 --> 64.6436.
[2025-07-18 20:02:21,774 INFO] Step 17100/200000; acc: 62.7; ppl:  25.2; xent: 3.2; lr: 0.00068; sents:  118045; bsz: 7282/7937/295; 16088/17537 tok/s;  23922 sec;
[2025-07-18 20:04:37,361 INFO] Step 17200/200000; acc: 63.5; ppl:  23.6; xent: 3.2; lr: 0.00067; sents:  109242; bsz: 7692/8176/273; 22692/24119 tok/s;  24057 sec;
[2025-07-18 20:06:51,352 INFO] Step 17300/200000; acc: 64.2; ppl:  23.0; xent: 3.1; lr: 0.00067; sents:  140046; bsz: 7487/8098/350; 22350/24174 tok/s;  24191 sec;
[2025-07-18 20:09:06,182 INFO] Step 17400/200000; acc: 64.0; ppl:  23.2; xent: 3.1; lr: 0.00067; sents:  128712; bsz: 7364/7906/322; 21848/23455 tok/s;  24326 sec;
[2025-07-18 20:11:21,153 INFO] Step 17500/200000; acc: 64.5; ppl:  22.7; xent: 3.1; lr: 0.00067; sents:  138579; bsz: 7410/8009/346; 21960/23737 tok/s;  24461 sec;
[2025-07-18 20:13:37,010 INFO] Step 17600/200000; acc: 66.2; ppl:  20.2; xent: 3.0; lr: 0.00067; sents:  139062; bsz: 7749/8186/348; 22815/24101 tok/s;  24597 sec;
[2025-07-18 20:15:53,261 INFO] Step 17700/200000; acc: 65.9; ppl:  20.5; xent: 3.0; lr: 0.00066; sents:  133541; bsz: 7812/8086/334; 22934/23739 tok/s;  24733 sec;
[2025-07-18 20:18:07,378 INFO] Step 17800/200000; acc: 64.1; ppl:  22.9; xent: 3.1; lr: 0.00066; sents:  122564; bsz: 7193/7971/306; 21454/23774 tok/s;  24867 sec;
[2025-07-18 20:20:22,126 INFO] Step 17900/200000; acc: 64.5; ppl:  22.5; xent: 3.1; lr: 0.00066; sents:  125815; bsz: 7517/8222/315; 22314/24409 tok/s;  25002 sec;
[2025-07-18 20:22:37,057 INFO] Step 18000/200000; acc: 65.3; ppl:  21.6; xent: 3.1; lr: 0.00066; sents:  135521; bsz: 7417/7890/339; 21987/23389 tok/s;  25137 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-18 20:23:13,355 INFO] valid stats calculation
                           took: 36.29480719566345 s.
[2025-07-18 20:23:24,784 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.42903447151184 s.
[2025-07-18 20:23:24,784 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-18 20:23:25,364 INFO] validation BLEU: 34.243668946852594
[2025-07-18 20:23:25,365 INFO] Train perplexity: 43.7414
[2025-07-18 20:23:25,365 INFO] Train accuracy: 57.3327
[2025-07-18 20:23:25,365 INFO] Sentences processed: 2.45003e+07
[2025-07-18 20:23:25,365 INFO] Average bsz: 7398/7945/340
[2025-07-18 20:23:25,366 INFO] Validation perplexity: 20.5517
[2025-07-18 20:23:25,366 INFO] Validation accuracy: 64.9566
[2025-07-18 20:23:25,366 INFO] Model is improving acc: 64.6436 --> 64.9566.
[2025-07-18 20:23:25,375 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_18000.pt
[2025-07-18 20:25:41,861 INFO] Step 18100/200000; acc: 64.9; ppl:  21.9; xent: 3.1; lr: 0.00066; sents:  132035; bsz: 7720/8173/330; 16710/17691 tok/s;  25322 sec;
[2025-07-18 20:27:57,570 INFO] Step 18200/200000; acc: 66.1; ppl:  20.5; xent: 3.0; lr: 0.00066; sents:  131086; bsz: 7726/8288/328; 22773/24430 tok/s;  25458 sec;
[2025-07-18 20:30:13,340 INFO] Step 18300/200000; acc: 65.5; ppl:  21.3; xent: 3.1; lr: 0.00065; sents:  130427; bsz: 7593/8158/326; 22370/24036 tok/s;  25593 sec;
[2025-07-18 20:32:28,608 INFO] Step 18400/200000; acc: 64.8; ppl:  21.9; xent: 3.1; lr: 0.00065; sents:  115959; bsz: 7455/8151/290; 22044/24102 tok/s;  25729 sec;
[2025-07-18 20:34:44,672 INFO] Step 18500/200000; acc: 65.7; ppl:  21.0; xent: 3.0; lr: 0.00065; sents:  138669; bsz: 7691/8261/347; 22610/24287 tok/s;  25865 sec;
[2025-07-18 20:37:00,411 INFO] Step 18600/200000; acc: 66.2; ppl:  20.5; xent: 3.0; lr: 0.00065; sents:  131508; bsz: 7542/8169/329; 22225/24072 tok/s;  26000 sec;
[2025-07-18 20:39:16,025 INFO] Step 18700/200000; acc: 65.8; ppl:  21.0; xent: 3.0; lr: 0.00065; sents:  126337; bsz: 7465/8040/316; 22019/23716 tok/s;  26136 sec;
[2025-07-18 20:41:32,554 INFO] Step 18800/200000; acc: 69.3; ppl:  18.0; xent: 2.9; lr: 0.00064; sents:  132617; bsz: 7475/7976/332; 21902/23367 tok/s;  26273 sec;
[2025-07-18 20:43:47,614 INFO] Step 18900/200000; acc: 67.5; ppl:  19.9; xent: 3.0; lr: 0.00064; sents:  141519; bsz: 7362/7804/354; 21805/23112 tok/s;  26408 sec;
[2025-07-18 20:46:03,359 INFO] Step 19000/200000; acc: 68.5; ppl:  18.4; xent: 2.9; lr: 0.00064; sents:  139574; bsz: 7336/7834/349; 21618/23086 tok/s;  26543 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-18 20:46:40,112 INFO] valid stats calculation
                           took: 36.75109601020813 s.
[2025-07-18 20:46:51,739 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.625831604003906 s.
[2025-07-18 20:46:51,739 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-18 20:46:52,334 INFO] validation BLEU: 34.34184891236276
[2025-07-18 20:46:52,335 INFO] Train perplexity: 41.992
[2025-07-18 20:46:52,335 INFO] Train accuracy: 57.8191
[2025-07-18 20:46:52,336 INFO] Sentences processed: 2.582e+07
[2025-07-18 20:46:52,336 INFO] Average bsz: 7406/7952/340
[2025-07-18 20:46:52,336 INFO] Validation perplexity: 20.2045
[2025-07-18 20:46:52,336 INFO] Validation accuracy: 65.2624
[2025-07-18 20:46:52,337 INFO] Model is improving acc: 64.9566 --> 65.2624.
[2025-07-18 20:49:05,765 INFO] Step 19100/200000; acc: 67.8; ppl:  19.3; xent: 3.0; lr: 0.00064; sents:  145188; bsz: 7235/7782/363; 15866/17065 tok/s;  26726 sec;
[2025-07-18 20:51:21,838 INFO] Step 19200/200000; acc: 68.1; ppl:  18.9; xent: 2.9; lr: 0.00064; sents:  154262; bsz: 7679/8135/386; 22573/23915 tok/s;  26862 sec;
[2025-07-18 20:53:35,795 INFO] Step 19300/200000; acc: 67.9; ppl:  19.0; xent: 2.9; lr: 0.00064; sents:  128331; bsz: 7162/7695/321; 21386/22977 tok/s;  26996 sec;
[2025-07-18 20:55:49,514 INFO] Step 19400/200000; acc: 67.6; ppl:  19.6; xent: 3.0; lr: 0.00063; sents:  129142; bsz: 6900/7465/323; 20640/22330 tok/s;  27130 sec;
[2025-07-18 20:58:04,443 INFO] Step 19500/200000; acc: 67.3; ppl:  19.7; xent: 3.0; lr: 0.00063; sents:  107938; bsz: 7272/7687/270; 21557/22790 tok/s;  27264 sec;
[2025-07-18 21:00:18,235 INFO] Step 19600/200000; acc: 67.8; ppl:  18.7; xent: 2.9; lr: 0.00063; sents:  192278; bsz: 7030/7925/481; 21017/23693 tok/s;  27398 sec;
[2025-07-18 21:02:33,118 INFO] Step 19700/200000; acc: 68.3; ppl:  18.4; xent: 2.9; lr: 0.00063; sents:  139885; bsz: 7452/8081/350; 22099/23963 tok/s;  27533 sec;
[2025-07-18 21:04:48,778 INFO] Step 19800/200000; acc: 68.7; ppl:  18.3; xent: 2.9; lr: 0.00063; sents:  128551; bsz: 7532/8259/321; 22209/24353 tok/s;  27669 sec;
[2025-07-18 21:07:03,580 INFO] Step 19900/200000; acc: 68.5; ppl:  18.5; xent: 2.9; lr: 0.00063; sents:  126110; bsz: 7292/7835/315; 21637/23250 tok/s;  27804 sec;
[2025-07-18 21:09:18,231 INFO] Step 20000/200000; acc: 68.6; ppl:  18.3; xent: 2.9; lr: 0.00062; sents:  129108; bsz: 7278/8002/323; 21620/23773 tok/s;  27938 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-18 21:09:54,612 INFO] valid stats calculation
                           took: 36.377044677734375 s.
[2025-07-18 21:10:05,965 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.352477788925171 s.
[2025-07-18 21:10:05,965 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-18 21:10:06,575 INFO] validation BLEU: 34.406984834795665
[2025-07-18 21:10:06,575 INFO] Train perplexity: 40.3566
[2025-07-18 21:10:06,576 INFO] Train accuracy: 58.3285
[2025-07-18 21:10:06,576 INFO] Sentences processed: 2.72008e+07
[2025-07-18 21:10:06,576 INFO] Average bsz: 7400/7949/340
[2025-07-18 21:10:06,576 INFO] Validation perplexity: 19.8222
[2025-07-18 21:10:06,576 INFO] Validation accuracy: 65.4699
[2025-07-18 21:10:06,577 INFO] Model is improving acc: 65.2624 --> 65.4699.
[2025-07-18 21:10:06,585 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_20000.pt
[2025-07-18 21:12:23,214 INFO] Step 20100/200000; acc: 69.8; ppl:  17.1; xent: 2.8; lr: 0.00062; sents:  147989; bsz: 7510/8113/370; 16240/17544 tok/s;  28123 sec;
[2025-07-18 21:14:40,090 INFO] Step 20200/200000; acc: 70.3; ppl:  16.7; xent: 2.8; lr: 0.00062; sents:  139285; bsz: 7761/8337/348; 22681/24365 tok/s;  28260 sec;
[2025-07-18 21:16:56,610 INFO] Step 20300/200000; acc: 70.7; ppl:  16.5; xent: 2.8; lr: 0.00062; sents:  137451; bsz: 7626/8133/344; 22344/23829 tok/s;  28397 sec;
[2025-07-18 21:19:11,537 INFO] Step 20400/200000; acc: 68.2; ppl:  19.3; xent: 3.0; lr: 0.00062; sents:  148159; bsz: 7276/7917/370; 21571/23471 tok/s;  28532 sec;
[2025-07-18 21:21:25,564 INFO] Step 20500/200000; acc: 66.3; ppl:  21.9; xent: 3.1; lr: 0.00062; sents:  160828; bsz: 7170/7889/402; 21399/23544 tok/s;  28666 sec;
[2025-07-18 21:23:41,266 INFO] Step 20600/200000; acc: 66.4; ppl:  21.3; xent: 3.1; lr: 0.00062; sents:  143870; bsz: 7333/7829/360; 21616/23076 tok/s;  28801 sec;
[2025-07-18 21:25:56,796 INFO] Step 20700/200000; acc: 67.2; ppl:  20.4; xent: 3.0; lr: 0.00061; sents:  142648; bsz: 7515/7927/357; 22180/23396 tok/s;  28937 sec;
[2025-07-18 21:28:12,513 INFO] Step 20800/200000; acc: 68.6; ppl:  19.0; xent: 2.9; lr: 0.00061; sents:  130157; bsz: 7562/7958/325; 22289/23456 tok/s;  29073 sec;
[2025-07-18 21:30:27,673 INFO] Step 20900/200000; acc: 67.3; ppl:  20.2; xent: 3.0; lr: 0.00061; sents:  137591; bsz: 7524/7885/344; 22266/23336 tok/s;  29208 sec;
[2025-07-18 21:32:42,882 INFO] Step 21000/200000; acc: 67.9; ppl:  19.5; xent: 3.0; lr: 0.00061; sents:  134085; bsz: 7511/7950/335; 22220/23520 tok/s;  29343 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-18 21:33:17,814 INFO] valid stats calculation
                           took: 34.92991280555725 s.
[2025-07-18 21:33:29,081 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.267054557800293 s.
[2025-07-18 21:33:29,081 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-18 21:33:29,660 INFO] validation BLEU: 34.03946053010736
[2025-07-18 21:33:29,661 INFO] Train perplexity: 38.934
[2025-07-18 21:33:29,661 INFO] Train accuracy: 58.8049
[2025-07-18 21:33:29,661 INFO] Sentences processed: 2.86229e+07
[2025-07-18 21:33:29,661 INFO] Average bsz: 7403/7951/341
[2025-07-18 21:33:29,662 INFO] Validation perplexity: 19.8203
[2025-07-18 21:33:29,662 INFO] Validation accuracy: 65.4177
[2025-07-18 21:33:29,663 INFO] Decreasing patience: 2/3
[2025-07-18 21:35:44,715 INFO] Step 21100/200000; acc: 67.5; ppl:  19.7; xent: 3.0; lr: 0.00061; sents:  154957; bsz: 7709/8123/387; 16959/17869 tok/s;  29525 sec;
[2025-07-18 21:38:00,447 INFO] Step 21200/200000; acc: 67.6; ppl:  19.8; xent: 3.0; lr: 0.00061; sents:  126613; bsz: 7482/8045/317; 22048/23708 tok/s;  29660 sec;
[2025-07-18 21:40:16,569 INFO] Step 21300/200000; acc: 68.2; ppl:  19.1; xent: 2.9; lr: 0.00061; sents:  124422; bsz: 7611/7898/311; 22365/23210 tok/s;  29797 sec;
[2025-07-18 21:42:32,876 INFO] Step 21400/200000; acc: 68.2; ppl:  19.3; xent: 3.0; lr: 0.00060; sents:  140924; bsz: 7684/8217/352; 22550/24114 tok/s;  29933 sec;
[2025-07-18 21:44:48,524 INFO] Step 21500/200000; acc: 67.5; ppl:  20.0; xent: 3.0; lr: 0.00060; sents:  115329; bsz: 7264/7773/288; 21421/22920 tok/s;  30069 sec;
[2025-07-18 21:47:02,517 INFO] Step 21600/200000; acc: 67.4; ppl:  20.1; xent: 3.0; lr: 0.00060; sents:  139365; bsz: 7205/7711/348; 21508/23019 tok/s;  30203 sec;
[2025-07-18 21:49:18,882 INFO] Step 21700/200000; acc: 68.2; ppl:  19.1; xent: 2.9; lr: 0.00060; sents:  147196; bsz: 7573/8127/368; 22217/23841 tok/s;  30339 sec;
[2025-07-18 21:51:33,703 INFO] Step 21800/200000; acc: 67.3; ppl:  20.0; xent: 3.0; lr: 0.00060; sents:  132914; bsz: 7249/8018/332; 21507/23789 tok/s;  30474 sec;
[2025-07-18 21:53:48,237 INFO] Step 21900/200000; acc: 67.2; ppl:  20.1; xent: 3.0; lr: 0.00060; sents:  124245; bsz: 7295/7793/311; 21689/23170 tok/s;  30608 sec;
[2025-07-18 21:56:01,555 INFO] Step 22000/200000; acc: 66.5; ppl:  21.1; xent: 3.0; lr: 0.00060; sents:  134471; bsz: 7034/7635/336; 21105/22908 tok/s;  30742 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-18 21:56:37,719 INFO] valid stats calculation
                           took: 36.16143321990967 s.
[2025-07-18 21:56:49,078 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.358933210372925 s.
[2025-07-18 21:56:49,079 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-18 21:56:49,659 INFO] validation BLEU: 34.59771571227132
[2025-07-18 21:56:49,660 INFO] Train perplexity: 37.7574
[2025-07-18 21:56:49,660 INFO] Train accuracy: 59.2029
[2025-07-18 21:56:49,660 INFO] Sentences processed: 2.99633e+07
[2025-07-18 21:56:49,660 INFO] Average bsz: 7404/7950/340
[2025-07-18 21:56:49,660 INFO] Validation perplexity: 19.7837
[2025-07-18 21:56:49,660 INFO] Validation accuracy: 65.6567
[2025-07-18 21:56:49,672 INFO] Model is improving acc: 65.4699 --> 65.6567.
[2025-07-18 21:56:49,682 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_22000.pt
[2025-07-18 21:59:04,939 INFO] Step 22100/200000; acc: 67.2; ppl:  20.0; xent: 3.0; lr: 0.00059; sents:  126191; bsz: 7119/7698/315; 15528/16790 tok/s;  30925 sec;
[2025-07-18 22:01:20,390 INFO] Step 22200/200000; acc: 67.5; ppl:  19.7; xent: 3.0; lr: 0.00059; sents:  134400; bsz: 7397/7985/336; 21846/23583 tok/s;  31060 sec;
[2025-07-18 22:03:35,950 INFO] Step 22300/200000; acc: 67.7; ppl:  19.5; xent: 3.0; lr: 0.00059; sents:  141961; bsz: 7331/7981/355; 21631/23551 tok/s;  31196 sec;
[2025-07-18 22:05:49,430 INFO] Step 22400/200000; acc: 68.1; ppl:  19.2; xent: 3.0; lr: 0.00059; sents:  162168; bsz: 7120/7933/405; 21337/23773 tok/s;  31329 sec;
[2025-07-18 22:08:04,006 INFO] Step 22500/200000; acc: 69.0; ppl:  18.1; xent: 2.9; lr: 0.00059; sents:  159972; bsz: 7376/8077/400; 21923/24007 tok/s;  31464 sec;
[2025-07-18 22:10:18,817 INFO] Step 22600/200000; acc: 69.3; ppl:  18.2; xent: 2.9; lr: 0.00059; sents:  168502; bsz: 7483/7798/421; 22202/23137 tok/s;  31599 sec;
[2025-07-18 22:12:34,787 INFO] Step 22700/200000; acc: 70.1; ppl:  17.2; xent: 2.8; lr: 0.00059; sents:  154453; bsz: 7603/7876/386; 22366/23170 tok/s;  31735 sec;
[2025-07-18 22:14:50,565 INFO] Step 22800/200000; acc: 69.5; ppl:  18.0; xent: 2.9; lr: 0.00059; sents:  142640; bsz: 7244/7658/357; 21342/22560 tok/s;  31871 sec;
[2025-07-18 22:17:05,855 INFO] Step 22900/200000; acc: 68.7; ppl:  18.5; xent: 2.9; lr: 0.00058; sents:  137863; bsz: 7507/8099/345; 22194/23945 tok/s;  32006 sec;
[2025-07-18 22:19:21,020 INFO] Step 23000/200000; acc: 70.5; ppl:  16.9; xent: 2.8; lr: 0.00058; sents:  163738; bsz: 7341/7911/409; 21725/23412 tok/s;  32141 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-18 22:19:57,470 INFO] valid stats calculation
                           took: 36.447694063186646 s.
[2025-07-18 22:20:08,354 INFO] The translation of the valid dataset for dynamic scoring
                               took : 10.882970809936523 s.
[2025-07-18 22:20:08,354 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-18 22:20:08,941 INFO] validation BLEU: 34.90580954509638
[2025-07-18 22:20:08,942 INFO] Train perplexity: 36.6116
[2025-07-18 22:20:08,943 INFO] Train accuracy: 59.6157
[2025-07-18 22:20:08,943 INFO] Sentences processed: 3.14552e+07
[2025-07-18 22:20:08,943 INFO] Average bsz: 7401/7948/342
[2025-07-18 22:20:08,943 INFO] Validation perplexity: 19.4922
[2025-07-18 22:20:08,943 INFO] Validation accuracy: 65.7235
[2025-07-18 22:20:08,944 INFO] Model is improving acc: 65.6567 --> 65.7235.
[2025-07-18 22:22:23,091 INFO] Step 23100/200000; acc: 70.0; ppl:  17.0; xent: 2.8; lr: 0.00058; sents:  155689; bsz: 7357/7779/389; 16162/17091 tok/s;  32323 sec;
[2025-07-18 22:24:36,396 INFO] Step 23200/200000; acc: 69.2; ppl:  17.8; xent: 2.9; lr: 0.00058; sents:  159417; bsz: 7166/7891/399; 21503/23677 tok/s;  32456 sec;
[2025-07-18 22:26:50,673 INFO] Step 23300/200000; acc: 69.7; ppl:  17.6; xent: 2.9; lr: 0.00058; sents:  161836; bsz: 7224/7841/405; 21519/23358 tok/s;  32591 sec;
[2025-07-18 22:29:06,016 INFO] Step 23400/200000; acc: 68.0; ppl:  19.0; xent: 2.9; lr: 0.00058; sents:  112689; bsz: 7299/7675/282; 21572/22684 tok/s;  32726 sec;
[2025-07-18 22:31:20,264 INFO] Step 23500/200000; acc: 68.3; ppl:  18.8; xent: 2.9; lr: 0.00058; sents:  115283; bsz: 7302/7677/288; 21758/22875 tok/s;  32860 sec;
[2025-07-18 22:33:34,099 INFO] Step 23600/200000; acc: 68.6; ppl:  18.2; xent: 2.9; lr: 0.00058; sents:  145637; bsz: 7193/7858/364; 21499/23487 tok/s;  32994 sec;
[2025-07-18 22:35:47,094 INFO] Step 23700/200000; acc: 67.9; ppl:  18.9; xent: 2.9; lr: 0.00057; sents:  122953; bsz: 6925/7503/307; 20828/22565 tok/s;  33127 sec;
[2025-07-18 22:38:00,428 INFO] Step 23800/200000; acc: 68.1; ppl:  19.1; xent: 2.9; lr: 0.00057; sents:  141256; bsz: 7125/7934/353; 21376/23802 tok/s;  33260 sec;
[2025-07-18 22:40:13,106 INFO] Step 23900/200000; acc: 68.5; ppl:  18.5; xent: 2.9; lr: 0.00057; sents:  146337; bsz: 6980/7604/366; 21044/22926 tok/s;  33393 sec;
[2025-07-18 22:42:26,796 INFO] Step 24000/200000; acc: 65.6; ppl:  22.0; xent: 3.1; lr: 0.00057; sents:  142996; bsz: 7168/7751/357; 21448/23192 tok/s;  33527 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-18 22:43:01,317 INFO] valid stats calculation
                           took: 34.518635272979736 s.
[2025-07-18 22:43:12,786 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.468066930770874 s.
[2025-07-18 22:43:12,786 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-18 22:43:13,370 INFO] validation BLEU: 34.98981507981285
[2025-07-18 22:43:13,371 INFO] Train perplexity: 35.6206
[2025-07-18 22:43:13,371 INFO] Train accuracy: 59.973
[2025-07-18 22:43:13,371 INFO] Sentences processed: 3.28593e+07
[2025-07-18 22:43:13,371 INFO] Average bsz: 7392/7940/342
[2025-07-18 22:43:13,371 INFO] Validation perplexity: 19.6037
[2025-07-18 22:43:13,372 INFO] Validation accuracy: 65.6604
[2025-07-18 22:43:13,372 INFO] Decreasing patience: 2/3
[2025-07-18 22:43:13,380 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_24000.pt
[2025-07-18 22:45:26,689 INFO] Step 24100/200000; acc: 60.9; ppl:  29.0; xent: 3.4; lr: 0.00057; sents:  125585; bsz: 7045/7809/314; 15666/17364 tok/s;  33707 sec;
[2025-07-18 22:47:40,068 INFO] Step 24200/200000; acc: 61.7; ppl:  27.4; xent: 3.3; lr: 0.00057; sents:  121674; bsz: 7325/7938/304; 21970/23808 tok/s;  33840 sec;
[2025-07-18 22:49:53,816 INFO] Step 24300/200000; acc: 61.6; ppl:  27.7; xent: 3.3; lr: 0.00057; sents:  124296; bsz: 7342/7963/311; 21957/23816 tok/s;  33974 sec;
[2025-07-18 22:52:08,784 INFO] Step 24400/200000; acc: 63.1; ppl:  25.1; xent: 3.2; lr: 0.00057; sents:  126144; bsz: 7297/8054/315; 21625/23869 tok/s;  34109 sec;
[2025-07-18 22:54:23,471 INFO] Step 24500/200000; acc: 61.6; ppl:  27.1; xent: 3.3; lr: 0.00056; sents:  104113; bsz: 7442/7919/260; 22101/23519 tok/s;  34244 sec;
[2025-07-18 22:56:37,046 INFO] Step 24600/200000; acc: 62.9; ppl:  25.6; xent: 3.2; lr: 0.00056; sents:  142659; bsz: 7546/7866/357; 22598/23556 tok/s;  34377 sec;
[2025-07-18 22:58:52,495 INFO] Step 24700/200000; acc: 63.8; ppl:  24.3; xent: 3.2; lr: 0.00056; sents:  145512; bsz: 7863/8075/364; 23222/23848 tok/s;  34513 sec;
[2025-07-18 23:01:07,552 INFO] Step 24800/200000; acc: 62.6; ppl:  25.6; xent: 3.2; lr: 0.00056; sents:  115795; bsz: 7480/8153/289; 22154/24148 tok/s;  34648 sec;
[2025-07-18 23:03:22,719 INFO] Step 24900/200000; acc: 63.6; ppl:  24.7; xent: 3.2; lr: 0.00056; sents:  131653; bsz: 7642/8110/329; 22616/24000 tok/s;  34783 sec;
[2025-07-18 23:05:36,773 INFO] Step 25000/200000; acc: 62.5; ppl:  26.2; xent: 3.3; lr: 0.00056; sents:  144239; bsz: 7471/8129/361; 22293/24256 tok/s;  34917 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-18 23:06:12,883 INFO] valid stats calculation
                           took: 36.10663866996765 s.
[2025-07-18 23:06:24,526 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.642899990081787 s.
[2025-07-18 23:06:24,526 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-18 23:06:25,109 INFO] validation BLEU: 34.803409301619034
[2025-07-18 23:06:25,110 INFO] Train perplexity: 35.1842
[2025-07-18 23:06:25,110 INFO] Train accuracy: 60.0721
[2025-07-18 23:06:25,110 INFO] Sentences processed: 3.4141e+07
[2025-07-18 23:06:25,110 INFO] Average bsz: 7394/7942/341
[2025-07-18 23:06:25,111 INFO] Validation perplexity: 19.1588
[2025-07-18 23:06:25,111 INFO] Validation accuracy: 66.096
[2025-07-18 23:06:25,111 INFO] Model is improving acc: 65.7235 --> 66.096.
[2025-07-18 23:08:38,189 INFO] Step 25100/200000; acc: 61.7; ppl:  27.4; xent: 3.3; lr: 0.00056; sents:  124337; bsz: 7258/7895/311; 16003/17408 tok/s;  35098 sec;
[2025-07-18 23:10:51,129 INFO] Step 25200/200000; acc: 62.2; ppl:  26.2; xent: 3.3; lr: 0.00056; sents:  118121; bsz: 7308/7964/295; 21990/23962 tok/s;  35231 sec;
[2025-07-18 23:13:05,405 INFO] Step 25300/200000; acc: 63.5; ppl:  24.6; xent: 3.2; lr: 0.00056; sents:  138525; bsz: 7473/8117/346; 22260/24179 tok/s;  35365 sec;
[2025-07-18 23:15:21,381 INFO] Step 25400/200000; acc: 65.6; ppl:  21.9; xent: 3.1; lr: 0.00055; sents:  135633; bsz: 7624/7999/339; 22427/23532 tok/s;  35501 sec;
[2025-07-18 23:15:22,533 INFO] Weighted corpora loaded so far:
			* corpus_0: 4
[2025-07-18 23:15:58,569 INFO] Weighted corpora loaded so far:
			* corpus_0: 4
[2025-07-18 23:16:05,765 INFO] Weighted corpora loaded so far:
			* corpus_0: 4
[2025-07-18 23:17:05,462 INFO] Weighted corpora loaded so far:
			* corpus_0: 4
[2025-07-18 23:17:10,526 INFO] Weighted corpora loaded so far:
			* corpus_0: 4
[2025-07-18 23:17:26,685 INFO] Weighted corpora loaded so far:
			* corpus_0: 4
[2025-07-18 23:17:26,863 INFO] Weighted corpora loaded so far:
			* corpus_0: 4
[2025-07-18 23:17:36,416 INFO] Step 25500/200000; acc: 64.0; ppl:  23.6; xent: 3.2; lr: 0.00055; sents:  123385; bsz: 7594/7981/308; 22494/23641 tok/s;  35636 sec;
[2025-07-18 23:18:12,232 INFO] Weighted corpora loaded so far:
			* corpus_0: 4
[2025-07-18 23:18:22,435 INFO] Weighted corpora loaded so far:
			* corpus_0: 4
[2025-07-18 23:18:23,726 INFO] Weighted corpora loaded so far:
			* corpus_0: 4
[2025-07-18 23:19:52,238 INFO] Step 25600/200000; acc: 64.7; ppl:  22.7; xent: 3.1; lr: 0.00055; sents:  132803; bsz: 7681/8238/332; 22620/24262 tok/s;  35772 sec;
[2025-07-18 23:22:07,049 INFO] Step 25700/200000; acc: 62.7; ppl:  25.4; xent: 3.2; lr: 0.00055; sents:  113856; bsz: 7498/8039/285; 22248/23852 tok/s;  35907 sec;
[2025-07-18 23:24:21,536 INFO] Step 25800/200000; acc: 63.8; ppl:  23.8; xent: 3.2; lr: 0.00055; sents:  117939; bsz: 7449/7871/295; 22156/23412 tok/s;  36042 sec;
[2025-07-18 23:26:34,548 INFO] Step 25900/200000; acc: 63.5; ppl:  24.5; xent: 3.2; lr: 0.00055; sents:  127637; bsz: 7246/7867/319; 21790/23660 tok/s;  36175 sec;
[2025-07-18 23:28:48,827 INFO] Step 26000/200000; acc: 64.7; ppl:  22.8; xent: 3.1; lr: 0.00055; sents:  132749; bsz: 7334/7774/332; 21846/23157 tok/s;  36309 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-18 23:29:25,535 INFO] valid stats calculation
                           took: 36.70616626739502 s.
[2025-07-18 23:29:36,653 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.118080854415894 s.
[2025-07-18 23:29:36,654 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-18 23:29:37,246 INFO] validation BLEU: 35.392849727330265
[2025-07-18 23:29:37,247 INFO] Train perplexity: 34.6808
[2025-07-18 23:29:37,247 INFO] Train accuracy: 60.2106
[2025-07-18 23:29:37,247 INFO] Sentences processed: 3.5406e+07
[2025-07-18 23:29:37,247 INFO] Average bsz: 7396/7943/340
[2025-07-18 23:29:37,247 INFO] Validation perplexity: 18.88
[2025-07-18 23:29:37,247 INFO] Validation accuracy: 66.4964
[2025-07-18 23:29:37,248 INFO] Model is improving acc: 66.096 --> 66.4964.
[2025-07-18 23:29:37,256 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_26000.pt
[2025-07-18 23:31:51,649 INFO] Step 26100/200000; acc: 66.9; ppl:  19.6; xent: 3.0; lr: 0.00055; sents:  146205; bsz: 7499/8119/366; 16407/17764 tok/s;  36492 sec;
[2025-07-18 23:34:07,384 INFO] Step 26200/200000; acc: 67.3; ppl:  19.0; xent: 2.9; lr: 0.00055; sents:  135857; bsz: 7533/7924/340; 22198/23351 tok/s;  36627 sec;
[2025-07-18 23:36:22,168 INFO] Step 26300/200000; acc: 66.9; ppl:  19.4; xent: 3.0; lr: 0.00055; sents:  132425; bsz: 7550/7889/331; 22407/23413 tok/s;  36762 sec;
[2025-07-18 23:38:38,196 INFO] Step 26400/200000; acc: 67.2; ppl:  19.1; xent: 3.0; lr: 0.00054; sents:  139745; bsz: 7524/8080/349; 22126/23760 tok/s;  36898 sec;
[2025-07-18 23:40:53,690 INFO] Step 26500/200000; acc: 66.9; ppl:  19.4; xent: 3.0; lr: 0.00054; sents:  134684; bsz: 7697/8247/337; 22723/24346 tok/s;  37034 sec;
[2025-07-18 23:43:09,630 INFO] Step 26600/200000; acc: 68.0; ppl:  18.2; xent: 2.9; lr: 0.00054; sents:  130931; bsz: 7730/8154/327; 22746/23993 tok/s;  37170 sec;
[2025-07-18 23:45:24,621 INFO] Step 26700/200000; acc: 67.3; ppl:  18.9; xent: 2.9; lr: 0.00054; sents:  129130; bsz: 7467/7941/323; 22125/23530 tok/s;  37305 sec;
[2025-07-18 23:47:39,503 INFO] Step 26800/200000; acc: 66.9; ppl:  19.4; xent: 3.0; lr: 0.00054; sents:  121748; bsz: 7370/7916/304; 21857/23475 tok/s;  37440 sec;
[2025-07-18 23:49:52,974 INFO] Step 26900/200000; acc: 66.9; ppl:  19.4; xent: 3.0; lr: 0.00054; sents:  133865; bsz: 7259/7841/335; 21753/23498 tok/s;  37573 sec;
[2025-07-18 23:52:07,862 INFO] Step 27000/200000; acc: 68.4; ppl:  17.9; xent: 2.9; lr: 0.00054; sents:  136698; bsz: 7487/8334/342; 22202/24713 tok/s;  37708 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-18 23:52:43,645 INFO] valid stats calculation
                           took: 35.78016948699951 s.
[2025-07-18 23:52:55,263 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.617088794708252 s.
[2025-07-18 23:52:55,263 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-18 23:52:55,855 INFO] validation BLEU: 35.45820120867258
[2025-07-18 23:52:55,856 INFO] Train perplexity: 33.909
[2025-07-18 23:52:55,856 INFO] Train accuracy: 60.4755
[2025-07-18 23:52:55,856 INFO] Sentences processed: 3.67472e+07
[2025-07-18 23:52:55,856 INFO] Average bsz: 7400/7947/340
[2025-07-18 23:52:55,856 INFO] Validation perplexity: 18.6556
[2025-07-18 23:52:55,856 INFO] Validation accuracy: 66.5656
[2025-07-18 23:52:55,857 INFO] Model is improving acc: 66.4964 --> 66.5656.
[2025-07-18 23:55:09,267 INFO] Step 27100/200000; acc: 68.6; ppl:  17.7; xent: 2.9; lr: 0.00054; sents:  156226; bsz: 7477/8146/391; 16487/17963 tok/s;  37889 sec;
[2025-07-18 23:57:24,570 INFO] Step 27200/200000; acc: 67.3; ppl:  18.8; xent: 2.9; lr: 0.00054; sents:  125087; bsz: 7689/8207/313; 22733/24264 tok/s;  38025 sec;
[2025-07-18 23:59:40,332 INFO] Step 27300/200000; acc: 67.3; ppl:  18.7; xent: 2.9; lr: 0.00053; sents:  119796; bsz: 7637/8262/299; 22502/24343 tok/s;  38160 sec;
[2025-07-19 00:01:55,061 INFO] Step 27400/200000; acc: 67.6; ppl:  18.6; xent: 2.9; lr: 0.00053; sents:  124338; bsz: 7432/7963/311; 22066/23642 tok/s;  38295 sec;
[2025-07-19 00:04:11,014 INFO] Step 27500/200000; acc: 67.8; ppl:  18.4; xent: 2.9; lr: 0.00053; sents:  125991; bsz: 7545/8198/315; 22200/24122 tok/s;  38431 sec;
[2025-07-19 00:06:25,480 INFO] Step 27600/200000; acc: 67.6; ppl:  18.8; xent: 2.9; lr: 0.00053; sents:  122690; bsz: 7283/7899/307; 21665/23497 tok/s;  38566 sec;
[2025-07-19 00:08:40,134 INFO] Step 27700/200000; acc: 67.9; ppl:  18.3; xent: 2.9; lr: 0.00053; sents:  138336; bsz: 7414/7979/346; 22024/23702 tok/s;  38700 sec;
[2025-07-19 00:10:55,797 INFO] Step 27800/200000; acc: 68.1; ppl:  18.2; xent: 2.9; lr: 0.00053; sents:  142883; bsz: 7452/8054/357; 21972/23746 tok/s;  38836 sec;
[2025-07-19 00:13:10,209 INFO] Step 27900/200000; acc: 68.4; ppl:  18.3; xent: 2.9; lr: 0.00053; sents:  157716; bsz: 7290/7922/394; 21694/23576 tok/s;  38970 sec;
[2025-07-19 00:15:26,133 INFO] Step 28000/200000; acc: 69.9; ppl:  17.2; xent: 2.8; lr: 0.00053; sents:  187619; bsz: 7531/8081/469; 22163/23782 tok/s;  39106 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-19 00:16:02,713 INFO] valid stats calculation
                           took: 36.5781364440918 s.
[2025-07-19 00:16:14,220 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.50618314743042 s.
[2025-07-19 00:16:14,220 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-19 00:16:14,812 INFO] validation BLEU: 35.42257608059348
[2025-07-19 00:16:14,813 INFO] Train perplexity: 33.158
[2025-07-19 00:16:14,813 INFO] Train accuracy: 60.7501
[2025-07-19 00:16:14,813 INFO] Sentences processed: 3.81479e+07
[2025-07-19 00:16:14,813 INFO] Average bsz: 7403/7952/341
[2025-07-19 00:16:14,813 INFO] Validation perplexity: 18.3986
[2025-07-19 00:16:14,813 INFO] Validation accuracy: 66.733
[2025-07-19 00:16:14,821 INFO] Model is improving acc: 66.5656 --> 66.733.
[2025-07-19 00:16:14,830 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_28000.pt
[2025-07-19 00:18:31,123 INFO] Step 28100/200000; acc: 69.3; ppl:  17.8; xent: 2.9; lr: 0.00053; sents:  140704; bsz: 7306/7757/352; 15797/16773 tok/s;  39291 sec;
[2025-07-19 00:20:47,437 INFO] Step 28200/200000; acc: 69.9; ppl:  17.3; xent: 2.9; lr: 0.00053; sents:  172043; bsz: 7483/8288/430; 21960/24323 tok/s;  39427 sec;
[2025-07-19 00:23:03,586 INFO] Step 28300/200000; acc: 68.9; ppl:  17.7; xent: 2.9; lr: 0.00053; sents:  157131; bsz: 7517/8000/393; 22084/23505 tok/s;  39564 sec;
[2025-07-19 00:25:18,279 INFO] Step 28400/200000; acc: 69.7; ppl:  17.4; xent: 2.9; lr: 0.00052; sents:  129944; bsz: 7201/7750/325; 21384/23015 tok/s;  39698 sec;
[2025-07-19 00:27:32,877 INFO] Step 28500/200000; acc: 68.5; ppl:  18.5; xent: 2.9; lr: 0.00052; sents:  123869; bsz: 7266/7772/310; 21593/23098 tok/s;  39833 sec;
[2025-07-19 00:29:47,817 INFO] Step 28600/200000; acc: 68.5; ppl:  18.4; xent: 2.9; lr: 0.00052; sents:  137089; bsz: 7265/7892/343; 21535/23395 tok/s;  39968 sec;
[2025-07-19 00:32:04,130 INFO] Step 28700/200000; acc: 70.2; ppl:  16.8; xent: 2.8; lr: 0.00052; sents:  126901; bsz: 7489/7954/317; 21978/23343 tok/s;  40104 sec;
[2025-07-19 00:34:19,744 INFO] Step 28800/200000; acc: 69.2; ppl:  17.9; xent: 2.9; lr: 0.00052; sents:  133770; bsz: 7536/8004/334; 22229/23609 tok/s;  40240 sec;
[2025-07-19 00:36:34,991 INFO] Step 28900/200000; acc: 69.7; ppl:  17.2; xent: 2.8; lr: 0.00052; sents:  133029; bsz: 7412/8054/333; 21922/23819 tok/s;  40375 sec;
[2025-07-19 00:38:51,084 INFO] Step 29000/200000; acc: 69.8; ppl:  17.0; xent: 2.8; lr: 0.00052; sents:  128156; bsz: 7619/8201/320; 22393/24104 tok/s;  40511 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-19 00:39:27,409 INFO] valid stats calculation
                           took: 36.321659326553345 s.
[2025-07-19 00:39:38,624 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.215125322341919 s.
[2025-07-19 00:39:38,624 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-19 00:39:39,218 INFO] validation BLEU: 35.700094552315264
[2025-07-19 00:39:39,219 INFO] Train perplexity: 32.4394
[2025-07-19 00:39:39,219 INFO] Train accuracy: 61.048
[2025-07-19 00:39:39,219 INFO] Sentences processed: 3.95306e+07
[2025-07-19 00:39:39,219 INFO] Average bsz: 7403/7952/341
[2025-07-19 00:39:39,219 INFO] Validation perplexity: 18.1856
[2025-07-19 00:39:39,219 INFO] Validation accuracy: 66.8458
[2025-07-19 00:39:39,220 INFO] Model is improving acc: 66.733 --> 66.8458.
[2025-07-19 00:41:53,482 INFO] Step 29100/200000; acc: 69.7; ppl:  17.4; xent: 2.9; lr: 0.00052; sents:  147546; bsz: 7379/8052/369; 16182/17657 tok/s;  40694 sec;
[2025-07-19 00:44:07,820 INFO] Step 29200/200000; acc: 69.7; ppl:  17.4; xent: 2.9; lr: 0.00052; sents:  123107; bsz: 7241/7880/308; 21562/23465 tok/s;  40828 sec;
[2025-07-19 00:46:22,468 INFO] Step 29300/200000; acc: 68.9; ppl:  17.9; xent: 2.9; lr: 0.00052; sents:  111495; bsz: 7217/7866/279; 21441/23367 tok/s;  40963 sec;
[2025-07-19 00:48:38,309 INFO] Step 29400/200000; acc: 69.9; ppl:  17.1; xent: 2.8; lr: 0.00052; sents:  121863; bsz: 7323/7879/305; 21563/23201 tok/s;  41098 sec;
[2025-07-19 00:50:53,024 INFO] Step 29500/200000; acc: 69.5; ppl:  17.4; xent: 2.9; lr: 0.00051; sents:  126397; bsz: 7392/7885/316; 21948/23413 tok/s;  41233 sec;
[2025-07-19 00:53:08,454 INFO] Step 29600/200000; acc: 69.4; ppl:  17.5; xent: 2.9; lr: 0.00051; sents:  126475; bsz: 7381/7830/316; 21799/23128 tok/s;  41369 sec;
[2025-07-19 00:55:22,853 INFO] Step 29700/200000; acc: 67.7; ppl:  19.3; xent: 3.0; lr: 0.00051; sents:  130504; bsz: 7342/7861/326; 21852/23396 tok/s;  41503 sec;
[2025-07-19 00:57:38,811 INFO] Step 29800/200000; acc: 68.2; ppl:  19.1; xent: 3.0; lr: 0.00051; sents:  143254; bsz: 7733/7970/358; 22752/23450 tok/s;  41639 sec;
[2025-07-19 00:59:54,235 INFO] Step 29900/200000; acc: 68.4; ppl:  18.6; xent: 2.9; lr: 0.00051; sents:  130174; bsz: 7386/7910/325; 21817/23365 tok/s;  41774 sec;
[2025-07-19 01:02:09,898 INFO] Step 30000/200000; acc: 68.4; ppl:  18.7; xent: 2.9; lr: 0.00051; sents:  140925; bsz: 7405/7934/352; 21833/23393 tok/s;  41910 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-19 01:02:46,258 INFO] valid stats calculation
                           took: 36.35727334022522 s.
[2025-07-19 01:02:57,600 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.341475248336792 s.
[2025-07-19 01:02:57,600 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-19 01:02:58,187 INFO] validation BLEU: 35.71401852443379
[2025-07-19 01:02:58,188 INFO] Train perplexity: 31.8133
[2025-07-19 01:02:58,188 INFO] Train accuracy: 61.311
[2025-07-19 01:02:58,188 INFO] Sentences processed: 4.08323e+07
[2025-07-19 01:02:58,188 INFO] Average bsz: 7402/7951/340
[2025-07-19 01:02:58,189 INFO] Validation perplexity: 18.4035
[2025-07-19 01:02:58,189 INFO] Validation accuracy: 66.8446
[2025-07-19 01:02:58,189 INFO] Decreasing patience: 2/3
[2025-07-19 01:02:58,198 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_30000.pt
[2025-07-19 01:05:14,372 INFO] Step 30100/200000; acc: 68.3; ppl:  18.2; xent: 2.9; lr: 0.00051; sents:  132739; bsz: 7669/8212/332; 16629/17806 tok/s;  42094 sec;
[2025-07-19 01:07:30,005 INFO] Step 30200/200000; acc: 68.2; ppl:  18.7; xent: 2.9; lr: 0.00051; sents:  117853; bsz: 7538/7932/295; 22231/23391 tok/s;  42230 sec;
[2025-07-19 01:09:43,464 INFO] Step 30300/200000; acc: 68.1; ppl:  19.2; xent: 3.0; lr: 0.00051; sents:  123345; bsz: 7147/7675/308; 21421/23003 tok/s;  42364 sec;
[2025-07-19 01:11:59,613 INFO] Step 30400/200000; acc: 68.6; ppl:  18.7; xent: 2.9; lr: 0.00051; sents:  124269; bsz: 7573/7909/311; 22250/23236 tok/s;  42500 sec;
[2025-07-19 01:14:14,475 INFO] Step 30500/200000; acc: 69.9; ppl:  17.4; xent: 2.9; lr: 0.00051; sents:  149742; bsz: 7510/7977/374; 22274/23659 tok/s;  42635 sec;
[2025-07-19 01:16:30,581 INFO] Step 30600/200000; acc: 69.8; ppl:  17.3; xent: 2.8; lr: 0.00051; sents:  149562; bsz: 7472/8070/374; 21959/23717 tok/s;  42771 sec;
[2025-07-19 01:18:45,469 INFO] Step 30700/200000; acc: 68.5; ppl:  18.5; xent: 2.9; lr: 0.00050; sents:  139367; bsz: 7426/7895/348; 22021/23412 tok/s;  42906 sec;
[2025-07-19 01:21:00,007 INFO] Step 30800/200000; acc: 69.0; ppl:  18.1; xent: 2.9; lr: 0.00050; sents:  135192; bsz: 7213/7720/338; 21446/22953 tok/s;  43040 sec;
[2025-07-19 01:23:13,297 INFO] Step 30900/200000; acc: 68.9; ppl:  18.3; xent: 2.9; lr: 0.00050; sents:  151727; bsz: 7078/7783/379; 21240/23358 tok/s;  43173 sec;
[2025-07-19 01:25:27,111 INFO] Step 31000/200000; acc: 68.5; ppl:  18.6; xent: 2.9; lr: 0.00050; sents:  133417; bsz: 7156/7660/334; 21393/22896 tok/s;  43307 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-19 01:26:03,193 INFO] valid stats calculation
                           took: 36.08015727996826 s.
[2025-07-19 01:26:14,580 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.386967182159424 s.
[2025-07-19 01:26:14,581 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-19 01:26:15,171 INFO] validation BLEU: 35.672379259824375
[2025-07-19 01:26:15,172 INFO] Train perplexity: 31.2535
[2025-07-19 01:26:15,172 INFO] Train accuracy: 61.5497
[2025-07-19 01:26:15,172 INFO] Sentences processed: 4.21895e+07
[2025-07-19 01:26:15,172 INFO] Average bsz: 7402/7949/340
[2025-07-19 01:26:15,172 INFO] Validation perplexity: 18.5351
[2025-07-19 01:26:15,173 INFO] Validation accuracy: 66.6335
[2025-07-19 01:26:15,173 INFO] Decreasing patience: 1/3
[2025-07-19 01:28:30,306 INFO] Step 31100/200000; acc: 70.1; ppl:  17.0; xent: 2.8; lr: 0.00050; sents:  132203; bsz: 7411/7991/331; 16181/17448 tok/s;  43490 sec;
[2025-07-19 01:30:43,987 INFO] Step 31200/200000; acc: 69.4; ppl:  17.8; xent: 2.9; lr: 0.00050; sents:  139448; bsz: 7111/7830/349; 21279/23428 tok/s;  43624 sec;
[2025-07-19 01:32:59,000 INFO] Step 31300/200000; acc: 68.8; ppl:  18.3; xent: 2.9; lr: 0.00050; sents:  147272; bsz: 7289/7967/368; 21595/23604 tok/s;  43759 sec;
[2025-07-19 01:35:15,772 INFO] Step 31400/200000; acc: 69.2; ppl:  17.7; xent: 2.9; lr: 0.00050; sents:  145839; bsz: 7493/8015/365; 21915/23440 tok/s;  43896 sec;
[2025-07-19 01:37:30,762 INFO] Step 31500/200000; acc: 69.3; ppl:  17.8; xent: 2.9; lr: 0.00050; sents:  163082; bsz: 7339/7906/408; 21748/23428 tok/s;  44031 sec;
[2025-07-19 01:39:43,825 INFO] Step 31600/200000; acc: 68.5; ppl:  18.6; xent: 2.9; lr: 0.00050; sents:  147816; bsz: 6995/7848/370; 21027/23591 tok/s;  44164 sec;
[2025-07-19 01:41:58,860 INFO] Step 31700/200000; acc: 68.8; ppl:  18.1; xent: 2.9; lr: 0.00050; sents:  143909; bsz: 7366/7789/360; 21820/23072 tok/s;  44299 sec;
[2025-07-19 01:44:12,864 INFO] Step 31800/200000; acc: 69.8; ppl:  17.5; xent: 2.9; lr: 0.00050; sents:  142585; bsz: 7285/7642/356; 21747/22811 tok/s;  44433 sec;
[2025-07-19 01:46:27,096 INFO] Step 31900/200000; acc: 70.3; ppl:  17.1; xent: 2.8; lr: 0.00049; sents:  151533; bsz: 7047/7636/379; 21000/22754 tok/s;  44567 sec;
[2025-07-19 01:48:40,950 INFO] Step 32000/200000; acc: 68.5; ppl:  18.4; xent: 2.9; lr: 0.00049; sents:  125736; bsz: 7121/7522/314; 21280/22478 tok/s;  44701 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-19 01:49:17,187 INFO] valid stats calculation
                           took: 36.23405170440674 s.
[2025-07-19 01:49:28,454 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.26670217514038 s.
[2025-07-19 01:49:28,454 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-19 01:49:29,045 INFO] validation BLEU: 35.71065262217778
[2025-07-19 01:49:29,046 INFO] Train perplexity: 30.7183
[2025-07-19 01:49:29,046 INFO] Train accuracy: 61.787
[2025-07-19 01:49:29,046 INFO] Sentences processed: 4.36289e+07
[2025-07-19 01:49:29,046 INFO] Average bsz: 7397/7944/341
[2025-07-19 01:49:29,046 INFO] Validation perplexity: 18.2382
[2025-07-19 01:49:29,046 INFO] Validation accuracy: 66.8762
[2025-07-19 01:49:29,047 INFO] Model is improving acc: 66.8458 --> 66.8762.
[2025-07-19 01:49:29,055 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_32000.pt
[2025-07-19 01:51:45,502 INFO] Step 32100/200000; acc: 69.7; ppl:  17.6; xent: 2.9; lr: 0.00049; sents:  152096; bsz: 7310/7760/380; 15845/16820 tok/s;  44886 sec;
[2025-07-19 01:53:59,719 INFO] Step 32200/200000; acc: 70.2; ppl:  16.9; xent: 2.8; lr: 0.00049; sents:  165659; bsz: 7238/7927/414; 21574/23627 tok/s;  45020 sec;
[2025-07-19 01:56:13,609 INFO] Step 32300/200000; acc: 69.8; ppl:  17.7; xent: 2.9; lr: 0.00049; sents:  170134; bsz: 7273/7819/425; 21728/23359 tok/s;  45154 sec;
[2025-07-19 01:58:27,769 INFO] Step 32400/200000; acc: 69.9; ppl:  17.4; xent: 2.9; lr: 0.00049; sents:  142942; bsz: 7095/7787/357; 21155/23216 tok/s;  45288 sec;
[2025-07-19 02:00:42,242 INFO] Step 32500/200000; acc: 70.6; ppl:  16.5; xent: 2.8; lr: 0.00049; sents:  149412; bsz: 7260/7784/374; 21596/23154 tok/s;  45422 sec;
[2025-07-19 02:02:56,113 INFO] Step 32600/200000; acc: 69.9; ppl:  17.1; xent: 2.8; lr: 0.00049; sents:  135382; bsz: 7022/7760/338; 20982/23187 tok/s;  45556 sec;
[2025-07-19 02:05:11,626 INFO] Step 32700/200000; acc: 70.4; ppl:  16.6; xent: 2.8; lr: 0.00049; sents:  156199; bsz: 7448/7989/390; 21985/23581 tok/s;  45692 sec;
[2025-07-19 02:07:27,911 INFO] Step 32800/200000; acc: 70.5; ppl:  16.5; xent: 2.8; lr: 0.00049; sents:  148216; bsz: 7639/8112/371; 22421/23809 tok/s;  45828 sec;
[2025-07-19 02:09:42,184 INFO] Step 32900/200000; acc: 69.2; ppl:  17.6; xent: 2.9; lr: 0.00049; sents:  123840; bsz: 7340/7914/310; 21867/23577 tok/s;  45962 sec;
[2025-07-19 02:11:56,162 INFO] Step 33000/200000; acc: 70.2; ppl:  16.8; xent: 2.8; lr: 0.00049; sents:  157609; bsz: 7207/7910/394; 21516/23615 tok/s;  46096 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-19 02:12:31,972 INFO] valid stats calculation
                           took: 35.807363510131836 s.
[2025-07-19 02:12:43,723 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.750633001327515 s.
[2025-07-19 02:12:43,724 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-19 02:12:44,326 INFO] validation BLEU: 35.96130223713914
[2025-07-19 02:12:44,327 INFO] Train perplexity: 30.1799
[2025-07-19 02:12:44,327 INFO] Train accuracy: 62.0347
[2025-07-19 02:12:44,327 INFO] Sentences processed: 4.51304e+07
[2025-07-19 02:12:44,327 INFO] Average bsz: 7393/7942/342
[2025-07-19 02:12:44,327 INFO] Validation perplexity: 18.0734
[2025-07-19 02:12:44,327 INFO] Validation accuracy: 66.9356
[2025-07-19 02:12:44,328 INFO] Model is improving acc: 66.8762 --> 66.9356.
[2025-07-19 02:14:57,506 INFO] Step 33100/200000; acc: 69.5; ppl:  17.5; xent: 2.9; lr: 0.00049; sents:  138905; bsz: 6952/7472/347; 15334/16482 tok/s;  46278 sec;
[2025-07-19 02:17:11,309 INFO] Step 33200/200000; acc: 68.4; ppl:  18.6; xent: 2.9; lr: 0.00049; sents:  140709; bsz: 7326/7793/352; 21900/23296 tok/s;  46411 sec;
[2025-07-19 02:19:25,068 INFO] Step 33300/200000; acc: 66.0; ppl:  21.2; xent: 3.1; lr: 0.00048; sents:  137445; bsz: 7286/7811/344; 21790/23358 tok/s;  46545 sec;
[2025-07-19 02:21:40,567 INFO] Step 33400/200000; acc: 64.4; ppl:  23.0; xent: 3.1; lr: 0.00048; sents:  148786; bsz: 7771/8138/372; 22942/24023 tok/s;  46681 sec;
[2025-07-19 02:23:56,907 INFO] Step 33500/200000; acc: 63.8; ppl:  23.6; xent: 3.2; lr: 0.00048; sents:  130198; bsz: 7667/8421/325; 22494/24707 tok/s;  46817 sec;
[2025-07-19 02:26:12,064 INFO] Step 33600/200000; acc: 64.5; ppl:  23.0; xent: 3.1; lr: 0.00048; sents:  128905; bsz: 7499/8309/322; 22195/24590 tok/s;  46952 sec;
[2025-07-19 02:28:25,887 INFO] Step 33700/200000; acc: 62.1; ppl:  26.4; xent: 3.3; lr: 0.00048; sents:  120677; bsz: 7359/7970/302; 21996/23824 tok/s;  47086 sec;
[2025-07-19 02:30:37,744 INFO] Step 33800/200000; acc: 59.9; ppl:  29.7; xent: 3.4; lr: 0.00048; sents:  103372; bsz: 6935/7703/258; 21038/23369 tok/s;  47218 sec;
[2025-07-19 02:32:51,543 INFO] Step 33900/200000; acc: 62.3; ppl:  26.1; xent: 3.3; lr: 0.00048; sents:  125455; bsz: 7188/7896/314; 21489/23607 tok/s;  47352 sec;
[2025-07-19 02:35:04,874 INFO] Step 34000/200000; acc: 63.2; ppl:  24.8; xent: 3.2; lr: 0.00048; sents:  147758; bsz: 7243/7921/369; 21729/23764 tok/s;  47485 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-19 02:35:41,086 INFO] valid stats calculation
                           took: 36.2090106010437 s.
[2025-07-19 02:35:52,712 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.62560772895813 s.
[2025-07-19 02:35:52,712 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-19 02:35:53,306 INFO] validation BLEU: 36.413544416743534
[2025-07-19 02:35:53,307 INFO] Train perplexity: 29.9456
[2025-07-19 02:35:53,308 INFO] Train accuracy: 62.1037
[2025-07-19 02:35:53,308 INFO] Sentences processed: 4.64526e+07
[2025-07-19 02:35:53,308 INFO] Average bsz: 7391/7942/342
[2025-07-19 02:35:53,308 INFO] Validation perplexity: 17.9029
[2025-07-19 02:35:53,308 INFO] Validation accuracy: 67.296
[2025-07-19 02:35:53,308 INFO] Model is improving acc: 66.9356 --> 67.296.
[2025-07-19 02:35:53,317 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_34000.pt
[2025-07-19 02:38:08,068 INFO] Step 34100/200000; acc: 64.6; ppl:  22.8; xent: 3.1; lr: 0.00048; sents:  141517; bsz: 7628/8188/354; 16655/17879 tok/s;  47668 sec;
[2025-07-19 02:40:22,247 INFO] Step 34200/200000; acc: 63.4; ppl:  24.2; xent: 3.2; lr: 0.00048; sents:  123953; bsz: 7457/7797/310; 22232/23245 tok/s;  47802 sec;
[2025-07-19 02:42:36,854 INFO] Step 34300/200000; acc: 62.8; ppl:  24.7; xent: 3.2; lr: 0.00048; sents:  102403; bsz: 7359/7750/256; 21868/23029 tok/s;  47937 sec;
[2025-07-19 02:44:50,203 INFO] Step 34400/200000; acc: 62.3; ppl:  25.9; xent: 3.3; lr: 0.00048; sents:  118375; bsz: 7283/7880/296; 21845/23636 tok/s;  48070 sec;
[2025-07-19 02:47:04,906 INFO] Step 34500/200000; acc: 63.0; ppl:  24.8; xent: 3.2; lr: 0.00048; sents:  114116; bsz: 7284/7929/285; 21629/23545 tok/s;  48205 sec;
[2025-07-19 02:49:19,242 INFO] Step 34600/200000; acc: 61.8; ppl:  26.4; xent: 3.3; lr: 0.00048; sents:  108338; bsz: 7453/8081/271; 22193/24061 tok/s;  48339 sec;
[2025-07-19 02:50:20,418 INFO] Weighted corpora loaded so far:
			* corpus_0: 5
[2025-07-19 02:51:34,571 INFO] Step 34700/200000; acc: 63.5; ppl:  24.2; xent: 3.2; lr: 0.00047; sents:  138577; bsz: 7676/8231/346; 22687/24329 tok/s;  48475 sec;
[2025-07-19 02:51:37,559 INFO] Weighted corpora loaded so far:
			* corpus_0: 5
[2025-07-19 02:52:04,550 INFO] Weighted corpora loaded so far:
			* corpus_0: 5
[2025-07-19 02:53:07,352 INFO] Weighted corpora loaded so far:
			* corpus_0: 5
[2025-07-19 02:53:34,073 INFO] Weighted corpora loaded so far:
			* corpus_0: 5
[2025-07-19 02:53:35,305 INFO] Weighted corpora loaded so far:
			* corpus_0: 5
[2025-07-19 02:53:48,136 INFO] Step 34800/200000; acc: 62.7; ppl:  25.3; xent: 3.2; lr: 0.00047; sents:  121343; bsz: 7468/8008/303; 22365/23982 tok/s;  48608 sec;
[2025-07-19 02:53:51,544 INFO] Weighted corpora loaded so far:
			* corpus_0: 5
[2025-07-19 02:54:06,217 INFO] Weighted corpora loaded so far:
			* corpus_0: 5
[2025-07-19 02:54:36,655 INFO] Weighted corpora loaded so far:
			* corpus_0: 5
[2025-07-19 02:55:03,378 INFO] Weighted corpora loaded so far:
			* corpus_0: 5
[2025-07-19 02:56:00,945 INFO] Step 34900/200000; acc: 61.9; ppl:  26.4; xent: 3.3; lr: 0.00047; sents:  115245; bsz: 7295/7917/288; 21973/23844 tok/s;  48741 sec;
[2025-07-19 02:58:15,522 INFO] Step 35000/200000; acc: 63.6; ppl:  23.9; xent: 3.2; lr: 0.00047; sents:  129770; bsz: 7642/8004/324; 22715/23791 tok/s;  48876 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-19 02:58:52,123 INFO] valid stats calculation
                           took: 36.599037408828735 s.
[2025-07-19 02:59:03,244 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.120227575302124 s.
[2025-07-19 02:59:03,244 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-19 02:59:03,832 INFO] validation BLEU: 35.91861051634387
[2025-07-19 02:59:03,833 INFO] Train perplexity: 29.7848
[2025-07-19 02:59:03,834 INFO] Train accuracy: 62.1288
[2025-07-19 02:59:03,834 INFO] Sentences processed: 4.76663e+07
[2025-07-19 02:59:03,834 INFO] Average bsz: 7393/7943/340
[2025-07-19 02:59:03,834 INFO] Validation perplexity: 17.9219
[2025-07-19 02:59:03,834 INFO] Validation accuracy: 67.1528
[2025-07-19 02:59:03,835 INFO] Decreasing patience: 2/3
[2025-07-19 03:01:18,433 INFO] Step 35100/200000; acc: 64.4; ppl:  23.1; xent: 3.1; lr: 0.00047; sents:  137635; bsz: 7618/8110/344; 16660/17736 tok/s;  49058 sec;
[2025-07-19 03:03:32,449 INFO] Step 35200/200000; acc: 63.6; ppl:  23.9; xent: 3.2; lr: 0.00047; sents:  129327; bsz: 7482/7916/323; 22332/23629 tok/s;  49193 sec;
[2025-07-19 03:05:47,056 INFO] Step 35300/200000; acc: 65.0; ppl:  21.8; xent: 3.1; lr: 0.00047; sents:  126708; bsz: 7358/7942/317; 21865/23600 tok/s;  49327 sec;
[2025-07-19 03:08:01,807 INFO] Step 35400/200000; acc: 68.6; ppl:  17.7; xent: 2.9; lr: 0.00047; sents:  158246; bsz: 7462/8029/396; 22150/23832 tok/s;  49462 sec;
[2025-07-19 03:10:16,380 INFO] Step 35500/200000; acc: 67.8; ppl:  18.3; xent: 2.9; lr: 0.00047; sents:  135405; bsz: 7342/8031/339; 21822/23871 tok/s;  49596 sec;
[2025-07-19 03:12:31,920 INFO] Step 35600/200000; acc: 68.5; ppl:  17.4; xent: 2.9; lr: 0.00047; sents:  135792; bsz: 7583/8227/339; 22378/24281 tok/s;  49732 sec;
[2025-07-19 03:14:47,800 INFO] Step 35700/200000; acc: 69.0; ppl:  16.9; xent: 2.8; lr: 0.00047; sents:  155443; bsz: 7489/8067/389; 22045/23748 tok/s;  49868 sec;
[2025-07-19 03:17:02,856 INFO] Step 35800/200000; acc: 68.1; ppl:  17.6; xent: 2.9; lr: 0.00047; sents:  115043; bsz: 7551/8118/288; 22363/24045 tok/s;  50003 sec;
[2025-07-19 03:19:18,438 INFO] Step 35900/200000; acc: 68.8; ppl:  17.1; xent: 2.8; lr: 0.00047; sents:  121970; bsz: 7779/8111/305; 22951/23929 tok/s;  50138 sec;
[2025-07-19 03:21:33,660 INFO] Step 36000/200000; acc: 68.6; ppl:  17.4; xent: 2.9; lr: 0.00047; sents:  138642; bsz: 7531/8113/347; 22278/24000 tok/s;  50274 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-19 03:22:09,976 INFO] valid stats calculation
                           took: 36.312997341156006 s.
[2025-07-19 03:22:21,654 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.677453756332397 s.
[2025-07-19 03:22:21,654 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-19 03:22:22,251 INFO] validation BLEU: 36.6092134047446
[2025-07-19 03:22:22,252 INFO] Train perplexity: 29.4073
[2025-07-19 03:22:22,252 INFO] Train accuracy: 62.2732
[2025-07-19 03:22:22,252 INFO] Sentences processed: 4.90205e+07
[2025-07-19 03:22:22,252 INFO] Average bsz: 7397/7947/340
[2025-07-19 03:22:22,252 INFO] Validation perplexity: 17.6208
[2025-07-19 03:22:22,252 INFO] Validation accuracy: 67.4889
[2025-07-19 03:22:22,253 INFO] Model is improving acc: 67.296 --> 67.4889.
[2025-07-19 03:22:22,261 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_36000.pt
[2025-07-19 03:24:38,268 INFO] Step 36100/200000; acc: 69.1; ppl:  16.9; xent: 2.8; lr: 0.00047; sents:  120826; bsz: 7634/8086/302; 16542/17521 tok/s;  50458 sec;
[2025-07-19 03:26:52,064 INFO] Step 36200/200000; acc: 68.3; ppl:  17.7; xent: 2.9; lr: 0.00046; sents:  115548; bsz: 7295/7628/289; 21808/22806 tok/s;  50592 sec;
[2025-07-19 03:29:06,061 INFO] Step 36300/200000; acc: 68.0; ppl:  17.8; xent: 2.9; lr: 0.00046; sents:  131748; bsz: 7225/7669/329; 21568/22893 tok/s;  50726 sec;
[2025-07-19 03:31:20,637 INFO] Step 36400/200000; acc: 68.9; ppl:  17.3; xent: 2.9; lr: 0.00046; sents:  131832; bsz: 7273/8001/330; 21616/23781 tok/s;  50861 sec;
[2025-07-19 03:33:36,537 INFO] Step 36500/200000; acc: 69.7; ppl:  16.4; xent: 2.8; lr: 0.00046; sents:  127280; bsz: 7574/8245/318; 22292/24267 tok/s;  50997 sec;
[2025-07-19 03:35:52,008 INFO] Step 36600/200000; acc: 71.4; ppl:  15.3; xent: 2.7; lr: 0.00046; sents:  153143; bsz: 7573/8196/383; 22360/24201 tok/s;  51132 sec;
[2025-07-19 03:38:08,326 INFO] Step 36700/200000; acc: 70.7; ppl:  15.6; xent: 2.7; lr: 0.00046; sents:  144449; bsz: 7824/8331/361; 22958/24447 tok/s;  51268 sec;
[2025-07-19 03:40:23,408 INFO] Step 36800/200000; acc: 69.6; ppl:  16.6; xent: 2.8; lr: 0.00046; sents:  138155; bsz: 7550/8005/345; 22358/23703 tok/s;  51403 sec;
[2025-07-19 03:42:38,916 INFO] Step 36900/200000; acc: 69.3; ppl:  16.9; xent: 2.8; lr: 0.00046; sents:  143316; bsz: 7515/8116/358; 22183/23958 tok/s;  51539 sec;
[2025-07-19 03:44:53,750 INFO] Step 37000/200000; acc: 69.3; ppl:  16.9; xent: 2.8; lr: 0.00046; sents:  134151; bsz: 7520/7990/335; 22308/23703 tok/s;  51674 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-19 03:45:30,166 INFO] valid stats calculation
                           took: 36.413822174072266 s.
[2025-07-19 03:45:41,896 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.728594303131104 s.
[2025-07-19 03:45:41,896 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-19 03:45:42,487 INFO] validation BLEU: 36.2475140571486
[2025-07-19 03:45:42,488 INFO] Train perplexity: 28.9567
[2025-07-19 03:45:42,488 INFO] Train accuracy: 62.4692
[2025-07-19 03:45:42,488 INFO] Sentences processed: 5.03609e+07
[2025-07-19 03:45:42,488 INFO] Average bsz: 7399/7949/340
[2025-07-19 03:45:42,488 INFO] Validation perplexity: 17.6174
[2025-07-19 03:45:42,489 INFO] Validation accuracy: 67.4428
[2025-07-19 03:45:42,489 INFO] Decreasing patience: 2/3
[2025-07-19 03:47:56,298 INFO] Step 37100/200000; acc: 69.3; ppl:  17.2; xent: 2.8; lr: 0.00046; sents:  143914; bsz: 7374/7999/360; 16159/17529 tok/s;  51856 sec;
[2025-07-19 03:50:11,164 INFO] Step 37200/200000; acc: 69.0; ppl:  17.9; xent: 2.9; lr: 0.00046; sents:  124123; bsz: 7376/7839/310; 21877/23250 tok/s;  51991 sec;
[2025-07-19 03:52:26,033 INFO] Step 37300/200000; acc: 69.0; ppl:  18.0; xent: 2.9; lr: 0.00046; sents:  137393; bsz: 7328/8011/343; 21734/23759 tok/s;  52126 sec;
[2025-07-19 03:54:42,846 INFO] Step 37400/200000; acc: 70.7; ppl:  16.7; xent: 2.8; lr: 0.00046; sents:  134991; bsz: 7508/7979/337; 21950/23328 tok/s;  52263 sec;
[2025-07-19 03:57:00,054 INFO] Step 37500/200000; acc: 70.9; ppl:  16.1; xent: 2.8; lr: 0.00046; sents:  123930; bsz: 7645/8025/310; 22288/23396 tok/s;  52400 sec;
[2025-07-19 03:59:16,022 INFO] Step 37600/200000; acc: 70.6; ppl:  16.5; xent: 2.8; lr: 0.00046; sents:  164551; bsz: 7512/8023/411; 22101/23604 tok/s;  52536 sec;
[2025-07-19 04:01:31,259 INFO] Step 37700/200000; acc: 70.0; ppl:  17.1; xent: 2.8; lr: 0.00046; sents:  158333; bsz: 7408/8068/396; 21911/23863 tok/s;  52671 sec;
[2025-07-19 04:03:48,922 INFO] Step 37800/200000; acc: 71.8; ppl:  15.5; xent: 2.7; lr: 0.00045; sents:  154951; bsz: 7695/8149/387; 22360/23678 tok/s;  52809 sec;
[2025-07-19 04:06:05,627 INFO] Step 37900/200000; acc: 71.0; ppl:  16.1; xent: 2.8; lr: 0.00045; sents:  176513; bsz: 7697/8250/441; 22522/24139 tok/s;  52946 sec;
[2025-07-19 04:08:20,397 INFO] Step 38000/200000; acc: 69.6; ppl:  17.4; xent: 2.9; lr: 0.00045; sents:  139587; bsz: 7248/7923/349; 21511/23516 tok/s;  53080 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-19 04:08:56,503 INFO] valid stats calculation
                           took: 36.10325479507446 s.
[2025-07-19 04:09:08,010 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.50700855255127 s.
[2025-07-19 04:09:08,010 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-19 04:09:08,600 INFO] validation BLEU: 36.35783777111379
[2025-07-19 04:09:08,601 INFO] Train perplexity: 28.542
[2025-07-19 04:09:08,601 INFO] Train accuracy: 62.6743
[2025-07-19 04:09:08,601 INFO] Sentences processed: 5.18192e+07
[2025-07-19 04:09:08,601 INFO] Average bsz: 7401/7951/341
[2025-07-19 04:09:08,601 INFO] Validation perplexity: 17.5676
[2025-07-19 04:09:08,601 INFO] Validation accuracy: 67.5581
[2025-07-19 04:09:08,602 INFO] Model is improving acc: 67.4889 --> 67.5581.
[2025-07-19 04:09:08,610 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_38000.pt
[2025-07-19 04:11:22,833 INFO] Step 38100/200000; acc: 69.0; ppl:  18.0; xent: 2.9; lr: 0.00045; sents:  107399; bsz: 7011/7603/268; 15372/16669 tok/s;  53263 sec;
[2025-07-19 04:13:38,256 INFO] Step 38200/200000; acc: 70.4; ppl:  16.7; xent: 2.8; lr: 0.00045; sents:  112767; bsz: 7318/7857/282; 21614/23206 tok/s;  53398 sec;
[2025-07-19 04:15:53,610 INFO] Step 38300/200000; acc: 70.9; ppl:  16.2; xent: 2.8; lr: 0.00045; sents:  139348; bsz: 7549/7937/348; 22308/23455 tok/s;  53534 sec;
[2025-07-19 04:18:09,695 INFO] Step 38400/200000; acc: 70.4; ppl:  16.4; xent: 2.8; lr: 0.00045; sents:  122018; bsz: 7479/7912/305; 21984/23256 tok/s;  53670 sec;
[2025-07-19 04:20:25,649 INFO] Step 38500/200000; acc: 70.3; ppl:  16.4; xent: 2.8; lr: 0.00045; sents:  118429; bsz: 7623/8177/296; 22429/24060 tok/s;  53806 sec;
[2025-07-19 04:22:40,966 INFO] Step 38600/200000; acc: 70.9; ppl:  16.1; xent: 2.8; lr: 0.00045; sents:  123410; bsz: 7386/7869/309; 21833/23260 tok/s;  53941 sec;
[2025-07-19 04:24:54,618 INFO] Step 38700/200000; acc: 69.9; ppl:  17.1; xent: 2.8; lr: 0.00045; sents:  121623; bsz: 7086/7629/304; 21209/22834 tok/s;  54075 sec;
[2025-07-19 04:27:09,405 INFO] Step 38800/200000; acc: 70.3; ppl:  16.5; xent: 2.8; lr: 0.00045; sents:  140863; bsz: 7249/8012/352; 21511/23778 tok/s;  54209 sec;
[2025-07-19 04:29:24,615 INFO] Step 38900/200000; acc: 70.0; ppl:  16.9; xent: 2.8; lr: 0.00045; sents:  134288; bsz: 7368/7931/336; 21797/23463 tok/s;  54345 sec;
[2025-07-19 04:31:38,002 INFO] Step 39000/200000; acc: 67.8; ppl:  19.1; xent: 2.9; lr: 0.00045; sents:  123363; bsz: 7114/7709/308; 21334/23119 tok/s;  54478 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-19 04:32:14,551 INFO] valid stats calculation
                           took: 36.547335386276245 s.
[2025-07-19 04:32:25,860 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.308593988418579 s.
[2025-07-19 04:32:25,860 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-19 04:32:26,448 INFO] validation BLEU: 36.469035242185114
[2025-07-19 04:32:26,449 INFO] Train perplexity: 28.1647
[2025-07-19 04:32:26,449 INFO] Train accuracy: 62.8605
[2025-07-19 04:32:26,449 INFO] Sentences processed: 5.30627e+07
[2025-07-19 04:32:26,449 INFO] Average bsz: 7399/7949/340
[2025-07-19 04:32:26,449 INFO] Validation perplexity: 17.5302
[2025-07-19 04:32:26,449 INFO] Validation accuracy: 67.6091
[2025-07-19 04:32:26,450 INFO] Model is improving acc: 67.5581 --> 67.6091.
[2025-07-19 04:34:41,709 INFO] Step 39100/200000; acc: 68.2; ppl:  18.9; xent: 2.9; lr: 0.00045; sents:  133291; bsz: 7525/7874/333; 16384/17145 tok/s;  54662 sec;
[2025-07-19 04:36:56,408 INFO] Step 39200/200000; acc: 68.2; ppl:  18.9; xent: 2.9; lr: 0.00045; sents:  138916; bsz: 7246/7861/347; 21517/23344 tok/s;  54796 sec;
[2025-07-19 04:39:11,005 INFO] Step 39300/200000; acc: 68.4; ppl:  18.5; xent: 2.9; lr: 0.00045; sents:  137266; bsz: 7240/7763/343; 21516/23070 tok/s;  54931 sec;
[2025-07-19 04:41:25,316 INFO] Step 39400/200000; acc: 69.1; ppl:  17.9; xent: 2.9; lr: 0.00045; sents:  150080; bsz: 7394/7708/375; 22022/22955 tok/s;  55065 sec;
[2025-07-19 04:43:40,809 INFO] Step 39500/200000; acc: 69.5; ppl:  17.2; xent: 2.8; lr: 0.00044; sents:  139181; bsz: 7423/7910/348; 21914/23352 tok/s;  55201 sec;
[2025-07-19 04:45:54,582 INFO] Step 39600/200000; acc: 68.8; ppl:  18.3; xent: 2.9; lr: 0.00044; sents:  143660; bsz: 7119/7654/359; 21287/22885 tok/s;  55335 sec;
[2025-07-19 04:48:09,399 INFO] Step 39700/200000; acc: 69.7; ppl:  17.2; xent: 2.8; lr: 0.00044; sents:  154519; bsz: 7378/7965/386; 21890/23632 tok/s;  55469 sec;
[2025-07-19 04:50:22,788 INFO] Step 39800/200000; acc: 69.3; ppl:  17.6; xent: 2.9; lr: 0.00044; sents:  149653; bsz: 7199/7972/374; 21588/23905 tok/s;  55603 sec;
[2025-07-19 04:52:37,453 INFO] Step 39900/200000; acc: 69.6; ppl:  17.3; xent: 2.8; lr: 0.00044; sents:  121694; bsz: 7409/7759/304; 22008/23047 tok/s;  55738 sec;
[2025-07-19 04:54:52,322 INFO] Step 40000/200000; acc: 70.1; ppl:  17.0; xent: 2.8; lr: 0.00044; sents:  130753; bsz: 7465/7975/327; 22139/23653 tok/s;  55872 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-19 04:55:28,108 INFO] valid stats calculation
                           took: 35.78391718864441 s.
[2025-07-19 04:55:39,640 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.531465291976929 s.
[2025-07-19 04:55:39,640 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-19 04:55:40,225 INFO] validation BLEU: 36.05790678751329
[2025-07-19 04:55:40,226 INFO] Train perplexity: 27.8499
[2025-07-19 04:55:40,226 INFO] Train accuracy: 63.0143
[2025-07-19 04:55:40,226 INFO] Sentences processed: 5.44617e+07
[2025-07-19 04:55:40,226 INFO] Average bsz: 7398/7946/340
[2025-07-19 04:55:40,226 INFO] Validation perplexity: 17.5653
[2025-07-19 04:55:40,227 INFO] Validation accuracy: 67.4986
[2025-07-19 04:55:40,227 INFO] Decreasing patience: 2/3
[2025-07-19 04:55:40,235 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_40000.pt
[2025-07-19 04:57:54,984 INFO] Step 40100/200000; acc: 70.5; ppl:  16.6; xent: 2.8; lr: 0.00044; sents:  157258; bsz: 7362/7903/393; 16122/17306 tok/s;  56055 sec;
[2025-07-19 05:00:08,923 INFO] Step 40200/200000; acc: 69.4; ppl:  17.4; xent: 2.9; lr: 0.00044; sents:  133574; bsz: 7140/7642/334; 21325/22823 tok/s;  56189 sec;
[2025-07-19 05:02:24,705 INFO] Step 40300/200000; acc: 69.3; ppl:  17.3; xent: 2.9; lr: 0.00044; sents:  125909; bsz: 7415/7883/315; 21845/23223 tok/s;  56325 sec;
[2025-07-19 05:04:40,338 INFO] Step 40400/200000; acc: 70.2; ppl:  16.7; xent: 2.8; lr: 0.00044; sents:  153728; bsz: 7529/7990/384; 22203/23565 tok/s;  56460 sec;
[2025-07-19 05:06:55,942 INFO] Step 40500/200000; acc: 70.1; ppl:  16.8; xent: 2.8; lr: 0.00044; sents:  153858; bsz: 7527/8069/385; 22203/23803 tok/s;  56596 sec;
[2025-07-19 05:09:11,650 INFO] Step 40600/200000; acc: 69.8; ppl:  17.1; xent: 2.8; lr: 0.00044; sents:  142921; bsz: 7355/7924/357; 21678/23355 tok/s;  56732 sec;
[2025-07-19 05:11:26,668 INFO] Step 40700/200000; acc: 70.4; ppl:  16.5; xent: 2.8; lr: 0.00044; sents:  145850; bsz: 7439/7917/365; 22040/23455 tok/s;  56867 sec;
[2025-07-19 05:13:42,193 INFO] Step 40800/200000; acc: 70.0; ppl:  17.0; xent: 2.8; lr: 0.00044; sents:  148866; bsz: 7531/8034/372; 22229/23713 tok/s;  57002 sec;
[2025-07-19 05:15:56,011 INFO] Step 40900/200000; acc: 70.1; ppl:  16.9; xent: 2.8; lr: 0.00044; sents:  147235; bsz: 7282/7814/368; 21766/23357 tok/s;  57136 sec;
[2025-07-19 05:18:10,607 INFO] Step 41000/200000; acc: 71.3; ppl:  15.8; xent: 2.8; lr: 0.00044; sents:  154164; bsz: 7283/7785/385; 21643/23136 tok/s;  57271 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-19 05:18:46,798 INFO] valid stats calculation
                           took: 36.18780040740967 s.
[2025-07-19 05:18:58,273 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.475028991699219 s.
[2025-07-19 05:18:58,273 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-19 05:18:58,860 INFO] validation BLEU: 36.65087767225401
[2025-07-19 05:18:58,860 INFO] Train perplexity: 27.5107
[2025-07-19 05:18:58,861 INFO] Train accuracy: 63.1868
[2025-07-19 05:18:58,861 INFO] Sentences processed: 5.59251e+07
[2025-07-19 05:18:58,861 INFO] Average bsz: 7398/7945/341
[2025-07-19 05:18:58,861 INFO] Validation perplexity: 17.4464
[2025-07-19 05:18:58,861 INFO] Validation accuracy: 67.6988
[2025-07-19 05:18:58,862 INFO] Model is improving acc: 67.6091 --> 67.6988.
[2025-07-19 05:21:12,465 INFO] Step 41100/200000; acc: 70.5; ppl:  16.7; xent: 2.8; lr: 0.00044; sents:  141179; bsz: 7256/7785/353; 15961/17124 tok/s;  57453 sec;
[2025-07-19 05:23:25,873 INFO] Step 41200/200000; acc: 69.3; ppl:  17.9; xent: 2.9; lr: 0.00044; sents:  127914; bsz: 6921/7505/320; 20752/22503 tok/s;  57586 sec;
[2025-07-19 05:25:38,739 INFO] Step 41300/200000; acc: 69.7; ppl:  17.5; xent: 2.9; lr: 0.00043; sents:  139027; bsz: 7079/7637/348; 21312/22992 tok/s;  57719 sec;
[2025-07-19 05:27:53,130 INFO] Step 41400/200000; acc: 71.6; ppl:  15.9; xent: 2.8; lr: 0.00043; sents:  163112; bsz: 7313/7948/408; 21767/23656 tok/s;  57853 sec;
[2025-07-19 05:30:08,190 INFO] Step 41500/200000; acc: 71.0; ppl:  16.0; xent: 2.8; lr: 0.00043; sents:  154248; bsz: 7410/8058/386; 21945/23866 tok/s;  57988 sec;
[2025-07-19 05:32:22,169 INFO] Step 41600/200000; acc: 69.9; ppl:  17.2; xent: 2.8; lr: 0.00043; sents:  142650; bsz: 7110/7819/357; 21227/23344 tok/s;  58122 sec;
[2025-07-19 05:34:36,542 INFO] Step 41700/200000; acc: 70.7; ppl:  16.5; xent: 2.8; lr: 0.00043; sents:  134623; bsz: 7333/7857/337; 21829/23389 tok/s;  58257 sec;
[2025-07-19 05:36:52,400 INFO] Step 41800/200000; acc: 71.3; ppl:  15.9; xent: 2.8; lr: 0.00043; sents:  133791; bsz: 7397/8002/334; 21779/23560 tok/s;  58392 sec;
[2025-07-19 05:39:08,290 INFO] Step 41900/200000; acc: 70.7; ppl:  16.5; xent: 2.8; lr: 0.00043; sents:  134658; bsz: 7136/7670/337; 21006/22577 tok/s;  58528 sec;
[2025-07-19 05:41:21,602 INFO] Step 42000/200000; acc: 70.6; ppl:  16.7; xent: 2.8; lr: 0.00043; sents:  157770; bsz: 7070/7680/394; 21214/23043 tok/s;  58662 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-19 05:41:57,827 INFO] valid stats calculation
                           took: 36.09864354133606 s.
[2025-07-19 05:42:09,534 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.706900596618652 s.
[2025-07-19 05:42:09,534 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-19 05:42:10,126 INFO] validation BLEU: 36.37133705228429
[2025-07-19 05:42:10,127 INFO] Train perplexity: 27.1897
[2025-07-19 05:42:10,127 INFO] Train accuracy: 63.3584
[2025-07-19 05:42:10,127 INFO] Sentences processed: 5.73541e+07
[2025-07-19 05:42:10,127 INFO] Average bsz: 7393/7941/341
[2025-07-19 05:42:10,127 INFO] Validation perplexity: 17.5197
[2025-07-19 05:42:10,128 INFO] Validation accuracy: 67.4914
[2025-07-19 05:42:10,135 INFO] Decreasing patience: 2/3
[2025-07-19 05:42:10,144 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_42000.pt
[2025-07-19 05:44:26,081 INFO] Step 42100/200000; acc: 71.5; ppl:  15.5; xent: 2.7; lr: 0.00043; sents:  169204; bsz: 7453/8036/423; 16172/17436 tok/s;  58846 sec;
[2025-07-19 05:46:40,520 INFO] Step 42200/200000; acc: 70.8; ppl:  16.2; xent: 2.8; lr: 0.00043; sents:  154078; bsz: 7227/7914/385; 21504/23548 tok/s;  58981 sec;
[2025-07-19 05:48:54,546 INFO] Step 42300/200000; acc: 71.0; ppl:  16.0; xent: 2.8; lr: 0.00043; sents:  145093; bsz: 7283/7864/363; 21736/23471 tok/s;  59115 sec;
[2025-07-19 05:51:10,198 INFO] Step 42400/200000; acc: 70.7; ppl:  16.3; xent: 2.8; lr: 0.00043; sents:  157697; bsz: 7606/8148/394; 22427/24026 tok/s;  59250 sec;
[2025-07-19 05:53:25,458 INFO] Step 42500/200000; acc: 68.2; ppl:  18.7; xent: 2.9; lr: 0.00043; sents:  137885; bsz: 7498/7844/345; 22174/23197 tok/s;  59386 sec;
[2025-07-19 05:55:39,191 INFO] Step 42600/200000; acc: 62.8; ppl:  24.9; xent: 3.2; lr: 0.00043; sents:  112451; bsz: 7299/7672/281; 21830/22949 tok/s;  59519 sec;
[2025-07-19 05:57:51,662 INFO] Step 42700/200000; acc: 61.2; ppl:  27.2; xent: 3.3; lr: 0.00043; sents:  119558; bsz: 7299/7842/299; 22040/23679 tok/s;  59652 sec;
[2025-07-19 06:00:06,503 INFO] Step 42800/200000; acc: 62.9; ppl:  24.3; xent: 3.2; lr: 0.00043; sents:  121942; bsz: 7564/8107/305; 22438/24050 tok/s;  59787 sec;
[2025-07-19 06:02:22,025 INFO] Step 42900/200000; acc: 63.9; ppl:  23.3; xent: 3.1; lr: 0.00043; sents:  131983; bsz: 7719/8295/330; 22783/24484 tok/s;  59922 sec;
[2025-07-19 06:04:36,606 INFO] Step 43000/200000; acc: 64.0; ppl:  23.4; xent: 3.2; lr: 0.00043; sents:  119781; bsz: 7406/7938/299; 22014/23593 tok/s;  60057 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-19 06:05:10,454 INFO] valid stats calculation
                           took: 33.8461492061615 s.
[2025-07-19 06:05:22,099 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.644124031066895 s.
[2025-07-19 06:05:22,099 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-19 06:05:22,699 INFO] validation BLEU: 36.31847091094777
[2025-07-19 06:05:22,700 INFO] Train perplexity: 26.9998
[2025-07-19 06:05:22,701 INFO] Train accuracy: 63.4368
[2025-07-19 06:05:22,701 INFO] Sentences processed: 5.87237e+07
[2025-07-19 06:05:22,701 INFO] Average bsz: 7394/7942/341
[2025-07-19 06:05:22,701 INFO] Validation perplexity: 17.3217
[2025-07-19 06:05:22,701 INFO] Validation accuracy: 67.6612
[2025-07-19 06:05:22,701 INFO] Decreasing patience: 1/3
[2025-07-19 06:07:37,139 INFO] Step 43100/200000; acc: 63.2; ppl:  24.1; xent: 3.2; lr: 0.00043; sents:  119213; bsz: 7611/8107/298; 16864/17962 tok/s;  60237 sec;
[2025-07-19 06:09:52,923 INFO] Step 43200/200000; acc: 64.9; ppl:  21.9; xent: 3.1; lr: 0.00043; sents:  129353; bsz: 7693/8051/323; 22662/23717 tok/s;  60373 sec;
[2025-07-19 06:12:07,402 INFO] Step 43300/200000; acc: 63.0; ppl:  24.7; xent: 3.2; lr: 0.00042; sents:  118011; bsz: 7092/7702/295; 21094/22910 tok/s;  60507 sec;
[2025-07-19 06:14:21,305 INFO] Step 43400/200000; acc: 63.0; ppl:  25.0; xent: 3.2; lr: 0.00042; sents:  135855; bsz: 7156/8171/340; 21376/24410 tok/s;  60641 sec;
[2025-07-19 06:16:34,818 INFO] Step 43500/200000; acc: 63.0; ppl:  24.5; xent: 3.2; lr: 0.00042; sents:  117739; bsz: 7328/8077/294; 21955/24199 tok/s;  60775 sec;
[2025-07-19 06:18:50,232 INFO] Step 43600/200000; acc: 64.8; ppl:  22.2; xent: 3.1; lr: 0.00042; sents:  120048; bsz: 7678/8098/300; 22680/23921 tok/s;  60910 sec;
[2025-07-19 06:21:04,077 INFO] Step 43700/200000; acc: 62.6; ppl:  25.1; xent: 3.2; lr: 0.00042; sents:  122354; bsz: 7427/8025/306; 22195/23984 tok/s;  61044 sec;
[2025-07-19 06:23:17,516 INFO] Step 43800/200000; acc: 62.3; ppl:  25.4; xent: 3.2; lr: 0.00042; sents:  121927; bsz: 7325/7959/305; 21958/23857 tok/s;  61178 sec;
[2025-07-19 06:24:50,818 INFO] Weighted corpora loaded so far:
			* corpus_0: 6
[2025-07-19 06:25:32,346 INFO] Step 43900/200000; acc: 63.7; ppl:  23.4; xent: 3.2; lr: 0.00042; sents:  125403; bsz: 7636/8135/314; 22654/24133 tok/s;  61312 sec;
[2025-07-19 06:26:08,694 INFO] Weighted corpora loaded so far:
			* corpus_0: 6
[2025-07-19 06:27:08,679 INFO] Weighted corpora loaded so far:
			* corpus_0: 6
[2025-07-19 06:27:46,769 INFO] Step 44000/200000; acc: 64.0; ppl:  23.1; xent: 3.1; lr: 0.00042; sents:  132519; bsz: 7578/8235/331; 22551/24505 tok/s;  61447 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-19 06:28:22,872 INFO] valid stats calculation
                           took: 36.100425243377686 s.
[2025-07-19 06:28:33,952 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.079596519470215 s.
[2025-07-19 06:28:33,952 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-19 06:28:34,542 INFO] validation BLEU: 36.54793818776106
[2025-07-19 06:28:34,543 INFO] Train perplexity: 26.9244
[2025-07-19 06:28:34,543 INFO] Train accuracy: 63.4373
[2025-07-19 06:28:34,543 INFO] Sentences processed: 5.99662e+07
[2025-07-19 06:28:34,543 INFO] Average bsz: 7395/7944/341
[2025-07-19 06:28:34,544 INFO] Validation perplexity: 17.2971
[2025-07-19 06:28:34,544 INFO] Validation accuracy: 67.8178
[2025-07-19 06:28:34,544 INFO] Model is improving acc: 67.6988 --> 67.8178.
[2025-07-19 06:28:34,553 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_44000.pt
[2025-07-19 06:29:03,439 INFO] Weighted corpora loaded so far:
			* corpus_0: 6
[2025-07-19 06:29:32,452 INFO] Weighted corpora loaded so far:
			* corpus_0: 6
[2025-07-19 06:30:04,335 INFO] Weighted corpora loaded so far:
			* corpus_0: 6
[2025-07-19 06:30:06,947 INFO] Weighted corpora loaded so far:
			* corpus_0: 6
[2025-07-19 06:30:17,588 INFO] Weighted corpora loaded so far:
			* corpus_0: 6
[2025-07-19 06:30:48,460 INFO] Step 44100/200000; acc: 62.1; ppl:  25.8; xent: 3.2; lr: 0.00042; sents:  131955; bsz: 7215/7997/330; 15884/17606 tok/s;  61629 sec;
[2025-07-19 06:30:49,777 INFO] Weighted corpora loaded so far:
			* corpus_0: 6
[2025-07-19 06:31:33,919 INFO] Weighted corpora loaded so far:
			* corpus_0: 6
[2025-07-19 06:33:02,857 INFO] Step 44200/200000; acc: 62.8; ppl:  25.1; xent: 3.2; lr: 0.00042; sents:  119523; bsz: 7540/8148/299; 22442/24251 tok/s;  61763 sec;
[2025-07-19 06:35:15,978 INFO] Step 44300/200000; acc: 61.8; ppl:  26.4; xent: 3.3; lr: 0.00042; sents:  120312; bsz: 7278/7964/301; 21871/23931 tok/s;  61896 sec;
[2025-07-19 06:37:29,434 INFO] Step 44400/200000; acc: 62.6; ppl:  25.3; xent: 3.2; lr: 0.00042; sents:  130279; bsz: 7266/7869/326; 21777/23586 tok/s;  62029 sec;
[2025-07-19 06:39:42,724 INFO] Step 44500/200000; acc: 64.5; ppl:  22.5; xent: 3.1; lr: 0.00042; sents:  136118; bsz: 7253/7940/340; 21766/23829 tok/s;  62163 sec;
[2025-07-19 06:41:57,973 INFO] Step 44600/200000; acc: 66.3; ppl:  20.1; xent: 3.0; lr: 0.00042; sents:  148492; bsz: 7742/8196/371; 22899/24239 tok/s;  62298 sec;
[2025-07-19 06:44:13,543 INFO] Step 44700/200000; acc: 69.2; ppl:  16.8; xent: 2.8; lr: 0.00042; sents:  157177; bsz: 7541/8286/393; 22257/24456 tok/s;  62434 sec;
[2025-07-19 06:46:28,164 INFO] Step 44800/200000; acc: 69.8; ppl:  16.4; xent: 2.8; lr: 0.00042; sents:  152754; bsz: 7286/7954/382; 21648/23634 tok/s;  62568 sec;
[2025-07-19 06:48:43,842 INFO] Step 44900/200000; acc: 70.2; ppl:  16.0; xent: 2.8; lr: 0.00042; sents:  128907; bsz: 7680/8050/322; 22641/23734 tok/s;  62704 sec;
[2025-07-19 06:50:58,327 INFO] Step 45000/200000; acc: 70.0; ppl:  16.2; xent: 2.8; lr: 0.00042; sents:  134135; bsz: 7508/7938/335; 22333/23611 tok/s;  62838 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-19 06:51:34,326 INFO] valid stats calculation
                           took: 35.99697828292847 s.
[2025-07-19 06:51:45,682 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.354969263076782 s.
[2025-07-19 06:51:45,682 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-19 06:51:46,268 INFO] validation BLEU: 36.925267766384295
[2025-07-19 06:51:46,269 INFO] Train perplexity: 26.7631
[2025-07-19 06:51:46,269 INFO] Train accuracy: 63.4934
[2025-07-19 06:51:46,269 INFO] Sentences processed: 6.13258e+07
[2025-07-19 06:51:46,269 INFO] Average bsz: 7396/7946/341
[2025-07-19 06:51:46,269 INFO] Validation perplexity: 17.0978
[2025-07-19 06:51:46,270 INFO] Validation accuracy: 68.041
[2025-07-19 06:51:46,270 INFO] Model is improving acc: 67.8178 --> 68.041.
[2025-07-19 06:54:00,881 INFO] Step 45100/200000; acc: 70.2; ppl:  15.8; xent: 2.8; lr: 0.00042; sents:  128245; bsz: 7716/8343/321; 16906/18280 tok/s;  63021 sec;
[2025-07-19 06:56:17,316 INFO] Step 45200/200000; acc: 71.2; ppl:  15.2; xent: 2.7; lr: 0.00042; sents:  146454; bsz: 7592/8170/366; 22258/23952 tok/s;  63157 sec;
[2025-07-19 06:58:31,402 INFO] Step 45300/200000; acc: 70.6; ppl:  15.6; xent: 2.7; lr: 0.00042; sents:  142780; bsz: 7385/7908/357; 22030/23590 tok/s;  63291 sec;
[2025-07-19 07:00:47,290 INFO] Step 45400/200000; acc: 70.4; ppl:  15.8; xent: 2.8; lr: 0.00041; sents:  135056; bsz: 7600/8119/338; 22372/23899 tok/s;  63427 sec;
[2025-07-19 07:03:02,365 INFO] Step 45500/200000; acc: 70.5; ppl:  15.7; xent: 2.8; lr: 0.00041; sents:  137627; bsz: 7559/8010/344; 22384/23719 tok/s;  63562 sec;
[2025-07-19 07:05:17,425 INFO] Step 45600/200000; acc: 69.9; ppl:  16.1; xent: 2.8; lr: 0.00041; sents:  137797; bsz: 7430/8049/344; 22007/23840 tok/s;  63697 sec;
[2025-07-19 07:07:33,313 INFO] Step 45700/200000; acc: 70.1; ppl:  16.0; xent: 2.8; lr: 0.00041; sents:  120163; bsz: 7495/7971/300; 22064/23463 tok/s;  63833 sec;
[2025-07-19 07:09:48,727 INFO] Step 45800/200000; acc: 70.1; ppl:  15.7; xent: 2.8; lr: 0.00041; sents:  132229; bsz: 7646/8234/331; 22587/24324 tok/s;  63969 sec;
[2025-07-19 07:12:03,389 INFO] Step 45900/200000; acc: 70.2; ppl:  15.8; xent: 2.8; lr: 0.00041; sents:  143468; bsz: 7433/8058/359; 22080/23935 tok/s;  64103 sec;
[2025-07-19 07:14:17,933 INFO] Step 46000/200000; acc: 70.3; ppl:  15.9; xent: 2.8; lr: 0.00041; sents:  123541; bsz: 7287/7842/309; 21666/23316 tok/s;  64238 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-19 07:14:54,019 INFO] valid stats calculation
                           took: 36.08294677734375 s.
[2025-07-19 07:15:05,278 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.258837699890137 s.
[2025-07-19 07:15:05,278 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-19 07:15:05,872 INFO] validation BLEU: 36.979342828223885
[2025-07-19 07:15:05,873 INFO] Train perplexity: 26.4515
[2025-07-19 07:15:05,873 INFO] Train accuracy: 63.6453
[2025-07-19 07:15:05,873 INFO] Sentences processed: 6.26732e+07
[2025-07-19 07:15:05,873 INFO] Average bsz: 7399/7949/341
[2025-07-19 07:15:05,873 INFO] Validation perplexity: 17.0938
[2025-07-19 07:15:05,873 INFO] Validation accuracy: 68.0192
[2025-07-19 07:15:05,874 INFO] Decreasing patience: 2/3
[2025-07-19 07:15:05,882 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_46000.pt
[2025-07-19 07:17:21,777 INFO] Step 46100/200000; acc: 70.4; ppl:  15.7; xent: 2.8; lr: 0.00041; sents:  125913; bsz: 7609/8054/315; 16556/17525 tok/s;  64422 sec;
[2025-07-19 07:19:38,402 INFO] Step 46200/200000; acc: 70.6; ppl:  15.5; xent: 2.7; lr: 0.00041; sents:  123004; bsz: 7704/8224/308; 22556/24080 tok/s;  64558 sec;
[2025-07-19 07:21:54,450 INFO] Step 46300/200000; acc: 70.1; ppl:  16.1; xent: 2.8; lr: 0.00041; sents:  118004; bsz: 7516/7889/295; 22097/23195 tok/s;  64695 sec;
[2025-07-19 07:24:10,405 INFO] Step 46400/200000; acc: 69.9; ppl:  16.4; xent: 2.8; lr: 0.00041; sents:  126447; bsz: 7596/8026/316; 22348/23614 tok/s;  64830 sec;
[2025-07-19 07:26:23,715 INFO] Step 46500/200000; acc: 68.0; ppl:  18.9; xent: 2.9; lr: 0.00041; sents:  127436; bsz: 7049/7596/319; 21151/22793 tok/s;  64964 sec;
[2025-07-19 07:28:34,778 INFO] Step 46600/200000; acc: 67.2; ppl:  19.9; xent: 3.0; lr: 0.00041; sents:  116761; bsz: 6657/7373/292; 20317/22501 tok/s;  65095 sec;
[2025-07-19 07:30:47,662 INFO] Step 46700/200000; acc: 69.6; ppl:  17.7; xent: 2.9; lr: 0.00041; sents:  124272; bsz: 7139/7692/311; 21490/23157 tok/s;  65228 sec;
[2025-07-19 07:33:02,139 INFO] Step 46800/200000; acc: 70.6; ppl:  16.6; xent: 2.8; lr: 0.00041; sents:  114103; bsz: 7217/7645/285; 21467/22739 tok/s;  65362 sec;
[2025-07-19 07:35:18,569 INFO] Step 46900/200000; acc: 71.1; ppl:  15.9; xent: 2.8; lr: 0.00041; sents:  125367; bsz: 7646/7880/313; 22417/23103 tok/s;  65499 sec;
[2025-07-19 07:37:35,104 INFO] Step 47000/200000; acc: 71.1; ppl:  16.0; xent: 2.8; lr: 0.00041; sents:  122114; bsz: 7589/7900/305; 22233/23144 tok/s;  65635 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-19 07:38:10,913 INFO] valid stats calculation
                           took: 35.80694890022278 s.
[2025-07-19 07:38:21,987 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.073846340179443 s.
[2025-07-19 07:38:21,987 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-19 07:38:22,582 INFO] validation BLEU: 36.69405293463933
[2025-07-19 07:38:22,583 INFO] Train perplexity: 26.2001
[2025-07-19 07:38:22,583 INFO] Train accuracy: 63.7762
[2025-07-19 07:38:22,583 INFO] Sentences processed: 6.38966e+07
[2025-07-19 07:38:22,583 INFO] Average bsz: 7398/7947/340
[2025-07-19 07:38:22,583 INFO] Validation perplexity: 16.9704
[2025-07-19 07:38:22,583 INFO] Validation accuracy: 68.0022
[2025-07-19 07:38:22,584 INFO] Decreasing patience: 1/3
[2025-07-19 07:40:35,523 INFO] Step 47100/200000; acc: 69.5; ppl:  17.3; xent: 2.8; lr: 0.00041; sents:  124416; bsz: 7178/8040/311; 15915/17825 tok/s;  65816 sec;
[2025-07-19 07:42:51,602 INFO] Step 47200/200000; acc: 70.2; ppl:  16.6; xent: 2.8; lr: 0.00041; sents:  158592; bsz: 7510/8022/396; 22074/23580 tok/s;  65952 sec;
[2025-07-19 07:45:06,653 INFO] Step 47300/200000; acc: 69.9; ppl:  17.0; xent: 2.8; lr: 0.00041; sents:  141703; bsz: 7287/7884/354; 21585/23352 tok/s;  66087 sec;
[2025-07-19 07:47:20,891 INFO] Step 47400/200000; acc: 69.9; ppl:  17.2; xent: 2.8; lr: 0.00041; sents:  133561; bsz: 7076/7798/334; 21086/23235 tok/s;  66221 sec;
[2025-07-19 07:49:37,415 INFO] Step 47500/200000; acc: 72.1; ppl:  15.3; xent: 2.7; lr: 0.00041; sents:  160624; bsz: 7484/8133/402; 21927/23828 tok/s;  66357 sec;
[2025-07-19 07:51:52,623 INFO] Step 47600/200000; acc: 71.2; ppl:  16.1; xent: 2.8; lr: 0.00041; sents:  137822; bsz: 7223/7883/345; 21368/23322 tok/s;  66493 sec;
[2025-07-19 07:54:09,040 INFO] Step 47700/200000; acc: 71.8; ppl:  15.5; xent: 2.7; lr: 0.00040; sents:  147284; bsz: 7577/8188/368; 22217/24009 tok/s;  66629 sec;
[2025-07-19 07:56:24,938 INFO] Step 47800/200000; acc: 71.8; ppl:  15.4; xent: 2.7; lr: 0.00040; sents:  161891; bsz: 7576/8171/405; 22301/24052 tok/s;  66765 sec;
[2025-07-19 07:58:40,601 INFO] Step 47900/200000; acc: 72.7; ppl:  14.9; xent: 2.7; lr: 0.00040; sents:  149393; bsz: 7420/7869/373; 21878/23203 tok/s;  66901 sec;
[2025-07-19 08:00:55,329 INFO] Step 48000/200000; acc: 70.9; ppl:  16.1; xent: 2.8; lr: 0.00040; sents:  141839; bsz: 7370/7813/355; 21883/23196 tok/s;  67035 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-19 08:01:28,305 INFO] valid stats calculation
                           took: 32.97223258018494 s.
[2025-07-19 08:01:39,836 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.530796766281128 s.
[2025-07-19 08:01:39,836 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-19 08:01:40,424 INFO] validation BLEU: 37.189252889260274
[2025-07-19 08:01:40,425 INFO] Train perplexity: 25.9353
[2025-07-19 08:01:40,425 INFO] Train accuracy: 63.9273
[2025-07-19 08:01:40,425 INFO] Sentences processed: 6.53537e+07
[2025-07-19 08:01:40,425 INFO] Average bsz: 7397/7947/340
[2025-07-19 08:01:40,425 INFO] Validation perplexity: 16.8835
[2025-07-19 08:01:40,425 INFO] Validation accuracy: 68.1636
[2025-07-19 08:01:40,426 INFO] Model is improving acc: 68.041 --> 68.1636.
[2025-07-19 08:01:40,435 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_48000.pt
[2025-07-19 08:03:56,533 INFO] Step 48100/200000; acc: 71.0; ppl:  16.2; xent: 2.8; lr: 0.00040; sents:  147060; bsz: 7386/7985/368; 16304/17628 tok/s;  67217 sec;
[2025-07-19 08:06:11,702 INFO] Step 48200/200000; acc: 70.7; ppl:  16.5; xent: 2.8; lr: 0.00040; sents:  144017; bsz: 7466/8045/360; 22107/23821 tok/s;  67352 sec;
[2025-07-19 08:08:27,593 INFO] Step 48300/200000; acc: 69.8; ppl:  16.9; xent: 2.8; lr: 0.00040; sents:  130580; bsz: 7345/7819/326; 21631/23026 tok/s;  67488 sec;
[2025-07-19 08:10:43,672 INFO] Step 48400/200000; acc: 69.1; ppl:  17.6; xent: 2.9; lr: 0.00040; sents:  138418; bsz: 7411/7862/346; 21786/23110 tok/s;  67624 sec;
[2025-07-19 08:12:58,243 INFO] Step 48500/200000; acc: 69.4; ppl:  17.4; xent: 2.9; lr: 0.00040; sents:  138754; bsz: 7428/7902/347; 22080/23490 tok/s;  67758 sec;
[2025-07-19 08:15:10,601 INFO] Step 48600/200000; acc: 69.6; ppl:  17.3; xent: 2.9; lr: 0.00040; sents:  145341; bsz: 6892/7545/363; 20829/22802 tok/s;  67891 sec;
[2025-07-19 08:17:25,836 INFO] Step 48700/200000; acc: 69.4; ppl:  17.0; xent: 2.8; lr: 0.00040; sents:  129863; bsz: 7434/7755/325; 21988/22939 tok/s;  68026 sec;
[2025-07-19 08:19:42,067 INFO] Step 48800/200000; acc: 70.5; ppl:  16.1; xent: 2.8; lr: 0.00040; sents:  131339; bsz: 7665/8077/328; 22527/23739 tok/s;  68162 sec;
[2025-07-19 08:21:56,545 INFO] Step 48900/200000; acc: 69.6; ppl:  16.8; xent: 2.8; lr: 0.00040; sents:  143081; bsz: 7322/7869/358; 21784/23411 tok/s;  68297 sec;
[2025-07-19 08:24:11,697 INFO] Step 49000/200000; acc: 70.7; ppl:  16.2; xent: 2.8; lr: 0.00040; sents:  141637; bsz: 7507/8035/354; 22219/23782 tok/s;  68432 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-19 08:24:41,287 INFO] valid stats calculation
                           took: 29.580844163894653 s.
[2025-07-19 08:24:52,326 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.03901481628418 s.
[2025-07-19 08:24:52,326 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-19 08:24:53,116 INFO] validation BLEU: 36.410798273683454
[2025-07-19 08:24:53,116 INFO] Train perplexity: 25.7081
[2025-07-19 08:24:53,117 INFO] Train accuracy: 64.0504
[2025-07-19 08:24:53,117 INFO] Sentences processed: 6.67438e+07
[2025-07-19 08:24:53,117 INFO] Average bsz: 7397/7946/341
[2025-07-19 08:24:53,117 INFO] Validation perplexity: 17.1104
[2025-07-19 08:24:53,117 INFO] Validation accuracy: 67.9743
[2025-07-19 08:24:53,129 INFO] Decreasing patience: 2/3
[2025-07-19 08:27:08,609 INFO] Step 49100/200000; acc: 71.4; ppl:  15.7; xent: 2.8; lr: 0.00040; sents:  144265; bsz: 7466/8043/361; 16882/18186 tok/s;  68609 sec;
[2025-07-19 08:29:25,081 INFO] Step 49200/200000; acc: 70.5; ppl:  16.3; xent: 2.8; lr: 0.00040; sents:  137377; bsz: 7702/8077/343; 22576/23676 tok/s;  68745 sec;
[2025-07-19 08:31:39,444 INFO] Step 49300/200000; acc: 70.8; ppl:  16.4; xent: 2.8; lr: 0.00040; sents:  163849; bsz: 7280/7912/410; 21674/23555 tok/s;  68879 sec;
[2025-07-19 08:33:53,169 INFO] Step 49400/200000; acc: 70.0; ppl:  17.0; xent: 2.8; lr: 0.00040; sents:  159601; bsz: 7114/7856/399; 21280/23502 tok/s;  69013 sec;
[2025-07-19 08:36:08,246 INFO] Step 49500/200000; acc: 70.9; ppl:  16.0; xent: 2.8; lr: 0.00040; sents:  144650; bsz: 7454/7814/362; 22075/23142 tok/s;  69148 sec;
[2025-07-19 08:38:21,658 INFO] Step 49600/200000; acc: 69.7; ppl:  17.1; xent: 2.8; lr: 0.00040; sents:  136887; bsz: 7139/7708/342; 21406/23111 tok/s;  69282 sec;
[2025-07-19 08:40:36,814 INFO] Step 49700/200000; acc: 70.2; ppl:  16.4; xent: 2.8; lr: 0.00040; sents:  147069; bsz: 7430/7877/368; 21992/23315 tok/s;  69417 sec;
[2025-07-19 08:42:53,129 INFO] Step 49800/200000; acc: 70.6; ppl:  16.3; xent: 2.8; lr: 0.00040; sents:  136222; bsz: 7596/8043/341; 22291/23602 tok/s;  69553 sec;
[2025-07-19 08:45:07,550 INFO] Step 49900/200000; acc: 69.9; ppl:  17.1; xent: 2.8; lr: 0.00040; sents:  158020; bsz: 7315/7828/395; 21768/23296 tok/s;  69688 sec;
[2025-07-19 08:47:21,863 INFO] Step 50000/200000; acc: 69.6; ppl:  17.3; xent: 2.9; lr: 0.00040; sents:  150554; bsz: 7058/7618/376; 21020/22688 tok/s;  69822 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-19 08:47:53,487 INFO] valid stats calculation
                           took: 31.62075138092041 s.
[2025-07-19 08:48:04,775 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.287978172302246 s.
[2025-07-19 08:48:04,775 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-19 08:48:05,367 INFO] validation BLEU: 36.64634645907267
[2025-07-19 08:48:05,368 INFO] Train perplexity: 25.4843
[2025-07-19 08:48:05,368 INFO] Train accuracy: 64.1756
[2025-07-19 08:48:05,368 INFO] Sentences processed: 6.82223e+07
[2025-07-19 08:48:05,369 INFO] Average bsz: 7396/7945/341
[2025-07-19 08:48:05,369 INFO] Validation perplexity: 17.3153
[2025-07-19 08:48:05,369 INFO] Validation accuracy: 67.6903
[2025-07-19 08:48:05,369 INFO] Decreasing patience: 1/3
[2025-07-19 08:48:05,378 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_50000.pt
[2025-07-19 08:50:19,911 INFO] Step 50100/200000; acc: 69.9; ppl:  17.1; xent: 2.8; lr: 0.00039; sents:  141961; bsz: 7022/7683/355; 15777/17261 tok/s;  70000 sec;
[2025-07-19 08:52:34,392 INFO] Step 50200/200000; acc: 70.2; ppl:  16.7; xent: 2.8; lr: 0.00039; sents:  116730; bsz: 7241/7651/292; 21539/22760 tok/s;  70134 sec;
[2025-07-19 08:54:49,222 INFO] Step 50300/200000; acc: 71.4; ppl:  15.8; xent: 2.8; lr: 0.00039; sents:  142998; bsz: 7352/7892/357; 21812/23413 tok/s;  70269 sec;
[2025-07-19 08:57:04,609 INFO] Step 50400/200000; acc: 71.4; ppl:  15.7; xent: 2.8; lr: 0.00039; sents:  164265; bsz: 7621/8132/411; 22517/24025 tok/s;  70405 sec;
[2025-07-19 08:59:19,737 INFO] Step 50500/200000; acc: 70.8; ppl:  16.3; xent: 2.8; lr: 0.00039; sents:  167430; bsz: 7510/7911/419; 22233/23418 tok/s;  70540 sec;
[2025-07-19 09:01:34,621 INFO] Step 50600/200000; acc: 71.4; ppl:  15.9; xent: 2.8; lr: 0.00039; sents:  161044; bsz: 7335/7806/403; 21753/23150 tok/s;  70675 sec;
[2025-07-19 09:03:50,814 INFO] Step 50700/200000; acc: 71.2; ppl:  16.1; xent: 2.8; lr: 0.00039; sents:  150042; bsz: 7513/8146/375; 22066/23926 tok/s;  70811 sec;
[2025-07-19 09:06:03,687 INFO] Step 50800/200000; acc: 68.9; ppl:  17.8; xent: 2.9; lr: 0.00039; sents:  129813; bsz: 7093/7697/325; 21354/23171 tok/s;  70944 sec;
[2025-07-19 09:08:17,418 INFO] Step 50900/200000; acc: 70.7; ppl:  16.5; xent: 2.8; lr: 0.00039; sents:  151899; bsz: 7162/7658/380; 21423/22906 tok/s;  71077 sec;
[2025-07-19 09:10:31,784 INFO] Step 51000/200000; acc: 71.3; ppl:  15.8; xent: 2.8; lr: 0.00039; sents:  148056; bsz: 7216/7690/370; 21484/22895 tok/s;  71212 sec;
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:47: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, dim=0):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_activations.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:396: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(self, u, x, bias, init=None, mask_h=None):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sru.py:445: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(self, grad_h, grad_last):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:11: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, target):
/home/pourmost/.conda/envs/BPE/lib/python3.10/site-packages/onmt/modules/sparse_losses.py:32: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[2025-07-19 09:11:01,398 INFO] valid stats calculation
                           took: 29.612253189086914 s.
[2025-07-19 09:11:12,489 INFO] The translation of the valid dataset for dynamic scoring
                               took : 11.090080738067627 s.
[2025-07-19 09:11:12,489 INFO] UPDATING VALIDATION BLEU
That's 100 lines that end in a tokenized period ('.')
It looks like you forgot to detokenize your test data, which may hurt your score.
If you insist your data is detokenized, or don't care, you can suppress this message with the `force` parameter.
[2025-07-19 09:11:13,110 INFO] validation BLEU: 36.480870204289396
[2025-07-19 09:11:13,111 INFO] Train perplexity: 25.2667
[2025-07-19 09:11:13,111 INFO] Train accuracy: 64.3022
[2025-07-19 09:11:13,111 INFO] Sentences processed: 6.96966e+07
[2025-07-19 09:11:13,112 INFO] Average bsz: 7395/7942/342
[2025-07-19 09:11:13,112 INFO] Validation perplexity: 17.1846
[2025-07-19 09:11:13,112 INFO] Validation accuracy: 67.802
[2025-07-19 09:11:13,113 INFO] Decreasing patience: 0/3
[2025-07-19 09:11:13,113 INFO] Training finished after not improving. Early Stop!
[2025-07-19 09:11:13,113 INFO] Best model found at step 48000
[2025-07-19 09:11:13,113 INFO] earlystopper has_stopped!
[2025-07-19 09:11:15,805 INFO] Saving checkpoint /home/pourmost/Redo/RANLP/Models/wmt_base/model_step_51000.pt

✅ Training completed: wmt_base
